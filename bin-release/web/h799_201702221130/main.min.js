var __reflect=this&&this.__reflect||function(e,t,i){e.__class__=t,i?i.push(t):i=[t],e.__types__=e.__types__?i.concat(e.__types__):i},__extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},Model;!function(e){var t=function(){function t(){}return Object.defineProperty(t.prototype,"getSkillDyList",{get:function(){return e.WebValue.dataDyModel.skillModelList},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"getSkillStList",{get:function(){return e.WebValue.dataStModel.skillList},enumerable:!0,configurable:!0}),t}();e.MainInfoData=t,__reflect(t.prototype,"Model.MainInfoData")}(Model||(Model={}));var Model;!function(e){var t=function(){function e(e){this.id=e}return e}();e.AccountModel=t,__reflect(t.prototype,"Model.AccountModel")}(Model||(Model={}));var Model;!function(e){var t=function(){function e(e,t,i,n,o,r,a,l){void 0===e&&(e=null),void 0===t&&(t=null),void 0===i&&(i=null),void 0===n&&(n=null),void 0===o&&(o=null),void 0===r&&(r=null),void 0===a&&(a=null),void 0===l&&(l=null)}return e}();e.DataDyModel=t,__reflect(t.prototype,"Model.DataDyModel")}(Model||(Model={}));var Model;!function(e){var t=function(){function e(){this.friendSkillList=new Array}return e}();e.DataStModel=t,__reflect(t.prototype,"Model.DataStModel")}(Model||(Model={}));var Model;!function(e){var t=function(){function t(i,n,o){void 0===n&&(n=!1),void 0===o&&(o=!1);var r=this;this.successCallBack=null,this.failedCallBack=null,this.startService=null;var a=new e.WebServiceToolKit;a.isShowFireWind=n,a.wsValue=i,a.successCallBack=function(e){r.onSuccess(e)},a.failedCallBack=function(e){r.onFailed(e)},t.isDebug&&console.log("this.toolKit.failedCallBack ",a.failedCallBack),t.isDebug&&console.log("zhujun: this.toolKit.wsValue "+a.wsValue),this.startService=function(){a.startService()}}return Object.defineProperty(t,"Test",{get:function(){return""},enumerable:!0,configurable:!0}),Object.defineProperty(t,"SelectedLoginAddress",{get:function(){return t.isDebug&&console.log("SelectedLoginAddress: this.baseServerUrl is "+t.baseServerUrl+" this.withinLoginUrl "+t.withinLoginUrl),t.isOutWeb?t.baseServerUrl+t.outLoginUrl:t.baseServerUrl+t.withinLoginUrl},enumerable:!0,configurable:!0}),Object.defineProperty(t,"SelectedServerAddress",{get:function(){return t.isDebug&&console.log("SelectedServerAddress: this.baseServerUrl is ",t.baseServerUrl," this.withinServerUrl "+t.withinServerUrl),t.isOutWeb?t.baseServerUrl+t.outServerUrl:t.baseServerUrl+t.withinServerUrl},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"StartService",{get:function(){return this.startService},enumerable:!0,configurable:!0}),t.prototype.onSuccess=function(e){t.isDebug&&console.log("zhujun: WebServiceBase onSuccess ! ")},t.prototype.onFailed=function(e){null!=this.failedCallBack?this.failedCallBack(e):t.isDebug&&console.log("Failed call back is null, set it first ! ")},t}();t.isOutWeb=!0,t.isDebug=!0,t.baseServerUrl=" http://www.run7.pub/",t.withinLoginUrl="h601-login-service/mobiapi/1/",t.outLoginUrl="h601/login/",t.withinServerUrl="h601-logical-service/mobiapi/1/",t.outServerUrl="h601/logical/",e.WebServiceBase=t,__reflect(t.prototype,"Model.WebServiceBase",["Model.IWebServiceBase"]);var i=function(i){function n(t,n,o,r,a){return void 0===n&&(n=null),void 0===o&&(o=e.WebServiceType.Post),void 0===r&&(r=!1),void 0===a&&(a=!1),i.call(this,new e.WebServiceValue(t,n,!0,o),r,a)||this}return __extends(n,i),n.prototype.onSuccess=function(e){t.isDebug&&console.log("zhujun: WebServiceNonResponseBase onSuccess ! "),i.prototype.onSuccess.call(this,e),this.successCallBack(!0)},n}(t);e.WebServiceNonResponseBase=i,__reflect(i.prototype,"Model.WebServiceNonResponseBase");var n=function(i){function n(t,n,o,r,a){void 0===n&&(n=null),void 0===o&&(o=e.WebServiceType.Post),void 0===r&&(r=!1),void 0===a&&(a=!1);var l=this;return console.log("zhujun:   _paramList : any = null "+n),l=i.call(this,new e.WebServiceValue(t,n,null==n?!1:!0,o),r,a)||this}return __extends(n,i),n.prototype.onSuccess=function(e){t.isDebug&&console.log("zhujun: WebServiceResponseBase onSuccess ! "),i.prototype.onSuccess.call(this,e);var n=JSON.parse(e);this.successCallBack(n)},n}(t);e.WebServiceResponseBase=n,__reflect(n.prototype,"Model.WebServiceResponseBase")}(Model||(Model={}));var Model;!function(e){var t=function(){function e(){}return e}();e.Play68Model=t,__reflect(t.prototype,"Model.Play68Model");var i=function(){function e(){}return e}();e.P68UserInfo=i,__reflect(i.prototype,"Model.P68UserInfo")}(Model||(Model={}));var Model;!function(e){var t;!function(e){e[e.SYSTEM_ERROR=0]="SYSTEM_ERROR",e[e.SERVICE_TIMEOUT=1]="SERVICE_TIMEOUT",e[e.USER_NOT_EXISTS=2]="USER_NOT_EXISTS",e[e.URL_ERROR=3]="URL_ERROR",e[e.ERROR=4]="ERROR",e[e.UNKNOWN=0]="UNKNOWN",e[e.NO_ACTION=1]="NO_ACTION",e[e.NOT_MATCH=2]="NOT_MATCH",e[e.FAILED=5]="FAILED",e[e.DATA_EXCEPTION=18]="DATA_EXCEPTION",e[e.CODE_NOT_EXIST=610]="CODE_NOT_EXIST",e[e.CODE_HAVE_USED=611]="CODE_HAVE_USED",e[e.PACKAGE_NOT_EXIST=612]="PACKAGE_NOT_EXIST",e[e.PACKAGE_IS_NULL=613]="PACKAGE_IS_NULL",e[e.USER_CODE_HAVE_USED=614]="USER_CODE_HAVE_USED",e[e.USER_BACTCH_CODE_HAVE_USED=615]="USER_BACTCH_CODE_HAVE_USED",e[e.USER_PACKAGE_HAVE_USED_CODE=616]="USER_PACKAGE_HAVE_USED_CODE",e[e.CODE_EFFECTIVE_DATE=617]="CODE_EFFECTIVE_DATE",e[e.CODE_SERVER_NOT_USED=618]="CODE_SERVER_NOT_USED"}(t=e.WebServiceErrorCode||(e.WebServiceErrorCode={}));var i;!function(e){e[e.Get=0]="Get",e[e.Post=1]="Post"}(i=e.WebServiceType||(e.WebServiceType={}));var n=function(){function i(){this.customTimeOut=2e4,this.successCallBack=null,this.onProgressCallBack=null,this.wsValue=null,this.isShowFireWind=!1,this.isDone=!1}return Object.defineProperty(i.prototype,"UserToken",{get:function(){if(""!=e.WebValue.webServiceHeader)return e.WebValue.webServiceHeader;throw"Get some error hare ! "},enumerable:!0,configurable:!0}),i.prototype.changeHeader=function(t){""!=e.WebValue.webServiceHeader&&e.WebValue.webServiceHeader!=t?e.WebValue.webServiceHeader=t:console.log("zhujun: webServerHeader is no change ! ")},i.prototype.startService=function(){return console.log("zhujun: start service "+JSON.stringify(this.wsValue)),null==this.wsValue||null==this.successCallBack||null==this.failedCallBack?void(e.WebServiceBase.isDebug&&console.log("Service value is null, cant start service ! ")):(this.wsValue.Type==egret.HttpMethod.POST?this.wsValue.isJson?this.postWebServiceWithJson(this.wsValue.baseURL,JSON.stringify(this.wsValue.paramList)):this.postWebServiceWithoutJson(this.wsValue.baseURL,this.wsValue.paramList):this.getWebService(""),void(i.onRequestSend&&this.isShowFireWind&&i.onRequestSend()))},i.prototype.getWebService=function(e){var t=new egret.HttpRequest;t.open(e,this.wsValue.Type),this.CallService(t)},i.prototype.postWebServiceWithJson=function(e,t){var i=new egret.HttpRequest;i.open(e,this.wsValue.Type),this.CallService(i,t)},i.prototype.postWebServiceWithoutJson=function(e,t){var i=new egret.HttpRequest;i.open(e,this.wsValue.Type),this.CallService(i,t)},i.prototype.CallService=function(t,n){if(void 0===n&&(n=null),!e.WebValue.isWebService)return this.successCallBack(t.response),void console.log("zhujun: cant send web service , immediate return success ! ");t.responseType=egret.HttpResponseType.TEXT,console.log("zhujun: this.webServiceHeader "+e.WebValue.webServiceHeader),t.setRequestHeader("USER-TOKEN",e.WebValue.webServiceHeader),t.addEventListener(egret.Event.COMPLETE,this.onComplete,this),t.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onIOError,this),t.addEventListener(egret.ProgressEvent.PROGRESS,this.onProgress,this),null==n?t.send(!0):t.send(n);egret.getTimer();i.onResponseRecived&&this.isShowFireWind&&i.onResponseRecived},i.prototype.onComplete=function(e){this.isDone=!0;var t=e.currentTarget;console.log("back token ",t.getResponseHeader("USER-TOKEN")),this.changeHeader(t.getResponseHeader("USER-TOKEN")),console.log("post data : ",t.response),console.log("back token ",t.getResponseHeader("USER-TOKEN")),JSON.parse(t.response).errorMessage||JSON.parse(t.response).errorStatus||JSON.parse(t.response).errorCode?this.successCallBack&&this.failedCallBack(t.response):this.successCallBack&&this.successCallBack(t.response)},i.prototype.onIOError=function(e){this.isDone=!0,console.log("post error : "+e),null!=this.failedCallBack&&this.failedCallBack(t.SYSTEM_ERROR)},i.prototype.onProgress=function(e){this.isDone=!0,console.log("post progress : "+Math.floor(100*e.bytesLoaded/e.bytesTotal)+"%"),null!=this.onProgressCallBack&&this.onProgressCallBack(e)},i.prototype.clearListenerEvent=function(e){e.removeEventListener(egret.Event.COMPLETE,this.onComplete,this),e.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onIOError,this),e.removeEventListener(egret.ProgressEvent.PROGRESS,this.onProgress,this)},i}();n.onRequestSend=null,n.onResponseRecived=null,e.WebServiceToolKit=n,__reflect(n.prototype,"Model.WebServiceToolKit")}(Model||(Model={}));var Model;!function(e){var t=function(){function e(e,t){this.skillData=e,this.skillItem=t}return e}();e.FlyBoxSkillData=t,__reflect(t.prototype,"Model.FlyBoxSkillData")}(Model||(Model={}));var Model;!function(e){var t=function(){function t(e,t){this.tenUpgradeCost=0,this.hundredUpgradeCost=0,this.isShow=!1,this.sealCDMoney=0,this.reachRecruit=!1,this.recruitDemand=0,this.dy=e,this.st=t}return Object.defineProperty(t.prototype,"DpsDeltaUnit",{get:function(){return e.MainLocalService.toUnitConversion(this.dpsDelta)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"DpsNextAndUnit",{get:function(){return e.MainLocalService.toUnitConversion(this.dpsNext)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"DpsAndUnit",{get:function(){return e.MainLocalService.toUnitConversion(this.dps)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"LayerStr",{get:function(){switch(this.layerMatchLevel){case 1:return"第一重";case 2:return"第二重";case 3:return"第三重";case 4:return"第四重";case 5:return"第五重";case 6:return"第六重";case 7:return"第七重";default:return"满重"}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"LayerCostAndUnit",{get:function(){return e.MainLocalService.toUnitConversion(this.layerCost)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"UpgradeCostAndUnit",{get:function(){return e.MainLocalService.toUnitConversion(this.upgradeCost)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"TenUpgradeCostAndUnit",{get:function(){return e.MainLocalService.toUnitConversion(this.tenUpgradeCost)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hundredUpgradeCostAndUnit",{get:function(){return e.MainLocalService.toUnitConversion(this.hundredUpgradeCost)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"RecruitDemand",{get:function(){return e.MainLocalService.toUnitConversion(this.recruitDemand)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FirstLayerType",{get:function(){return e.SkillFloorType[this.st.firstLayerType]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"SecondLayerType",{get:function(){return e.SkillFloorType[this.st.secondLayerType]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ThirdLayerType",{get:function(){return e.SkillFloorType[this.st.thirdLayerType]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FourthLayerType",{get:function(){return e.SkillFloorType[this.st.fourthLayerType]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FifthLayerType",{get:function(){return e.SkillFloorType[this.st.fifthLayerType]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"SixthLayerType",{get:function(){return e.SkillFloorType[this.st.sixthLayerType]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"SeventhLayerType",{get:function(){return e.SkillFloorType[this.st.seventhLayerType]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"RecruitMoneyType",{get:function(){return e.MoneyType[this.st.recruitMoneyType]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"RecruitCost",{get:function(){return e.MainLocalService.toTenConversion(this.st.recruitCost,this.st.recruitCostMagnitude)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"RecruitCostAndUnit",{get:function(){return String(this.st.recruitCost+e.MainLocalService.getMagnitudeListById(this.st.recruitCostMagnitude))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsEnoughRecruit",{get:function(){return this.RecruitMoneyType==e.MoneyType.MONEY_TYPE_COIN?e.PlayerLocalService.isEnoughGold(this.RecruitCost):this.RecruitMoneyType==e.MoneyType.MONEY_TYPE_YB?e.PlayerLocalService.isEnoughSycee(this.RecruitCost):!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Type",{get:function(){return e.FriendType[this.st.type]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IdleJson",{get:function(){return this.st.idle+"_json"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IdlePng",{get:function(){return this.st.idle+"_png"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"AttackJson",{get:function(){return this.st.attack+"_json"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"AttackPng",{get:function(){return this.st.attack+"_png"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"EffectJson",{get:function(){return this.st.effect+"_json"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"EffectPng",{get:function(){return this.st.effect+"_png"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Effect",{get:function(){return this.st.effect+"_texiao"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Icon",{get:function(){return this.st.icon+"_png"},enumerable:!0,configurable:!0}),t}();e.FriendData=t,__reflect(t.prototype,"Model.FriendData")}(Model||(Model={}));var Model;!function(e){var t=function(){function t(e,t){this.dy=e,this.st=t}return Object.defineProperty(t.prototype,"TypeFirst",{get:function(){return e.MagicWeaponEffectType[this.st.weaponEffectTypeFirst]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"TypeSecond",{get:function(){return e.MagicWeaponEffectType[this.st.weaponEffectTypeSecond]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Icon",{get:function(){return this.st.icon+"_png"},enumerable:!0,configurable:!0}),t}();e.MagicWeaponData=t,__reflect(t.prototype,"Model.MagicWeaponData")}(Model||(Model={}));var AssetAdapter=function(){function e(){}return e.prototype.getAsset=function(e,t,i){function n(n){t.call(i,n,e)}if(RES.hasRes(e)){var o=RES.getRes(e);o?n(o):RES.getResAsync(e,n,this)}else RES.getResByUrl(e,n,this,RES.ResourceItem.TYPE_IMAGE)},e}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var Model;!function(e){var t=function(){function t(e){this.st=e}return Object.defineProperty(t.prototype,"Idle",{get:function(){return this.st.dragonBones+"_idle"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Hit",{get:function(){return this.st.dragonBones+"_hit"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"DBJson",{get:function(){return this.st.dragonBones+"_ske_json"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"DBPngJson",{get:function(){return this.st.dragonBones+"_tex_json"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"DBPng",{get:function(){return this.st.dragonBones+"_tex_png"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"AddHp",{set:function(t){this.hp+=t,e.WebServiceBase.isDebug&&console.log("zhujun: this.hp += _value  "+this.hp),this.hp<0&&(this.hp=0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"HpAndUnit",{get:function(){return e.MainLocalService.toUnitConversion(this.hp)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"HpMaxAndUnit",{get:function(){return e.MainLocalService.toUnitConversion(this.hpMax)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"DropMoneyAndUnit",{get:function(){return e.MainLocalService.toUnitConversion(this.dropMoney)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"MonsterType",{get:function(){return e.MonsterType[this.st.monsterType]},enumerable:!0,configurable:!0}),t}();e.MonsterData=t,__reflect(t.prototype,"Model.MonsterData")}(Model||(Model={}));var Model;!function(e){var t=function(){function t(e,t){this.perSecondTapDamage=0,this.currentDps=0,this.tenUpgradeCost=0,this.hundredUpgradeCost=0,this.allFriendLevel=0,this.allDamageAdd=0,this.allGoldAdd=0,this.allCritdDamageAdd=0,this.protectFriend=!1,this.friendFrameRate=0,this.offLineMoney=0,this.shopFlag=!0,this.isChallenge=!1,this.dy=e,this.st=t}return Object.defineProperty(t.prototype,"PerSecondTapDamage",{set:function(e){this.perSecondTapDamage+=e,this.CurrentDps=this.perSecondTapDamage+this.dy.friendDamage},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CurrentDps",{set:function(e){this.currentDps=e,Main.singleton.mainMenuVM.mainInfo.setCurrentDps(this.CurrentDpsAndUnit)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CurrentDpsAndUnit",{get:function(){return e.MainLocalService.toUnitConversion(this.currentDps)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Jewel",{set:function(e){this.dy.jewel=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"AddJewel",{set:function(e){this.dy.jewel=Number(this.dy.jewel)+e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Gold",{set:function(e){this.dy.gold=e,Main.singleton.mainGameVM.sceneInfo.setMoney(this.GoldAndUnit)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"AddGold",{set:function(e){this.dy.gold+=e,Main.singleton.mainGameVM.sceneInfo.setMoney(this.GoldAndUnit)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"GoldAndUnit",{get:function(){var t=e.MainLocalService.toUnitConversion(this.dy.gold);return t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ClickDamage",{set:function(e){this.dy.clickDamage=e,Main.singleton.mainMenuVM.mainInfo.setTapDamage(this.ClickDamageAndUnit)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ClickDamageAndUnit",{get:function(){var t=e.MainLocalService.toUnitConversion(this.dy.clickDamage);return t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ClickDamageDeltaUnit",{get:function(){return e.MainLocalService.toUnitConversion(this.clickDamageDelta)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"UpgradeCostAndUnit",{get:function(){return e.MainLocalService.toUnitConversion(this.upgradeCost)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"TenUpgradeCostAndUnit",{get:function(){return e.MainLocalService.toUnitConversion(this.tenUpgradeCost)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"HundredUpgradeCostAndUnit",{get:function(){return e.MainLocalService.toUnitConversion(this.hundredUpgradeCost)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FriendDamage",{set:function(e){this.dy.friendDamage=e,Main.singleton.mainMenuVM.mainInfo.setFriendDps(this.FriendDamageAndUnit)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FriendDamageAndUnit",{get:function(){var t=e.MainLocalService.toUnitConversion(this.dy.friendDamage);return t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"BaseCritDmageMultiple",{get:function(){var e=Number(this.st.baseCritDamageMultiple);return e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CritDamage",{get:function(){return this.critDamage=(this.BaseCritDmageMultiple+e.FriendLocalService.FriendSkillTypeCrit/100+e.MagicWeaponService.AddCritDamage/100+e.ClanLocalService.AddTypeCrit/100)*this.dy.clickDamage,this.critDamage},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CritRate",{get:function(){return this.critRate=100*this.st.baseCritProbability+e.FriendLocalService.FriendSkillTypeCritProbability/1+e.MagicWeaponService.AddCritChance/1,this.critRate>100&&(this.critRate=100),this.critRate},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"OffLineMoney",{get:function(){return e.MainLocalService.toUnitConversion(this.offLineMoney)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"EffectJson",{get:function(){return this.st.playerEffect+"_json"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"EffectPng",{get:function(){return this.st.playerEffect+"_png"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Effect",{get:function(){return this.st.playerEffect+"_texiao"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"AttackJson",{get:function(){return this.st.playerDragonBones+"_json"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"AttackPng",{get:function(){return this.st.playerDragonBones+"_png"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"PlayerAttack",{get:function(){return this.st.playerDragonBones+"_attack"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"PlayerIdle",{get:function(){return this.st.playerDragonBones+"_idle"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"DBJson",{get:function(){return this.st.playerDragonBones+"_ske_json"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"DBPngJson",{get:function(){return this.st.playerDragonBones+"_tex_json"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"DBPng",{get:function(){return this.st.playerDragonBones+"_tex_png"},enumerable:!0,configurable:!0}),t}();e.PlayerData=t,__reflect(t.prototype,"Model.PlayerData")}(Model||(Model={}));var Model;!function(e){var t=function(){function t(e,t){this.tenUpgradeCost=0,this.dy=e,this.st=t}return Object.defineProperty(t.prototype,"CostAndUnit",{get:function(){return e.MainLocalService.toUnitConversion(this.cost)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"TenUpgradeCostAndUnit",{get:function(){return e.MainLocalService.toUnitConversion(this.tenUpgradeCost)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Description",{get:function(){return this.st.description.replace("{}",this.effect.toString())},enumerable:!0,configurable:!0}),t}();e.PlayerSkillData=t,__reflect(t.prototype,"Model.PlayerSkillData")}(Model||(Model={}));var Model;!function(e){var t=function(){function e(e,t){this.currentMonster=0,this.monsterCount=0,this.sceneId=e,this.st=t}return e}();e.SceneData=t,__reflect(t.prototype,"Model.SceneData")}(Model||(Model={}));var Model;!function(e){var t=function(){function t(e,t){this.dy=e,this.st=t}return Object.defineProperty(t.prototype,"Icon",{get:function(){return this.st.icon+"_png"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"goldAndUnit",{get:function(){return e.MainLocalService.toUnitConversion(this.gold)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Type",{get:function(){return e.ShopType[this.st.type]},enumerable:!0,configurable:!0}),t}();e.ShopData=t,__reflect(t.prototype,"Model.ShopData")}(Model||(Model={}));var Main=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isThemeLoadEnd=!1,t.isResourceLoadEnd=!1,t.isLoginReady=!1,t.isDyDataReady=!1,t.isStDataReady=!1,t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),t.singleton=this;var i=new AssetAdapter;this.stage.registerImplementation("eui.IAssetAdapter",i),this.stage.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},t.prototype.onConfigComplete=function(e){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var t=new eui.Theme("resource/default.thm.json",this.stage);t.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this)},t.prototype.onThemeLoadComplete=function(){this.isThemeLoadEnd=!0,this.createLogoScene()},Object.defineProperty(t,"TTT",{get:function(){return alert("ttt"),""},enumerable:!0,configurable:!0}),t.prototype.createLogoScene=function(){var e=this;this.logoVM=new ViewModel.LogoVM(this,function(){console.log("Test: Logo and loading scene init finish ! ")});var t=egret.Tween.get(this.logoVM.logoGroup);t.to({alpha:1},500).call(function(){e.logoVM.loadingBarItem.visible=!0,RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,e.onResourceLoadComplete,e),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,e.onResourceLoadError,e),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,e.onResourceProgress,e),RES.loadGroup("preload")})},t.prototype.onResourceLoadComplete=function(e){var t=this;if("preload"==e.groupName){RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),this.isResourceLoadEnd=!0,this.logoVM.loadingBarItem.visible=!1;var i=egret.Tween.get(this.logoVM.logoGroup);i.to({alpha:0},500).call(function(){t.removeChild(t.logoVM),t.sendLogin(),t.createScene()})}},t.prototype.onResourceLoadError=function(e){console.warn("Group:"+e.groupName+" has failed to load"),this.onResourceLoadComplete(e)},t.prototype.onResourceProgress=function(e){"preload"==e.groupName&&this.logoVM.loadingBarItem.setProgress(e.itemsLoaded,e.itemsTotal)},t.prototype.sendLogin=function(){this.isLoginReady=!0,this.sendDyData(),this.sendStData()},t.prototype.sendDyData=function(){Model.WebService.updateDyData(function(e){Model.WebValue.dataDyModel=e,Model.WebServiceBase.isDebug&&console.log("zhujun: update dy data interface call back successed !　")},function(){Model.WebServiceBase.isDebug&&console.log("zhujun: update dy data interface call back failed ! ")})},t.prototype.sendStData=function(){Model.WebService.updateStData(function(e){Model.WebValue.dataStModel=e,Model.WebServiceBase.isDebug&&console.log("zhujun: update st data interface call back successed ! ")},function(){Model.WebServiceBase.isDebug&&console.log("zhujujn: update st data interface call back failed ! ")})},t.prototype.createScene=function(){Model.PlayerLocalService.initAllData(),Model.AudioService.Shared(),this.mainMenuVM=new ViewModel.MainMenuVM(this,function(){Model.WebServiceBase.isDebug&&console.log("zhujun: main menu vm call back successed !　")}),this.mainGameVM=new ViewModel.MainGameVM(this,function(){Model.WebServiceBase.isDebug&&console.log("zhujun: main game vm call back successed ! ")})},t}(eui.UILayer);__reflect(Main.prototype,"Main");var Model;!function(e){var t=function(){function e(){}return e}();e.AchievementDyModel=t,__reflect(t.prototype,"Model.AchievementDyModel")}(Model||(Model={}));var Model;!function(e){var t=function(){function e(){}return e}();e.AchievementStModel=t,__reflect(t.prototype,"Model.AchievementStModel")}(Model||(Model={}));var Model;!function(e){var t=function(){function e(){}return e}();e.BagDropStModel=t,__reflect(t.prototype,"Model.BagDropStModel")}(Model||(Model={}));var Model;!function(e){var t=function(){function e(){}return e}();e.ChallengeStModel=t,__reflect(t.prototype,"Model.ChallengeStModel")}(Model||(Model={}));var Model;!function(e){var t=function(){function e(e){this.clanId=e}return e}();e.ClanDyModel=t,__reflect(t.prototype,"Model.ClanDyModel")}(Model||(Model={}));var Model;!function(e){var t=function(){function e(){}return e}();e.ClanStModel=t,__reflect(t.prototype,"Model.ClanStModel")}(Model||(Model={}));var Model;!function(e){var t=function(){function e(){}return e}();e.CumulativeRechargeInfo=t,__reflect(t.prototype,"Model.CumulativeRechargeInfo")}(Model||(Model={}));var Model;!function(e){var t=function(){function e(){}return e}();e.CumulativeRechargeModel=t,__reflect(t.prototype,"Model.CumulativeRechargeModel")}(Model||(Model={}));var Model;!function(e){var t=function(){function e(){}return e}();e.DailyRechargeInfo=t,__reflect(t.prototype,"Model.DailyRechargeInfo")}(Model||(Model={}));var Model;!function(e){var t=function(){function e(){}return e}();e.DailyRechargeModel=t,__reflect(t.prototype,"Model.DailyRechargeModel")}(Model||(Model={}));var Model;!function(e){var t=function(){function e(){this.bgm=new egret.Sound,this.sound=new egret.Sound}return e.Shared=function(){return null==e.shared&&(e.shared=new e),e.shared},e.prototype.PlayBGM=function(e){e&&(this.bgmSrc=e,this.bgm=RES.getRes(this.bgmSrc)),this.IsMusic&&(this.bgmChannel=this.bgm.play(0,0))},e.prototype.StopBGM=function(){null!=this.bgmChannel&&this.bgmChannel.stop()},e.prototype.PlaySound=function(e){this.sound=RES.getRes(e),this.IsSound&&this.sound.play(0,1)},e.prototype.PlayLoopSound=function(e){this.sound=RES.getRes(this.soundSrc),this.IsSound&&this.sound.play(0,0)},Object.defineProperty(e.prototype,"IsMusic",{get:function(){var e=egret.localStorage.getItem("ismusic");return null==e||""==e?!0:"1"==e},set:function(e){e?(egret.localStorage.setItem("ismusic","1"),this.PlayBGM()):(egret.localStorage.setItem("ismusic","0"),this.StopBGM())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsSound",{get:function(){var e=egret.localStorage.getItem("isSound");return null==e||""==e?!0:"1"==e},set:function(e){e?egret.localStorage.setItem("isSound","1"):egret.localStorage.setItem("isSound","0")},enumerable:!0,configurable:!0}),e}();e.AudioService=t,__reflect(t.prototype,"Model.AudioService")}(Model||(Model={}));var Model;!function(e){var t=function(){function t(e,t){this.matchStage=0,this.RewardCount=0,this.getState=!1,this.st=e,this.dy=t}return Object.defineProperty(t.prototype,"Type",{get:function(){return e.AchievementType[this.st.type]},enumerable:!0,configurable:!0}),t}();e.AchievementData=t,__reflect(t.prototype,"Model.AchievementData")}(Model||(Model={}));var Model;!function(e){var t=function(){function e(e,t,i,n){void 0===n&&(n=0),this.friendId=e,this.level=t,this.layerId=i,this.sealCD=n}return e}();e.FriendDyModel=t,__reflect(t.prototype,"Model.FriendDyModel")}(Model||(Model={}));var Model;!function(e){var t=function(){function e(){}return e}();e.FriendStModel=t,__reflect(t.prototype,"Model.FriendStModel")}(Model||(Model={}));var Model;!function(e){var t=function(){function e(e,t){this.magicWeaponId=e,this.level=t}return e}();e.MagicWeaponDyModel=t,__reflect(t.prototype,"Model.MagicWeaponDyModel")}(Model||(Model={}));var Model;!function(e){var t=function(){function e(){}return e}();e.MagicWeaponStModel=t,__reflect(t.prototype,"Model.MagicWeaponStModel")}(Model||(Model={}));var Model;!function(e){var t=function(){function e(){}return e}();e.MagnitudeStModel=t,__reflect(t.prototype,"Model.MagnitudeStModel")}(Model||(Model={}));var Model;!function(e){var t=function(){function e(){}return e}();e.MonsterDyModel=t,__reflect(t.prototype,"Model.MonsterDyModel")}(Model||(Model={}));var Model;!function(e){var t=function(){function e(){}return e}();e.MonsterStModel=t,__reflect(t.prototype,"Model.MonsterStModel")}(Model||(Model={}));var Model;!function(e){var t=function(){function e(){}return e}();e.PartInDyModel=t,__reflect(t.prototype,"Model.PartInDyModel")}(Model||(Model={}));var Model;!function(e){var t=function(){function e(){}return e}();e.PlayerDyModel=t,__reflect(t.prototype,"Model.PlayerDyModel")}(Model||(Model={}));var Model;!function(e){var t=function(){function e(){}return e}();e.RankDPSModel=t,__reflect(t.prototype,"Model.RankDPSModel")}(Model||(Model={}));var Model;!function(e){var t=function(){function e(){}return e
}();e.RankDyModel=t,__reflect(t.prototype,"Model.RankDyModel")}(Model||(Model={}));var Model;!function(e){var t=function(){function e(){}return e}();e.RankRechargeModel=t,__reflect(t.prototype,"Model.RankRechargeModel")}(Model||(Model={}));var Model;!function(e){var t=function(){function e(){}return e}();e.RankSceneModel=t,__reflect(t.prototype,"Model.RankSceneModel")}(Model||(Model={}));var Model;!function(e){var t=function(){function e(){}return e}();e.SceneDyModel=t,__reflect(t.prototype,"Model.SceneDyModel")}(Model||(Model={}));var Model;!function(e){var t=function(){function e(){}return e}();e.SceneStModel=t,__reflect(t.prototype,"Model.SceneStModel")}(Model||(Model={}));var Model;!function(e){var t=function(){function e(e,t,i){this.shopId=e,this.lastShopTime=t,this.gold=i}return e}();e.ShopDyModel=t,__reflect(t.prototype,"Model.ShopDyModel")}(Model||(Model={}));var Model;!function(e){var t=function(){function e(){}return e}();e.ShopList=t,__reflect(t.prototype,"Model.ShopList")}(Model||(Model={}));var Model;!function(e){var t=function(){function e(){}return e}();e.ShopStModel=t,__reflect(t.prototype,"Model.ShopStModel")}(Model||(Model={}));var Model;!function(e){var t=function(){function e(e,t,i){this.skillId=e,this.level=t,this.cdTime=i}return e}();e.SkillDyModel=t,__reflect(t.prototype,"Model.SkillDyModel")}(Model||(Model={}));var Model;!function(e){var t=function(){function e(){}return e}();e.SkillStModel=t,__reflect(t.prototype,"Model.SkillStModel")}(Model||(Model={}));var Model;!function(e){var t=function(){function e(){}return e}();e.SystemConfigStModel=t,__reflect(t.prototype,"Model.SystemConfigStModel")}(Model||(Model={}));var Model;!function(e){var t=function(){function t(){}return Object.defineProperty(t,"AchievementList",{get:function(){return t.achievementList},enumerable:!0,configurable:!0}),t.setAchievementList=function(){if(t.achievementList){for(var i=0,n=t.achievementList;i<n.length;i++){var o=n[i];t.setCurrentState(o),t.setGetState(o)}t.achievementList=Enumerable.From(t.achievementList).OrderByDescending(function(e){return e.getState}).ThenBy(function(e){return e.dy.stage}).ToArray()}else{t.achievementList=[];for(var r=0,a=e.WebValue.dataStModel.achievementList;r<a.length;r++){var l=a[r],s=Enumerable.From(e.WebValue.dataDyModel.achievementModelList).Where(function(e){return e.achievementId==l.id}).FirstOrDefault(null),c=new e.AchievementData(l,s);t.setStageInfo(c),t.setCurrentState(c),t.achievementList.push(c)}}return t.achievementList},t.setStageInfo=function(t){t.firstValue=e.MainLocalService.toTenConversion(t.st.firstValue,t.st.firstMagnitude),t.secondValue=e.MainLocalService.toTenConversion(t.st.secondValue,t.st.secondMagnitude),t.thirdValue=e.MainLocalService.toTenConversion(t.st.thirdValue,t.st.thirdMagnitude),t.fourthValue=e.MainLocalService.toTenConversion(t.st.fourthValue,t.st.fourthMagnitude),t.fifthValue=e.MainLocalService.toTenConversion(t.st.fifthValue,t.st.fifthMagnitude)},t.setCurrentGet=function(i,n){switch(i){case e.AchievementType.ACHIEVEMENT_TYPE_KILL_ENEMY:var o=Enumerable.From(t.AchievementList).Where(function(t){return t.Type==e.AchievementType.ACHIEVEMENT_TYPE_KILL_ENEMY}).FirstOrDefault(null);o.dy.count+=n;break;case e.AchievementType.ACHIEVEMENT_TYPE_GET_COIN:var o=Enumerable.From(t.AchievementList).Where(function(t){return t.Type==e.AchievementType.ACHIEVEMENT_TYPE_GET_COIN}).FirstOrDefault(null);o.dy.count+=n;break;case e.AchievementType.ACHIEVEMENT_TYPE_ARRIVE_SCENE:var o=Enumerable.From(t.AchievementList).Where(function(t){return t.Type==e.AchievementType.ACHIEVEMENT_TYPE_ARRIVE_SCENE}).FirstOrDefault(null);o.dy.count=n;break;case e.AchievementType.ACHIEVEMENT_TYPE_GET_JEWEL:var o=Enumerable.From(t.AchievementList).Where(function(t){return t.Type==e.AchievementType.ACHIEVEMENT_TYPE_GET_JEWEL}).FirstOrDefault(null);o.dy.count+=n;break;case e.AchievementType.ACHIEVEMENT_TYPE_GET_MAGIC_WEAPON:var o=Enumerable.From(t.AchievementList).Where(function(t){return t.Type==e.AchievementType.ACHIEVEMENT_TYPE_GET_MAGIC_WEAPON}).FirstOrDefault(null);o.dy.count+=n;break;case e.AchievementType.ACHIEVEMENT_TYPE_FRIEND_DAMAGE:var o=Enumerable.From(t.AchievementList).Where(function(t){return t.Type==e.AchievementType.ACHIEVEMENT_TYPE_FRIEND_DAMAGE}).FirstOrDefault(null);o.dy.count=n?n:0;break;case e.AchievementType.ACHIEVEMENT_TYPE_GET_FRIEND:var o=Enumerable.From(t.AchievementList).Where(function(t){return t.Type==e.AchievementType.ACHIEVEMENT_TYPE_GET_FRIEND}).FirstOrDefault(null);o.dy.count+=n;break;case e.AchievementType.ACHIEVEMENT_TYPE_GET_GIFT:var o=Enumerable.From(t.AchievementList).Where(function(t){return t.Type==e.AchievementType.ACHIEVEMENT_TYPE_GET_GIFT}).FirstOrDefault(null);o.dy.count+=n;break;case e.AchievementType.ACHIEVEMENT_TYPE_GET_BOX:var o=Enumerable.From(t.AchievementList).Where(function(t){return t.Type==e.AchievementType.ACHIEVEMENT_TYPE_GET_BOX}).FirstOrDefault(null);console.log("cai_haotian baoxiang shu ju "+JSON.stringify(o)),o.dy.count+=n;break;case e.AchievementType.ACHIEVEMENT_TYPE_KILL_BOSS:var o=Enumerable.From(t.AchievementList).Where(function(t){return t.Type==e.AchievementType.ACHIEVEMENT_TYPE_KILL_BOSS}).FirstOrDefault(null);o.dy.count+=n;break;case e.AchievementType.ACHIEVEMENT_TYPE_USE_SKILL1:var o=Enumerable.From(t.AchievementList).Where(function(t){return t.Type==e.AchievementType.ACHIEVEMENT_TYPE_USE_SKILL1}).FirstOrDefault(null);o.dy.count+=n;break;case e.AchievementType.ACHIEVEMENT_TYPE_USE_SKILL2:var o=Enumerable.From(t.AchievementList).Where(function(t){return t.Type==e.AchievementType.ACHIEVEMENT_TYPE_USE_SKILL2}).FirstOrDefault(null);o.dy.count+=n;break;case e.AchievementType.ACHIEVEMENT_TYPE_USE_SKILL3:var o=Enumerable.From(t.AchievementList).Where(function(t){return t.Type==e.AchievementType.ACHIEVEMENT_TYPE_USE_SKILL3}).FirstOrDefault(null);o.dy.count+=n;break;case e.AchievementType.ACHIEVEMENT_TYPE_USE_SKILL4:var o=Enumerable.From(t.AchievementList).Where(function(t){return t.Type==e.AchievementType.ACHIEVEMENT_TYPE_USE_SKILL4}).FirstOrDefault(null);o.dy.count+=n;break;case e.AchievementType.ACHIEVEMENT_TYPE_USE_SKILL5:var o=Enumerable.From(t.AchievementList).Where(function(t){return t.Type==e.AchievementType.ACHIEVEMENT_TYPE_USE_SKILL5}).FirstOrDefault(null);o.dy.count+=n;break;case e.AchievementType.ACHIEVEMENT_TYPE_USE_SKILL6:var o=Enumerable.From(t.AchievementList).Where(function(t){return t.Type==e.AchievementType.ACHIEVEMENT_TYPE_USE_SKILL6}).FirstOrDefault(null);o.dy.count+=n;break;default:alert("成就信息出现错误！请联系管理员！！")}t.setCurrentState(o)},t.setCurrentState=function(t){return t.dy.count>=0&&t.dy.stage<1?(t.RewardType=e.RewardType[t.st.firstRewardType],t.RewardCount=t.st.firstRewardValue,void(t.matchStage=1)):t.dy.count>=t.firstValue&&t.dy.stage<2?(t.RewardType=e.RewardType[t.st.secondRewardType],t.RewardCount=t.st.secondRewardValue,void(t.matchStage=2)):t.dy.count>=t.secondValue&&t.dy.stage<3?(t.RewardType=e.RewardType[t.st.thirdRewardType],t.RewardCount=t.st.thirdRewardValue,void(t.matchStage=3)):t.dy.count>=t.thirdValue&&t.dy.stage<4?(t.RewardType=e.RewardType[t.st.fourthRewardType],t.RewardCount=t.st.fourthRewardValue,void(t.matchStage=4)):t.dy.count>=t.fourthValue&&t.dy.stage<5?(t.RewardType=e.RewardType[t.st.fifthRewardType],t.RewardCount=t.st.fifthRewardValue,void(t.matchStage=5)):void(t.dy.count>=t.fifthValue&&t.dy.stage>=5&&(t.matchStage=6))},t.setGetState=function(e){switch(e.matchStage){case 0:case 1:e.getState=e.dy.count>=e.firstValue?!0:!1;break;case 2:e.getState=e.dy.count>=e.secondValue?!0:!1;break;case 3:e.getState=e.dy.count>=e.thirdValue?!0:!1;break;case 4:e.getState=e.dy.count>=e.fourthValue?!0:!1;break;case 5:e.getState=e.dy.count>=e.fifthValue?!0:!1;break;case 6:break;default:alert("成就状态出错！！！c2")}},t.beAchieved=function(){for(var e=!0,i=0;e;){switch(t.AchievementList[i].matchStage){case 0:case 1:t.AchievementList[i].dy.count>=t.AchievementList[i].firstValue;break;case 2:t.AchievementList[i].dy.count>=t.AchievementList[i].secondValue;break;case 3:t.AchievementList[i].dy.count>=t.AchievementList[i].thirdValue;break;case 4:t.AchievementList[i].dy.count>=t.AchievementList[i].fourthValue;break;case 5:t.AchievementList[i].dy.count>=t.AchievementList[i].fifthValue;break;case 6:break;default:alert("成就状态出错！！！c2")}i++}},t}();t.achievementList=null,e.AchievementLocalService=t,__reflect(t.prototype,"Model.AchievementLocalService")}(Model||(Model={}));var Model;!function(e){var t=function(){function t(){}return Object.defineProperty(t,"ChallengeDataList",{get:function(){return t.challengeDataList},enumerable:!0,configurable:!0}),t.setChallengeData=function(){if(t.challengeDataList)for(var i=0,n=t.challengeDataList;i<n.length;i++){var o=n[i];t.setBossHp(o)}else{t.challengeDataList=[];for(var r=0,a=e.WebValue.dataStModel.challengeList;r<a.length;r++){var l=a[r],s=new e.ChallengeData(l);t.setBossHp(s),t.challengeDataList.push(s)}}},t.setBossHp=function(t){t.hpMax=Math.round(5*Math.pow(Number(e.WebValue.dataStModel.sysConfigModel.monsterHpRatio),e.WebValue.dataDyModel.playerModel.sceneId)*t.st.difficultNum*(1-e.MagicWeaponService.CutBossHp/100)),t.hp=t.hpMax},t.setChallengeCD=function(t){e.PlayerLocalService.PlayerData.dy.chanllengeTime=t},t.successBack=function(t){switch(e.WebServiceBase.isDebug&&console.log("cai_haotian   _data "+JSON.stringify(t)),t.Type){case e.DailyChallengeType.MONEY_TYPE_YB:e.PlayerLocalService.PlayerData.dy.treasure+=t.st.rewardCount;break;case e.DailyChallengeType.MONEY_TYPE_JEWEL:e.PlayerLocalService.PlayerData.AddJewel=t.st.rewardCount;break;case e.DailyChallengeType.REWARD_TYPE_CUT_BAGDROP_TIME:var i=new Date,n=i.getTime()/1e3;e.PlayerLocalService.PlayerData.dy.doubleProbabilityTime=n;break;case e.DailyChallengeType.REWARD_TYPE_USE_SKILL_DSTQ:var i=new Date,n=i.getTime()/1e3;e.PlayerLocalService.PlayerData.dy.freeSkillTime=n,e.PlayerLocalService.PlayerData.st.bagAppearTimeInterval/=2;break;default:alert("每日挑战奖励出错！c")}e.WebService.commitData(e.WebValue.dataDyModel,function(){e.WebServiceBase.isDebug&&console.log("cai_haotian: commitAuto success ! "+JSON.stringify(e.WebValue.dataDyModel))},function(){e.WebValue.isTraditional?alert("數據提交失敗請聯繫管理員！！！！"):alert("数据提交失败请联系管理员！！！！")})},t}();t.challengeDataList=null,e.ChallengeLoaclService=t,__reflect(t.prototype,"Model.ChallengeLoaclService")}(Model||(Model={}));var Model;!function(e){var t=function(){function t(){}return Object.defineProperty(t,"ClanListData",{get:function(){return t.clanListData},enumerable:!0,configurable:!0}),Object.defineProperty(t,"AddTypeAll",{get:function(){return t.addTypeAll},enumerable:!0,configurable:!0}),Object.defineProperty(t,"AddTypeClick",{get:function(){return t.addTypeClick},enumerable:!0,configurable:!0}),Object.defineProperty(t,"AddTypeCrit",{get:function(){return t.addTypeCrit},enumerable:!0,configurable:!0}),Object.defineProperty(t,"CutSkillCd",{get:function(){return t.cutSkillCd},enumerable:!0,configurable:!0}),t.setClanList=function(){if(t.clanListData){t.addTypeAll=0,t.addTypeClick=0,t.addTypeCrit=0,t.cutSkillCd=0,e.WebValue.dataDyModel.clanModelList=[];for(var i=0,n=t.clanListData;i<n.length;i++){var o=n[i];t.setClanAttribute(o),e.WebValue.dataDyModel.clanModelList.push(o.dy)}}else{t.clanListData=[];for(var r=0,a=e.WebValue.dataStModel.clanList;r<a.length;r++){var l=a[r],s=Enumerable.From(e.WebValue.dataDyModel.clanModelList).Where(function(e){return e.clanId==l.id}).FirstOrDefault(null),c=new e.ClanData(l,s);t.setClanAttribute(c),t.clanListData.push(c)}}return t.clanListData},t.setClanAttribute=function(i){if(i.dy)switch(i.Type){case e.FamliyType.CLAN_TYPE_ALL:t.addTypeAll+=i.st.clanValue;break;case e.FamliyType.CLAN_TYPE_CLICK:t.addTypeClick+=i.st.clanValue;break;case e.FamliyType.CLAN_TYPE_CRIT:t.addTypeCrit+=i.st.clanValue;break;case e.FamliyType.CLAN_TYPE_CUT_SKILL_CD:t.cutSkillCd+=i.st.clanValue;break;default:alert("家族加成属性出错！！请联系管理员！c")}},t.buySuccessCallBack=function(t){e.PlayerLocalService.PlayerData.dy.treasure-=t.st.activationCost;var i=new e.ClanDyModel(t.st.id);t.dy=i,e.PlayerLocalService.initAllData()},t}();t.clanListData=null,t.addTypeAll=0,t.addTypeClick=0,t.addTypeCrit=0,t.cutSkillCd=0,e.ClanLocalService=t,__reflect(t.prototype,"Model.ClanLocalService")}(Model||(Model={}));var Model;!function(e){var t=function(){function t(){}return t.setDropList=function(){if(t.dropList)e.WebServiceBase.isDebug&&console.log("cai_haotian 盒子的掉落数据一直是不变的");else{t.dropList=[],t.skillInfo=[],t.currencyInfo=[];for(var i=0;i<e.WebValue.dataStModel.bagdropList.length;i++)t.dropList.push(e.WebValue.dataStModel.bagdropList[i]);var n=new e.FlyBoxSkillData(e.PlayerSkillLocalService.PlayerSkillList[1],Main.singleton.mainMenuVM.mainInfo.skillGroup.getChildAt(1));t.skillInfo.push(n);var o=new e.FlyBoxSkillData(e.PlayerSkillLocalService.PlayerSkillList[2],Main.singleton.mainMenuVM.mainInfo.skillGroup.getChildAt(2));t.skillInfo.push(o);var r=new e.FlyBoxSkillData(e.PlayerSkillLocalService.PlayerSkillList[3],Main.singleton.mainMenuVM.mainInfo.skillGroup.getChildAt(3));t.skillInfo.push(r);var a=new e.FlyBoxSkillData(e.PlayerSkillLocalService.PlayerSkillList[4],Main.singleton.mainMenuVM.mainInfo.skillGroup.getChildAt(4));t.skillInfo.push(a),t.currencyInfo=Enumerable.From(t.dropList).Where(function(e){return 0==e.goOnTime}).ToArray(),e.WebServiceBase.isDebug&&(console.log("cai_haotian currency "+JSON.stringify(t.currencyInfo)),console.log("cai_haotian skill"+t.skillInfo))}return t.dropList},t.getCurrency=function(i){if(i>=0&&i<=.05*t.currencyInfo[0].probability-1)return e.PlayerLocalService.PlayerData.AddJewel=1,e.AchievementLocalService.setCurrentGet(e.AchievementType.ACHIEVEMENT_TYPE_GET_JEWEL,1),t.currencyInfo[0].dropTypeDescribe;if(i>=.05*t.currencyInfo[0].probability&&i<=.1*t.currencyInfo[2].probability-1)return e.PlayerLocalService.PlayerData.dy.treasure+=2,t.currencyInfo[2].dropTypeDescribe;if(i>=.1*t.currencyInfo[2].probability&&i<=.1*t.currencyInfo[1].probability-1){var n=e.MonsterLocalService.MonsterList[e.SceneLocalService.SceneData.currentMonster].hp,o=e.FriendLocalService.FriendSkillTypeCoin/100,r=e.MagicWeaponService.AddCoin/100,a=Math.ceil(n/5*(1+o+r));e.PlayerLocalService.PlayerData.AddGold=a;var l=t.currencyInfo[1].dropTypeDescribe.replace("{}",e.MainLocalService.toUnitConversion(a));return e.AchievementLocalService.setCurrentGet(e.AchievementType.ACHIEVEMENT_TYPE_GET_COIN,a),l}e.PlayerLocalService.initAllData()},t}();t.dropList=null,t.skillInfo=null,t.currencyInfo=null,e.FlyBoxLocalService=t,__reflect(t.prototype,"Model.FlyBoxLocalService")}(Model||(Model={}));var Model;!function(e){var t=function(){function t(){}return Object.defineProperty(t,"FriendSkillTypeAll",{get:function(){return t.friendSkillTypeAll},enumerable:!0,configurable:!0}),Object.defineProperty(t,"FriendSkillTypeCrit",{get:function(){return t.friendSkillTypeCrit},enumerable:!0,configurable:!0}),Object.defineProperty(t,"FriendSkillTypeCritProbability",{get:function(){return t.friendSkillTypeCritProbability},enumerable:!0,configurable:!0}),Object.defineProperty(t,"FriendSkillTypeClick",{get:function(){return t.friendSkillTypeClick},enumerable:!0,configurable:!0}),Object.defineProperty(t,"FriendSkillTypeCoin",{get:function(){return t.friendSkillTypeCoin},enumerable:!0,configurable:!0}),Object.defineProperty(t,"FriendSkillTypeBoxCoin",{get:function(){return t.friendSkillTypeBoxCoin},enumerable:!0,configurable:!0}),Object.defineProperty(t,"FriendSkilTypeBoss",{get:function(){return t.friendSkillTypeBoss},enumerable:!0,configurable:!0}),Object.defineProperty(t,"FriendList",{get:function(){return t.friendList},enumerable:!0,configurable:!0}),t.setFriendList=function(){if(e.PlayerLocalService.PlayerData.dy.friendDamage=0,t.friendSkillTypeAll=0,t.friendSkillTypeCrit=0,t.friendSkillTypeCritProbability=0,t.friendSkillTypeClick=0,t.friendSkillTypeCoin=0,t.friendSkillTypeBoxCoin=0,t.friendSkillTypeBoss=0,t.friendList){e.WebValue.dataDyModel.friendModelList=[],e.PlayerLocalService.PlayerData.allFriendLevel=0;for(var i=0;i<t.friendList.length;i++)t.updateFriendData(t.friendList[i]),e.WebValue.dataDyModel.friendModelList.push(t.friendList[i].dy)}else{t.friendList=[];for(var i=0;i<e.WebValue.dataStModel.friendSkillList.length;i++){var n=Enumerable.From(e.WebValue.dataDyModel.friendModelList).Where(function(t){return t.friendId==e.WebValue.dataStModel.friendSkillList[i].id}).FirstOrDefault(null),o=new e.FriendData(n,e.WebValue.dataStModel.friendSkillList[i]);t.updateFriendData(o),t.friendList.push(o),t.recruitDemand(o)}}return t.friendList},t.updateFriendData=function(i){if(i.layerPercent=0,i.dpsBase=e.MainLocalService.toTenConversion(i.st.baseDamage,i.st.baseDamageMagnitude),i.dy){t.layerMatch(i),i.upgradeBaseCost=e.MainLocalService.toTenConversion(i.st.upgradeBaseCost,i.st.baseCostMagnitude),i.upgradeCost=t.friendUpgradeCost(i.upgradeBaseCost,i.st.upgradeCostMultiple,i.dy.level),i.tenUpgradeCost=t.tenFriendUpgradeCost(i.upgradeBaseCost,i.st.upgradeCostMultiple,i.dy.level),i.hundredUpgradeCost=t.hundredFriendUpgradeCost(i.upgradeBaseCost,i.st.upgradeCostMultiple,i.dy.level),i.layerCost=t.layerCost(i.upgradeCost),i.layerMatchLevel=t.layerMatchLevel(i.dy),i.dps=t.setFriendEffect(i),i.dpsNext=t.setFriendEffect(i,!0),i.dpsDelta=i.dpsNext-i.dps;var n=new Date,o=n.getTime()/1e3;i.dy.sealCD<o&&(e.PlayerLocalService.PlayerData.dy.friendDamage+=i.dps,i.dy.sealCD=0),e.PlayerLocalService.PlayerData.allFriendLevel+=i.dy.level}else i.upgradeBaseCost=e.MainLocalService.toTenConversion(i.st.upgradeBaseCost,i.st.baseCostMagnitude),i.upgradeCost=t.friendUpgradeCost(i.upgradeBaseCost,i.st.upgradeCostMultiple,1),i.layerCost=t.layerCost(i.upgradeCost),i.dps=t.setFriendEffect(i),i.dpsDelta=i.dps,e.PlayerLocalService.PlayerData.dy.friendDamage+=0},t.setFriendEffect=function(i,n){if(void 0===n&&(n=!1),i.dy){if(n)var o=i.dpsBase*Math.pow(i.st.upgradeDamageMultiple,i.dy.level);else var o=i.dpsBase*Math.pow(i.st.upgradeDamageMultiple,i.dy.level-1);switch(i.Type){case e.FriendType.FRIEND_TYPE_FRIEND:o=o*(100+i.layerPercent+t.FriendSkillTypeAll+e.MagicWeaponService.AddCommon+e.ClanLocalService.AddTypeAll)/100;break;case e.FriendType.FRIEND_TYPE_SKILL:o=o*(100+i.layerPercent+t.FriendSkillTypeAll+e.MagicWeaponService.AddCommon+e.MagicWeaponService.AddAllSkillDamage+e.ClanLocalService.AddTypeAll)/100;break;default:alert("挚友类型错误,请联系客服 ! ")}}else{var o=i.dpsBase*Math.pow(i.st.upgradeDamageMultiple,0);switch(i.Type){case e.FriendType.FRIEND_TYPE_FRIEND:o=o*(100+t.FriendSkillTypeAll+e.MagicWeaponService.AddCommon+e.ClanLocalService.AddTypeAll)/100;break;case e.FriendType.FRIEND_TYPE_SKILL:o=o*(100+t.FriendSkillTypeAll+e.MagicWeaponService.AddCommon+e.MagicWeaponService.AddAllSkillDamage+e.ClanLocalService.AddTypeAll)/100;break;default:alert("挚友类型错误,请联系客服 ! ")}}return o},t.friendUpgradeCost=function(e,t,i){var n=0,n=e*Math.pow(t,i-1);return n},t.tenFriendUpgradeCost=function(e,t,i){for(var n=0,o=0;10>o;o++)n+=e*Math.pow(t,i+o-1);return n},t.hundredFriendUpgradeCost=function(e,t,i){for(var n=0,o=0;100>o;o++)n+=e*Math.pow(t,i+o-1);return n},t.recruitDemand=function(e){e.recruitDemand=Number(e.upgradeBaseCost)*Math.pow(Number(e.st.upgradeCostMultiple),1)},t.isShow=function(t,i){if(e.PlayerLocalService.PlayerData.dy.gold>=t.recruitDemand)t.reachRecruit=!0;else{var n=Enumerable.From(i).Select(function(e){return 1==e.reachRecruit}).FirstOrDefault(null);if(n)var o=Enumerable.From(i).Where(function(e){return 1==e.reachRecruit}).Max(function(e){return e.st.id});else var o=0;(o>=t.st.id||t.st.id-o==1)&&(t.isShow=!0)}},t.layerCost=function(e){var t=5*e;return t},t.layerMatchLevel=function(t){var i=0;return parseInt(e.WebValue.dataStModel.sysConfigModel.openFriendSkillLevelFirst)<=t.level&&0==t.layerId?i=1:parseInt(e.WebValue.dataStModel.sysConfigModel.openFriendSkillLevelSecond)<=t.level&&1==t.layerId?i=2:parseInt(e.WebValue.dataStModel.sysConfigModel.openFriendSkillLevelThird)<=t.level&&2==t.layerId?i=3:parseInt(e.WebValue.dataStModel.sysConfigModel.openFriendSkillLevelFourth)<=t.level&&3==t.layerId?i=4:parseInt(e.WebValue.dataStModel.sysConfigModel.openFriendSkillLevelFifth)<=t.level&&4==t.layerId?i=5:parseInt(e.WebValue.dataStModel.sysConfigModel.openFriendSkillLevelSixth)<=t.level&&5==t.layerId?i=6:parseInt(e.WebValue.dataStModel.sysConfigModel.openFriendSkillLevelSeventh)<=t.level?i=7:i},t.layerMatch=function(i){switch(i.dy.layerId){case 7:t.setFriendLayerEffect(i.SeventhLayerType,i.st.seventhLayerValue,i);case 6:t.setFriendLayerEffect(i.SixthLayerType,i.st.sixthLayerValue,i);case 5:t.setFriendLayerEffect(i.FifthLayerType,i.st.fifthLayerValue,i);case 4:t.setFriendLayerEffect(i.FourthLayerType,i.st.fourthLayerValue,i);case 3:t.setFriendLayerEffect(i.ThirdLayerType,i.st.thirdLayerValue,i);case 2:t.setFriendLayerEffect(i.SecondLayerType,i.st.secondLayerValue,i);case 1:t.setFriendLayerEffect(i.FirstLayerType,i.st.firstLayerValue,i);break;case 0:i.layerPercent=0,e.WebServiceBase.isDebug&&console.log("zhujun: no friend layer , until break ! ");break;default:alert("技能层级数据异常,请联系客服人员 ! ")}},t.setFriendLayerEffect=function(i,n,o){if(i==e.SkillFloorType.FRIEND_SKILL_TYPE_SLEF)return void(o.layerPercent+=n);if(!(o.dy.sealCD>0))switch(i){case e.SkillFloorType.FRIEND_SKILL_TYPE_ALL:t.friendSkillTypeAll+=n;break;case e.SkillFloorType.FRIEND_SKILL_TYPE_CRIT:t.friendSkillTypeCrit+=n;break;case e.SkillFloorType.FRIEND_SKILL_TYPE_CRIT_PROBABILITY:t.friendSkillTypeCritProbability+=n;break;case e.SkillFloorType.FRIEND_SKILL_TYPE_CLICK:t.friendSkillTypeClick+=n;break;case e.SkillFloorType.FRIEND_SKILL_TYPE_COIN:t.friendSkillTypeCoin+=n;break;case e.SkillFloorType.FRIEND_SKILL_TYPE_BOX_COIN:t.friendSkillTypeBoxCoin+=n;break;case e.SkillFloorType.FRIEND_SKILL_TYPE_BOSS:t.friendSkillTypeBoss+=n;break;default:alert("挚友层级类型有误,请联系客服人员 ! ")}},t.buySuccessedCallBack=function(t){t.dy=new e.FriendDyModel(t.st.id,1,0),t.RecruitMoneyType==e.MoneyType.MONEY_TYPE_COIN?e.PlayerLocalService.changeGold(-t.RecruitCost):t.RecruitMoneyType==e.MoneyType.MONEY_TYPE_YB?e.PlayerLocalService.changeSycee(-t.st.recruitCost):alert("您的货币类型不正确,请及时联系客服!"),e.PlayerLocalService.initAllData()},t.upgradeSuccessedCallBack=function(t,i){switch(i){case 1:t.dy.level+=1,e.PlayerLocalService.PlayerData.AddGold=-t.upgradeCost;break;case 10:t.dy.level+=10,e.PlayerLocalService.PlayerData.AddGold=-t.tenUpgradeCost;break;case 100:t.dy.level+=100,e.PlayerLocalService.PlayerData.AddGold=-t.hundredUpgradeCost;break;default:alert("挚友升级出错，请联系管理员！")}e.PlayerLocalService.initAllData()},t.layerSuccessedCallBack=function(t){t.dy.layerId+=1,e.PlayerLocalService.PlayerData.AddGold=-t.layerCost,e.PlayerLocalService.initAllData()},t.sealFriendAndSkills=function(){if(!(e.PlayerLocalService.PlayerData.dy.sceneId<e.PlayerLocalService.PlayerData.st.dieSceneCount)){var i=e.Mathf.random(0,1e4);if(!(i>=e.PlayerLocalService.PlayerData.st.bossSkillFriendProbability)){var n=Enumerable.From(t.FriendList).Where(function(e){return null!=e.dy}).ToArray();if(n.length){var o=new Date,r=o.getTime()/1e3,a=n[e.Mathf.random(0,n.length)];a.dy.sealCD=Math.round(Number(r)+e.Mathf.random(e.PlayerLocalService.PlayerData.st.bossSkillFriendTimeMin,e.PlayerLocalService.PlayerData.st.bossSkillFriendTimeMax)),e.WebServiceBase.isDebug&&console.log("cht sealcd is"+a.dy.sealCD),e.PlayerLocalService.initAllData(),Main.singleton.mainGameVM.switchFriend(a)}e.WebService.commitData(e.WebValue.dataDyModel,function(){e.WebServiceBase.isDebug&&console.log("cai_haotian: commitAuto success ! "+JSON.stringify(e.WebValue.dataDyModel))},function(){e.WebValue.isTraditional?alert("數據提交失敗請聯繫管理員！！！！"):alert("数据提交失败请联系管理员！！！！")})}}},t.setResurgenceMoney=function(e,t){e.sealCDMoney=Math.round(t/1800)},t.removeSealCD=function(t){e.PlayerLocalService.PlayerData.dy.treasure-=t.sealCDMoney,t.dy.sealCD=0,e.PlayerLocalService.initAllData(),Main.singleton.mainGameVM.switchFriend(t)},t}();t.friendSkillTypeAll=0,t.friendSkillTypeCrit=0,t.friendSkillTypeCritProbability=0,t.friendSkillTypeClick=0,t.friendSkillTypeCoin=0,t.friendSkillTypeBoxCoin=0,t.friendSkillTypeBoss=0,t.friendList=null,e.FriendLocalService=t,__reflect(t.prototype,"Model.FriendLocalService")}(Model||(Model={}));var PageName;!function(e){e[e.MainInfo=0]="MainInfo",e[e.Player=1]="Player",e[e.Friend=2]="Friend",e[e.MagicWeapon=3]="MagicWeapon",e[e.Mall=4]="Mall"}(PageName||(PageName={}));var Model;!function(e){var t=function(){function e(){}return e}();e.LocalValue=t,__reflect(t.prototype,"Model.LocalValue")}(Model||(Model={}));var Model;!function(e){var t=function(){function t(){}return Object.defineProperty(t,"MagicWeaponList",{get:function(){return t.magicWeaponList},set:function(e){t.magicWeaponList=e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"BuyCost",{get:function(){return t.buyCost},enumerable:!0,configurable:!0}),Object.defineProperty(t,"AddCommon",{get:function(){return t.addCommon},enumerable:!0,configurable:!0}),Object.defineProperty(t,"CutEnemyCount",{get:function(){return t.cutEnemyCount},enumerable:!0,configurable:!0}),Object.defineProperty(t,"AddOffLineCoin",{get:function(){return t.addOffLineCoin},enumerable:!0,configurable:!0}),Object.defineProperty(t,"CutSkillSealTime",{get:function(){return t.cutSkillSealTime},enumerable:!0,configurable:!0}),Object.defineProperty(t,"CutID1SkillCD",{get:function(){return t.cutID1SkillCD},enumerable:!0,configurable:!0}),Object.defineProperty(t,"AddCoin",{get:function(){return t.addCoin},enumerable:!0,configurable:!0}),Object.defineProperty(t,"CutBossHp",{get:function(){return t.cutBossHp},enumerable:!0,configurable:!0}),Object.defineProperty(t,"AddID3SkillTime",{get:function(){return t.addID3SkillTime},enumerable:!0,configurable:!0}),Object.defineProperty(t,"AddCritDamage",{get:function(){return t.addCritDamage},enumerable:!0,configurable:!0}),Object.defineProperty(t,"AddID1SkillDamage",{get:function(){return t.addID1SkillDamage},enumerable:!0,configurable:!0}),Object.defineProperty(t,"AddID2SkillTime",{get:function(){return t.addID2SkillTime},enumerable:!0,configurable:!0}),Object.defineProperty(t,"CutID4SkillCD",{get:function(){return t.cutID4SkillCD},enumerable:!0,configurable:!0}),Object.defineProperty(t,"CutID3SkillCD",{get:function(){return t.cutID3SkillCD},enumerable:!0,configurable:!0}),Object.defineProperty(t,"AddAllSkillDamage",{get:function(){return t.addAllSkillDamage},enumerable:!0,configurable:!0}),Object.defineProperty(t,"AddID5SkillTime",{get:function(){return t.addID5SkillTime},enumerable:!0,configurable:!0}),Object.defineProperty(t,"AddBoxCoin",{get:function(){return t.addBoxCoin},enumerable:!0,configurable:!0}),Object.defineProperty(t,"AddClickDamage",{get:function(){return t.addClickDamage},enumerable:!0,configurable:!0}),Object.defineProperty(t,"AddCritChance",{get:function(){return t.addCritChance},enumerable:!0,configurable:!0}),Object.defineProperty(t,"CutID2SkillCD",{get:function(){return t.cutID2SkillCD},enumerable:!0,configurable:!0}),Object.defineProperty(t,"CutSkillUselessChance",{get:function(){return t.cutSkillUselessChance},enumerable:!0,configurable:!0}),Object.defineProperty(t,"CutUpLevelMoney",{get:function(){return t.cutUpLevelMoney},enumerable:!0,configurable:!0}),Object.defineProperty(t,"AddChestChance",{get:function(){return t.addChestChance},enumerable:!0,configurable:!0}),Object.defineProperty(t,"CutID5SkillCD",{get:function(){return t.cutID5SkillCD},enumerable:!0,configurable:!0}),Object.defineProperty(t,"CutID6SkillCD",{get:function(){return t.cutID6SkillCD},enumerable:!0,configurable:!0}),Object.defineProperty(t,"AddID4SkillTime",{get:function(){return t.addID4SkillTime},enumerable:!0,configurable:!0}),Object.defineProperty(t,"AddBossTime",{get:function(){return t.addBossTime},enumerable:!0,configurable:!0}),Object.defineProperty(t,"AddBossCoin",{get:function(){return t.addBossCoin},enumerable:!0,configurable:!0}),Object.defineProperty(t,"AddMuchCoinChance",{get:function(){return t.addMuchCoinChance},enumerable:!0,configurable:!0}),t.setMagicWeaponList=function(){if(t.addCommon=0,t.cutEnemyCount=0,t.addOffLineCoin=0,t.cutSkillSealTime=0,t.cutID1SkillCD=0,t.addCoin=0,t.cutBossHp=0,t.addID3SkillTime=0,t.addCritDamage=0,t.addID1SkillDamage=0,t.addID2SkillTime=0,t.cutID4SkillCD=0,t.cutID3SkillCD=0,t.addAllSkillDamage=0,t.addID5SkillTime=0,t.addBoxCoin=0,t.addClickDamage=0,t.addCritChance=0,t.cutID2SkillCD=0,t.cutSkillUselessChance=0,t.cutUpLevelMoney=0,t.addChestChance=0,t.cutID5SkillCD=0,t.cutID6SkillCD=0,t.addID4SkillTime=0,t.addBossTime=0,t.addBossCoin=0,t.addMuchCoinChance=0,t.magicWeaponList){e.WebValue.dataDyModel.magicWeaponModelList=[];for(var i=0;i<t.magicWeaponList.length;i++)t.updateMagicWeaponInfo(t.magicWeaponList[i]),e.WebValue.dataDyModel.magicWeaponModelList.push(t.magicWeaponList[i].dy)}else{t.magicWeaponList=[],e.WebServiceBase.isDebug&&console.log("zhujun: WebValue.dataDyModel.magicWeaponModelList "+JSON.stringify(e.WebValue.dataDyModel.magicWeaponModelList));for(var i=0;i<e.WebValue.dataStModel.magicWeaponList.length;i++){var n=Enumerable.From(e.WebValue.dataDyModel.magicWeaponModelList).Where(function(t){return t.magicWeaponId==e.WebValue.dataStModel.magicWeaponList[i].id}).FirstOrDefault(null),o=new e.MagicWeaponData(n,e.WebValue.dataStModel.magicWeaponList[i]);t.updateMagicWeaponInfo(o),t.magicWeaponList.push(o)}t.MagicWeaponList=Enumerable.From(t.MagicWeaponList).OrderBy(function(e){return null==e.dy}).ThenBy(function(e){return e.st.id}).ToArray()}return t.setMagicWeaponBuyCost(),t.magicWeaponList},t.updateMagicWeaponInfo=function(e,i){void 0===i&&(i=!1),e.dy?(i?(t.setMagicWeaponEffect(e.TypeFirst,e.effectFirstNext-e.effectFirst),e.effectFirst=t.magicWeaponEffect(e.st.weaponEffectValueFirst,e.dy.level),e.effectFirstNext=t.magicWeaponEffect(e.st.weaponEffectValueFirst,e.dy.level+1),t.setMagicWeaponEffect(e.TypeSecond,e.effectSecondNext-e.effectSecond),e.effectSecond=t.magicWeaponEffect(e.st.weaponEffectValueSecond,e.dy.level),e.effectSecondNext=t.magicWeaponEffect(e.st.weaponEffectValueSecond,e.dy.level+1)):(e.effectFirstNext=t.magicWeaponEffect(e.st.weaponEffectValueFirst,e.dy.level+1),e.effectFirst=t.magicWeaponEffect(e.st.weaponEffectValueFirst,e.dy.level),t.setMagicWeaponEffect(e.TypeFirst,e.effectFirst),e.effectSecondNext=t.magicWeaponEffect(e.st.weaponEffectValueSecond,e.dy.level+1),e.effectSecond=t.magicWeaponEffect(e.st.weaponEffectValueSecond,e.dy.level),t.setMagicWeaponEffect(e.TypeSecond,e.effectSecond)),e.upgradeCost=t.magicWeaponCost(e.st.upgradeBaseCost,e.dy.level)):(e.upgradeCost=t.magicWeaponCost(e.st.upgradeBaseCost,1),e.effectFirst=t.magicWeaponEffect(e.st.weaponEffectValueFirst,1),e.effectSecond=t.magicWeaponEffect(e.st.weaponEffectValueSecond,1))},t.setMagicWeaponEffect=function(i,n){switch(i){case e.MagicWeaponEffectType.WEAPON_TYPE_ADD_COMMON:t.addCommon+=n;break;case e.MagicWeaponEffectType.WEAPON_TYPE_CUT_ENEMY_COUNT:t.cutEnemyCount+=n;break;case e.MagicWeaponEffectType.WEAPON_TYPE_ADD_OFFLINE_COIN:t.addOffLineCoin+=n;break;case e.MagicWeaponEffectType.WEAPON_TYPE_CUT_SKILL_SEAL_TIME:t.cutSkillSealTime+=n;break;case e.MagicWeaponEffectType.WEAPON_TYPE_CUT_ID1_SKILL_CD:t.cutID1SkillCD+=n;break;case e.MagicWeaponEffectType.WEAPON_TYPE_ADD_COIN:t.addCoin+=n;break;case e.MagicWeaponEffectType.WEAPON_TYPE_CUT_BOSS_HP:t.cutBossHp+=n;break;case e.MagicWeaponEffectType.WEAPON_TYPE_ADD_ID3_SKILL_TIME:t.addID3SkillTime+=n;break;case e.MagicWeaponEffectType.WEAPON_TYPE_ADD_CRIT_DAMAGE:t.addCritDamage+=n;break;case e.MagicWeaponEffectType.WEAPON_TYPE_ADD_ID1_SKILL_DAMAGE:t.addID1SkillDamage+=n;break;case e.MagicWeaponEffectType.WEAPON_TYPE_ADD_ID2_SKILL_TIME:t.addID2SkillTime+=n;break;case e.MagicWeaponEffectType.WEAPON_TYPE_CUT_ID4_SKILL_CD:t.cutID4SkillCD+=n;break;case e.MagicWeaponEffectType.WEAPON_TYPE_CUT_ID3_SKILL_CD:t.cutID3SkillCD+=n;break;case e.MagicWeaponEffectType.WEAPON_TYPE_ADD_ALL_SKILL_DAMAGE:t.addAllSkillDamage+=n;break;case e.MagicWeaponEffectType.WEAPON_TYPE_ADD_ID5_SKILL_TIME:t.addID5SkillTime+=n;break;case e.MagicWeaponEffectType.WEAPON_TYPE_ADD_BOX_COIN:t.addBoxCoin+=n;break;case e.MagicWeaponEffectType.WEAPON_TYPE_ADD_CLICK_DAMAGE:t.addClickDamage+=n;
break;case e.MagicWeaponEffectType.WEAPON_TYPE_ADD_CRIT_CHANCE:t.addCritChance+=n;break;case e.MagicWeaponEffectType.WEAPON_TYPE_CUT_ID2_SKILL_CD:t.cutID2SkillCD+=n;break;case e.MagicWeaponEffectType.WEAPON_TYPE_CUT_SKILL_USELESS_CHANCE:t.cutSkillUselessChance+=n;break;case e.MagicWeaponEffectType.WEAPON_TYPE_CUT_UPLEVEL_MONEY:t.cutUpLevelMoney+=n;break;case e.MagicWeaponEffectType.WEAPON_TYPE_ADD_CHEST_CHANCE:t.addChestChance+=n;break;case e.MagicWeaponEffectType.WEAPON_TYPE_CUT_ID5_SKILL_CD:t.cutID5SkillCD+=n;break;case e.MagicWeaponEffectType.WEAPON_TYPE_CUT_ID6_SKILL_CD:t.cutID6SkillCD+=n;break;case e.MagicWeaponEffectType.WEAPON_TYPE_ADD_ID4_SKILL_TIME:t.addID4SkillTime+=n;break;case e.MagicWeaponEffectType.WEAPON_TYPE_ADD_BOSS_TIME:t.addBossTime+=n;break;case e.MagicWeaponEffectType.WEAPON_TYPE_ADD_BOSS_COIN:t.addBossCoin+=n;break;case e.MagicWeaponEffectType.WEAPON_TYPE_ADD_MUCH_COIN_CHANCE:t.addMuchCoinChance+=n;break;case e.MagicWeaponEffectType.WEAPON_TYPE_ADD_CRIT_CHANCE:t.addCritChance+=n}},t.setMagicWeaponBuyCost=function(){var i=Enumerable.From(e.MagicWeaponService.MagicWeaponList),n=i.Where(function(e){return null!=e.dy}).ToArray(),o=n.length;return t.buyCost=Math.max(1,Math.pow(o,2)+2*(o-1)),t.buyCost},t.magicWeaponEffect=function(e,t){return e*t},t.magicWeaponCost=function(e,t){return e*t},t.isFull=function(){var e=Enumerable.From(t.MagicWeaponList).Where(function(e){return null==e.dy}).ToArray();return 0==e.length?!0:!1},t.buySuccessedCallBack=function(){var i=Enumerable.From(t.MagicWeaponList).Where(function(e){return null==e.dy}).ToArray();if(0!=i.length){var n=i[e.Mathf.random(0,i.length)];n.dy=new e.MagicWeaponDyModel(n.st.id,1),t.MagicWeaponList=Enumerable.From(t.MagicWeaponList).OrderBy(function(e){return null==e.dy}).ThenBy(function(e){return e.st.id}).ToArray(),e.PlayerLocalService.PlayerData.AddJewel=-t.BuyCost,e.PlayerLocalService.initAllData()}},t.upgradeSuccessedCallBack=function(t){t.dy.level+=1,e.PlayerLocalService.PlayerData.AddJewel=-t.upgradeCost,e.PlayerLocalService.initAllData()},t}();t.magicWeaponList=null,t.buyCost=0,t.addCommon=0,t.cutEnemyCount=0,t.addOffLineCoin=0,t.cutSkillSealTime=0,t.cutID1SkillCD=0,t.addCoin=0,t.cutBossHp=0,t.addID3SkillTime=0,t.addCritDamage=0,t.addID1SkillDamage=0,t.addID2SkillTime=0,t.cutID4SkillCD=0,t.cutID3SkillCD=0,t.addAllSkillDamage=0,t.addID5SkillTime=0,t.addBoxCoin=0,t.addClickDamage=0,t.addCritChance=0,t.cutID2SkillCD=0,t.cutSkillUselessChance=0,t.cutUpLevelMoney=0,t.addChestChance=0,t.cutID5SkillCD=0,t.cutID6SkillCD=0,t.addID4SkillTime=0,t.addBossTime=0,t.addBossCoin=0,t.addMuchCoinChance=0,e.MagicWeaponService=t,__reflect(t.prototype,"Model.MagicWeaponService")}(Model||(Model={}));var Model;!function(e){var t=function(){function t(){}return t.toUnitConversion=function(e){for(var i=1;e>=1e3;)e/=1e3,i+=1;var n=Number(e.toFixed(2))==parseInt(e.toFixed(2))?parseInt(e.toFixed(2)):e.toFixed(2),o=String(n+t.getMagnitudeListById(i));return o},t.toTenConversion=function(e,t){var i=e*Math.pow(1e3,t-1);return i},t.getMagnitudeListById=function(t){if(void 0==t)return void(e.WebServiceBase.isDebug&&console.log("zhujun: unit shopId is undefined ! "+t));var i=Enumerable.From(e.WebValue.dataStModel.magnitudeList),n=i.Where(function(e){return e.id==t}).First(),o=n.magnitude;return"0"==o&&(o=""),o},t.cheatingDetection=function(e){return e>=35?!0:!1},t}();t.mainInfoData=new e.MainInfoData,e.MainLocalService=t,__reflect(t.prototype,"Model.MainLocalService")}(Model||(Model={}));var Model;!function(e){var t=function(){function t(){}return Object.defineProperty(t,"MonsterList",{get:function(){return t.monsterList},enumerable:!0,configurable:!0}),t.setMonsterList=function(i){if(void 0===i&&(i=!1),t.monsterList){e.WebServiceBase.isDebug&&console.log("怪物列表已经有了,这里只管长度是否改变.");for(var n=t.monsterList.length-e.SceneLocalService.SceneData.monsterCount,o=0;n>o;o++)t.monsterList.shift()}else t.setMonsterData(i);return t.monsterList},t.setMonsterData=function(i){void 0===i&&(i=!1),t.monsterList=[];var n=null,o=null;n=Enumerable.From(e.WebValue.dataStModel.monsterList).Where(function(t){return t.monsterType==e.MonsterType[e.MonsterType.MONSTER_TYPE_BOSS]}).ToArray(),o=Enumerable.From(e.WebValue.dataStModel.monsterList).Where(function(t){return t.monsterType==e.MonsterType[e.MonsterType.MONSTER_TYPE_BOX]||t.monsterType==e.MonsterType[e.MonsterType.MONSTER_TYPE_PERSON]}).ToArray();for(var r=null,a=0;a<e.SceneLocalService.SceneData.monsterCount;a++){r=i||a!=e.SceneLocalService.SceneData.monsterCount-1?o[e.Mathf.random(0,o.length)]:n[e.Mathf.random(0,n.length)];var l=new e.MonsterData(r);t.setMonsterHp(l),t.setMonsterDropMoney(l),t.setBossLeftTime(l),t.monsterList.push(l)}},t.setFarmMonsterData=function(){t.monsterList=[];for(var i=Enumerable.From(e.WebValue.dataStModel.monsterList).Where(function(t){return t.monsterType!=e.MonsterType[e.MonsterType.MONSTER_TYPE_BOSS]}).ToArray(),n=null,o=0;o<e.SceneLocalService.SceneData.monsterCount;o++){n=i[e.Mathf.random(0,i.length)];var r=new e.MonsterData(n);t.setMonsterHp(r),t.setMonsterDropMoney(r),t.setBossLeftTime(r),t.monsterList.push(r)}},t.setMonsterHp=function(t){t.hp=Math.ceil(Math.pow(parseFloat(e.PlayerLocalService.PlayerData.st.monsterHpRatio),e.SceneLocalService.SceneData.sceneId)),t.MonsterType==e.MonsterType.MONSTER_TYPE_BOSS&&(t.hp=Math.ceil(5*t.hp*(1-e.MagicWeaponService.CutBossHp/100))),t.hpMax=t.hp},t.setMonsterDropMoney=function(t){t.MonsterType==e.MonsterType.MONSTER_TYPE_BOSS?t.dropMoney=Math.ceil(t.hp/4*(1+e.FriendLocalService.FriendSkillTypeCoin/100+e.MagicWeaponService.AddCoin/100+e.MagicWeaponService.AddBossCoin/100)):t.MonsterType==e.MonsterType.MONSTER_TYPE_BOX?t.dropMoney=Math.ceil(1.25*t.hp*(1+e.FriendLocalService.FriendSkillTypeBoxCoin/100+e.MagicWeaponService.AddBoxCoin/100)):t.dropMoney=Math.ceil(t.hp/4*(1+e.FriendLocalService.FriendSkillTypeCoin/100+e.MagicWeaponService.AddCoin/100))},t.setBossLeftTime=function(t){t.leftTime=parseFloat(e.PlayerLocalService.PlayerData.st.timeBOSS)*(1+e.MagicWeaponService.AddBossTime/100)},t}();t.monsterList=null,e.MonsterLocalService=t,__reflect(t.prototype,"Model.MonsterLocalService")}(Model||(Model={}));var Model;!function(e){var t=function(){function t(){}return Object.defineProperty(t,"PlayerData",{get:function(){return t.playerData},enumerable:!0,configurable:!0}),t.initAllData=function(){t.setPlayerData(function(){e.ClanLocalService.setClanList(),e.MagicWeaponService.setMagicWeaponList(),e.FriendLocalService.setFriendList(),e.PlayerSkillLocalService.setPlayerSkillList(),e.SceneLocalService.setSceneData(),e.MonsterLocalService.setMonsterList(),e.ShopLocalService.setShopList(),e.AchievementLocalService.setAchievementList()})},t.setPlayerData=function(i){return t.playerData?e.WebServiceBase.isDebug&&console.log("主角数据已经有了,不需要重新创建."):(t.playerData=new e.PlayerData(e.WebValue.dataDyModel.playerModel,e.WebValue.dataStModel.sysConfigModel),t.setOffLineMoney()),i(),t.setPlayerClickDamage(),t.setPlayerUpgradeCost(),t.setPlayerTenUpgradeCost(),t.setPlayerHundredUpgradeCost(),t.setPlayerInfo(),e.WebValue.dataDyModel.playerModel=t.playerData.dy,t.playerData},t.setPlayerUpgradeCost=function(){return t.playerData.upgradeCost=Math.ceil(Math.pow(parseFloat(e.WebValue.dataStModel.sysConfigModel.leadCostRatio),t.playerData.dy.level)),t.playerData.upgradeCost},t.setPlayerTenUpgradeCost=function(){for(var i=0,n=0;10>n;n++)i+=Math.ceil(Math.pow(parseFloat(e.WebValue.dataStModel.sysConfigModel.leadCostRatio),t.playerData.dy.level+n));return t.playerData.tenUpgradeCost=i,t.playerData.tenUpgradeCost},t.setPlayerHundredUpgradeCost=function(){for(var i=0,n=0;100>n;n++)i+=Math.ceil(Math.pow(parseFloat(e.WebValue.dataStModel.sysConfigModel.leadCostRatio),t.playerData.dy.level+n));return t.playerData.hundredUpgradeCost=i,t.playerData.hundredUpgradeCost},t.setClickDamageBase=function(){return t.playerData.clickDamageBase=Math.ceil(Math.pow(parseFloat(e.WebValue.dataStModel.sysConfigModel.clickHurtRatio),t.playerData.dy.level)),t.playerData.clickDamageBaseNext=Math.ceil(Math.pow(parseFloat(e.WebValue.dataStModel.sysConfigModel.clickHurtRatio),t.playerData.dy.level+1)),t.playerData.clickDamageBase},t.setPlayerClickDamage=function(){return t.setClickDamageBase(),t.playerData.dy.clickDamage=(t.playerData.clickDamageBase+t.playerData.dy.friendDamage/20)*(100+e.FriendLocalService.FriendSkillTypeAll+e.FriendLocalService.FriendSkillTypeClick+e.MagicWeaponService.AddClickDamage+e.ClanLocalService.AddTypeAll+e.ClanLocalService.AddTypeClick)/100,t.playerData.clickDamageNext=(t.playerData.clickDamageBaseNext+t.playerData.dy.friendDamage/20)*(100+e.FriendLocalService.FriendSkillTypeAll+e.FriendLocalService.FriendSkillTypeClick+e.MagicWeaponService.AddClickDamage+e.ClanLocalService.AddTypeAll+e.ClanLocalService.AddTypeClick)/100,t.playerData.clickDamageDelta=t.playerData.clickDamageNext-t.playerData.dy.clickDamage,t.playerData.dy.clickDamage},t.setPlayerInfo=function(){t.playerData.allDamageAdd=e.FriendLocalService.FriendSkillTypeAll+e.MagicWeaponService.AddCommon+e.MagicWeaponService.AddAllSkillDamage,t.playerData.allGoldAdd=e.FriendLocalService.FriendSkillTypeCoin+e.MagicWeaponService.AddCoin,e.WebServiceBase.isDebug&&console.log("zhujun: PlayerLocalService.playerData.BaseCritDmageMultiple * 100 "+100*t.playerData.BaseCritDmageMultiple+" FriendLocalService.FriendSkillTypeCrit "+e.FriendLocalService.FriendSkillTypeCrit+" MagicWeaponService.AddCritDamage "+e.MagicWeaponService.AddCritDamage+" ClanLocalService.AddTypeCrit "+e.ClanLocalService.AddTypeCrit),t.playerData.allCritdDamageAdd=100*t.playerData.BaseCritDmageMultiple+e.FriendLocalService.FriendSkillTypeCrit+e.MagicWeaponService.AddCritDamage+e.ClanLocalService.AddTypeCrit},t.setPerSecondTapDamage=function(i){e.WebServiceBase.isDebug&&console.log("zhujun: setPerSecondTapDamage "+i),t.PlayerData.PerSecondTapDamage=i},t.upgradeSuccessedCallBack=function(e,i){switch(void 0===i&&(i=1),i){case 1:t.playerData.AddGold=-e.upgradeCost,t.playerData.dy.level+=1;break;case 10:t.playerData.AddGold=-e.tenUpgradeCost,t.playerData.dy.level+=10;break;case 100:t.playerData.AddGold=-e.hundredUpgradeCost,t.playerData.dy.level+=100;break;default:alert("升级出现错误，请联系管理员!")}t.initAllData()},t.isEnoughGold=function(e,i){return void 0===i&&(i=null),t.PlayerData.dy.gold<e?!1:(i&&i(e),!0)},t.changeGold=function(e){return t.isEnoughGold(e,function(e){t.PlayerData.AddGold=e})},t.isEnoughSycee=function(e,i){return void 0===i&&(i=null),t.PlayerData.dy.treasure<e?!1:(i&&i(e),!0)},t.changeSycee=function(e){return t.isEnoughSycee(e,function(e){t.PlayerData.dy.treasure+=e})},t.setOffLineMoney=function(){var i=new Date,n=i.getTime()/1e3,o=0;0!=t.PlayerData.dy.offLineTime&&(o=n-t.PlayerData.dy.offLineTime>14400?14400:Math.round(n-t.PlayerData.dy.offLineTime),o=0>o?0:o),t.PlayerData.offLineMoney=Math.round(Math.pow(Number(e.WebValue.dataStModel.sysConfigModel.monsterHpRatio),Number(e.WebValue.dataDyModel.playerModel.sceneId))/4*(1+e.FriendLocalService.FriendSkillTypeCoin/100+e.MagicWeaponService.AddCoin/100)/100*o)},t}();t.playerData=null,e.PlayerLocalService=t,__reflect(t.prototype,"Model.PlayerLocalService")}(Model||(Model={}));var Model;!function(e){var t=function(){function t(){}return Object.defineProperty(t,"PlayerSkillList",{get:function(){return t.playerSkillList},enumerable:!0,configurable:!0}),t.setPlayerSkillList=function(){if(t.playerSkillList){e.WebValue.dataDyModel.skillModelList=[];for(var i=0;i<t.playerSkillList.length;i++)t.updataPlayerSkillData(t.playerSkillList[i]),e.WebValue.dataDyModel.skillModelList.push(t.playerSkillList[i].dy)}else{t.playerSkillList=[];for(var i=0;i<e.WebValue.dataStModel.skillList.length;i++){var n=Enumerable.From(e.WebValue.dataDyModel.skillModelList).Where(function(t){return t.skillId==e.WebValue.dataStModel.skillList[i].id}).FirstOrDefault(null),o=new e.PlayerSkillData(n,e.WebValue.dataStModel.skillList[i]);t.updataPlayerSkillData(o),t.playerSkillList.push(o)}}return t.playerSkillList},t.updataPlayerSkillData=function(e){t.setSkillEffect(e),t.setSkillCost(e),t.mWskillEffect(e)},t.setSkillEffect=function(e){return e.dy?(e.effect=e.st.skillEffectValue+e.st.skillEffectAdd*(e.dy.level-1),e.effectNext=e.st.skillEffectValue+e.st.skillEffectAdd*e.dy.level,e.effectDelta=e.effectNext-e.effect):(e.effect=e.st.skillEffectValue,e.effectNext=e.st.skillEffectValue+1*e.st.skillEffectAdd,e.effectDelta=e.effectNext-e.effect),e.effect},t.setSkillCost=function(e){return e.dy?e.cost=e.st.upgradeBaseCost*Math.pow(e.st.upgradeCostMultiple,e.dy.level-1)*Math.pow(10,3*e.dy.level):e.cost=e.st.upgradeBaseCost*Math.pow(e.st.upgradeCostMultiple,0)*Math.pow(10,3),e.cost},t.setSkillTenCost=function(t){if(t.dy){for(var i=0,n=0;10>n;n++)i+=t.st.upgradeBaseCost*Math.pow(t.st.upgradeCostMultiple,t.dy.level+n-1)*Math.pow(10,3*(t.dy.level+n));return t.tenUpgradeCost=i,e.WebServiceBase.isDebug&&console.log("cai_haotian setSkillTenCost"+i),t.tenUpgradeCost}},t.mWskillEffect=function(t){switch(t.st.id){case 1:t.cdTime=Math.floor(t.st.cdTime*(1-e.MagicWeaponService.CutID1SkillCD/100-e.ClanLocalService.CutSkillCd/100)),t.effect=Math.floor(t.effect*(1+e.MagicWeaponService.AddID1SkillDamage/100)),t.continueTime=Math.floor(t.st.continueTime);break;case 2:t.cdTime=Math.floor(t.st.cdTime*(1-e.MagicWeaponService.CutID2SkillCD/100-e.ClanLocalService.CutSkillCd/100)),t.continueTime=Math.floor(t.st.continueTime*(1+e.MagicWeaponService.AddID2SkillTime/100));break;case 3:t.cdTime=Math.floor(t.st.cdTime*(1-e.MagicWeaponService.CutID3SkillCD/100-e.ClanLocalService.CutSkillCd/100)),t.continueTime=Math.floor(t.st.continueTime*(1+e.MagicWeaponService.AddID3SkillTime/100));break;case 4:t.cdTime=Math.floor(t.st.cdTime*(1-e.MagicWeaponService.CutID4SkillCD/100-e.ClanLocalService.CutSkillCd/100)),t.continueTime=Math.floor(t.st.continueTime*(1+e.MagicWeaponService.AddID4SkillTime/100));break;case 5:t.cdTime=Math.floor(t.st.cdTime*(1-e.MagicWeaponService.CutID5SkillCD/100-e.ClanLocalService.CutSkillCd/100)),t.continueTime=Math.floor(t.st.continueTime*(1+e.MagicWeaponService.AddID5SkillTime/100));break;case 6:t.continueTime=t.st.continueTime,t.cdTime=Math.floor(t.st.cdTime*(1-e.MagicWeaponService.CutID6SkillCD/100));break;default:alert("主角技能神器加成初始化错误！！！")}t.cdTime<=0&&(t.cdTime=10)},t.unlockSuccessedCallBack=function(t){return t.dy=new e.SkillDyModel(t.st.id,0,0),e.PlayerLocalService.initAllData(),t},t.upgradeSuccessedCallBack=function(t,i){switch(i){case 1:e.PlayerLocalService.PlayerData.AddGold=-t.cost,t.dy.level+=1;break;case 10:e.PlayerLocalService.PlayerData.AddGold=-t.tenUpgradeCost,t.dy.level+=10;break;default:alert("技能升级出错，请联系管理员！")}return e.PlayerLocalService.initAllData(),e.WebService.commitData(e.WebValue.dataDyModel,function(){e.WebServiceBase.isDebug&&console.log("cai_haotian: commitAuto success ! "+JSON.stringify(e.WebValue.dataDyModel))},function(){e.WebValue.isTraditional?alert("數據提交失敗請聯繫管理員！！！！"):alert("数据提交失败请联系管理员！！！！")}),t},t.timeDes=function(e){var t=Math.floor(e/60)<10?"0"+Math.floor(e/60):Math.floor(e/60),i=10>e%60?"0"+e%60:e%60;return t+":"+i},t.PlayerSkillEffect=function(t,i,n){var o=this,r=15;switch(n&&(t.dy.cdTime=t.cdTime,r=t.continueTime),t.st.id){case 1:e.PlayerLocalService.PlayerData.dy.clickDamage*=t.effect,i(),e.PlayerLocalService.PlayerData.dy.clickDamage/=t.effect;break;case 2:var a=Math.ceil(1e3/t.effect),l=new egret.Timer(a,Math.floor(t.effect*r));l.addEventListener(egret.TimerEvent.TIMER,function(){i()},this),l.start();break;case 3:var s=e.PlayerLocalService.PlayerData.CritRate*(t.effect/100);e.PlayerLocalService.PlayerData.critRate=Number(e.PlayerLocalService.PlayerData.critRate)+Number(s),egret.setTimeout(function(){e.PlayerLocalService.PlayerData.critRate=Number(e.PlayerLocalService.PlayerData.critRate)-Number(s),i()},this,1e3*r);break;case 4:var s=10*t.effect/100;e.PlayerLocalService.PlayerData.friendFrameRate=s,egret.setTimeout(function(){e.PlayerLocalService.PlayerData.friendFrameRate=0,i()},this,1e3*r);break;case 5:var s=e.PlayerLocalService.PlayerData.dy.clickDamage*(t.effect/100);e.PlayerLocalService.PlayerData.dy.clickDamage+=s,i(),egret.setTimeout(function(){e.PlayerLocalService.PlayerData.dy.clickDamage-=s,i()},this,1e3*r);break;case 6:var c=function(){var n=Math.floor(e.MonsterLocalService.MonsterList[e.SceneLocalService.SceneData.currentMonster].dropMoney*t.effect/100),o=e.MainLocalService.toUnitConversion(n);i(n,o)};Main.singleton.mainGameVM.clickBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,c,this),egret.setTimeout(function(){Main.singleton.mainGameVM.clickBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,c,o)},this,1e3*r);break;default:alert("技能使用错误请联系管理员")}},t.reduceCD=function(t,i){e.WebService.CleanSkillCD(t.st.id,function(){return e.WebServiceBase.isDebug&&console.log("cai_haotian cleanSkillCD success!!!"),e.PlayerLocalService.PlayerData.dy.treasure-=t.st.removeCdCost,t.dy.cdTime=0,i(),t},function(){e.WebServiceBase.isDebug&&console.log("cai_haotian cleanSkillCD fail!!!!!!!!")})},t}();t.playerSkillList=null,e.PlayerSkillLocalService=t,__reflect(t.prototype,"Model.PlayerSkillLocalService")}(Model||(Model={}));var Model;!function(e){var t=function(){function t(){}return Object.defineProperty(t,"SceneData",{get:function(){return t.sceneData},enumerable:!0,configurable:!0}),t.setSceneData=function(i){if(void 0===i&&(i=0),t.sceneData)t.setSceneMonsterCount(t.sceneData),e.WebServiceBase.isDebug&&console.log("场景信息已经有了,这里只会更新当前场景总怪物数量!");else{var n=e.WebValue.dataDyModel.playerModel.sceneId%(Number(e.PlayerLocalService.PlayerData.st.startScene)-1);0==n&&(n=Number(e.PlayerLocalService.PlayerData.st.startScene)-1);var o=Enumerable.From(e.WebValue.dataStModel.sceneList).Where(function(e){return e.id==n}).FirstOrDefault(null);e.WebServiceBase.isDebug&&console.log("zhujun scene data st "+JSON.stringify(o)),t.sceneData=new e.SceneData(e.WebValue.dataDyModel.playerModel.sceneId,o),t.sceneData.currentMonster=i,t.setSceneMonsterCount(t.sceneData)}return e.WebValue.dataDyModel.playerModel.sceneId=t.SceneData.sceneId,t.sceneData},t.setNextSceneData=function(){e.WebValue.dataDyModel.playerModel.sceneId+=1;var i=e.WebValue.dataDyModel.playerModel.sceneId%(Number(e.PlayerLocalService.PlayerData.st.startScene)-1);0==i&&(i=Number(e.PlayerLocalService.PlayerData.st.startScene)-1);var n=Enumerable.From(e.WebValue.dataStModel.sceneList).Where(function(e){return e.id==i}).FirstOrDefault(null);t.sceneData=new e.SceneData(e.WebValue.dataDyModel.playerModel.sceneId,n),t.sceneData.currentMonster=0,t.setSceneMonsterCount(t.sceneData)},t.setSceneMonsterCount=function(t){t.monsterCount=Math.round(parseInt(e.PlayerLocalService.PlayerData.st.sceneMonsterNumber)*(1-e.MagicWeaponService.CutEnemyCount/100))},t}();t.sceneData=null,e.SceneLocalService=t,__reflect(t.prototype,"Model.SceneLocalService")}(Model||(Model={}));var Model;!function(e){var t=function(){function t(){}return Object.defineProperty(t,"ShopList",{get:function(){return t.setShopList()},enumerable:!0,configurable:!0}),t.setShopList=function(){if(t.shopList)for(var i=0;i<t.shopList.length;i++)t.shopList[i].gold=t.setShopGold(t.shopList[i].st);else{t.shopList=[];for(var i=0;i<e.WebValue.dataStModel.shopList.length;i++){var n=Enumerable.From(e.WebValue.dataDyModel.shopModelList).Where(function(t){return t.shopId==e.WebValue.dataStModel.shopList[i].id}).FirstOrDefault(null),o=new e.ShopData(n,e.WebValue.dataStModel.shopList[i]);o.gold=t.setShopGold(e.WebValue.dataStModel.shopList[i]),t.initProtectFriend(o),t.shopList.push(o)}}return t.shopList},t.setShopGold=function(t){var i=Math.pow(Number(e.WebValue.dataStModel.sysConfigModel.monsterHpRatio),Number(e.WebValue.dataDyModel.playerModel.sceneId))/4*(1+e.FriendLocalService.FriendSkillTypeCoin/100+e.MagicWeaponService.AddCoin/100)*100;switch(t.id){case 1:return i;case 2:return 30*i;case 3:return 1e6*i;default:return 0}},t.initProtectFriend=function(e){if(4==e.st.id&&e.dy){var i=new Date,n=i.getTime()/1e3;n-e.dy.lastShopTime<=86400&&t.protectFriend()}},t.commitShop=function(i,n,o){var r=new Date;i.dy=new e.ShopDyModel(i.st.id,Math.round(r.getTime()/1e3),i.gold),e.WebService.commitShop(i.dy,function(){e.WebServiceBase.isDebug&&console.log("cai_haotian commitShop success！"),t.upGradeShop(i,n,o)},function(){alert("购买道具失败！！"),e.WebServiceBase.isDebug&&console.log("cai_haotian commitShop failed！！！")})},t.upGradeShop=function(i,n,o){switch(n?(e.PlayerLocalService.changeSycee(0),e.PlayerLocalService.PlayerData.dy.freeSkillTime=0):e.PlayerLocalService.changeSycee(-i.st.cost),i.st.id){case 1:t.addMoney(i.gold,2);break;case 2:t.addMoney(i.gold,5);break;case 3:t.addMoney(i.gold,10);break;case 4:t.protectFriend();break;case 5:t.hugeDamage();break;default:alert("商城购买出错！请联系管理员！c")}o()},t.addMoney=function(t,i){e.AchievementLocalService.setCurrentGet(e.AchievementType.ACHIEVEMENT_TYPE_GET_COIN,t)},t.protectFriend=function(){e.PlayerLocalService.PlayerData.protectFriend=!0},t.hugeDamage=function(){var t=.9*e.MonsterLocalService.MonsterList[e.SceneLocalService.SceneData.currentMonster].hp;e.MonsterLocalService.MonsterList[e.SceneLocalService.SceneData.currentMonster].AddHp=-t},t}();t.shopList=null,e.ShopLocalService=t,__reflect(t.prototype,"Model.ShopLocalService")}(Model||(Model={}));var Model;!function(e){var t=function(){function t(){}return t.userLogin=function(t,n,o){if(void 0===n&&(n=function(e){}),void 0===o&&(o=function(e){}),e.WebValue.isWebService){var r=new i(t);r.successCallBack=n,r.failedCallBack=o,r.StartService()}else n(null)},t.updateDyData=function(t,i){if(void 0===t&&(t=function(e){}),void 0===i&&(i=function(e){}),e.WebValue.isWebService);else{var n=JSON.parse(egret.localStorage.getItem("dyDB_json"));(null==n||"undefined"==n)&&(egret.localStorage.setItem("dyDB_json",JSON.stringify(RES.getRes("dyDB_json"))),n=JSON.parse(egret.localStorage.getItem("dyDB_json"))),t(n)}},t.updateStData=function(t,i){if(void 0===t&&(t=function(e){}),void 0===i&&(i=function(e){}),e.WebValue.isWebService){var n=new o;n.successCallBack=t,n.failedCallBack=i,n.StartService()}else{var r=RES.getRes("stDB_json");t(r)}},t.commitData=function(e,t,i){void 0===t&&(t=function(e){}),void 0===i&&(i=function(e){});var n=new r(e);n.successCallBack=t,n.failedCallBack=i,n.StartService()},t.commitShop=function(e,t,i){void 0===t&&(t=function(e){}),void 0===i&&(i=function(e){});var n=new a(e);n.successCallBack=t,n.failedCallBack=i,n.StartService()},t.ReleaseSkillCD=function(e,t,i){void 0===t&&(t=function(e){}),void 0===i&&(i=function(e){});var n=new l(e);n.successCallBack=t,n.failedCallBack=i,n.StartService()},t.CleanSkillCD=function(e,t,i){void 0===t&&(t=function(e){}),void 0===i&&(i=function(e){});var n=new s(e);n.successCallBack=t,n.failedCallBack=i,n.StartService()},t.UpdateDailyRecharge=function(e,t){void 0===e&&(e=function(e){}),void 0===t&&(t=function(e){});var i=new c;i.successCallBack=e,i.failedCallBack=t,i.StartService()},t.GetDailyRecharge=function(e,t,i){void 0===t&&(t=function(e){}),void 0===i&&(i=function(e){});var n=new d(e);n.successCallBack=t,n.failedCallBack=i,n.StartService()},t.UpdateCumulativeRecharge=function(e,t){void 0===e&&(e=function(e){}),void 0===t&&(t=function(e){});var i=new u;i.successCallBack=e,i.failedCallBack=t,i.StartService()},t.GetCumulativeRecharge=function(e,t,i){void 0===t&&(t=function(e){}),void 0===i&&(i=function(e){});var n=new h(e);n.successCallBack=t,n.failedCallBack=i,n.StartService()},t.RankingData=function(e,t){void 0===e&&(e=function(e){}),void 0===t&&(t=function(e){});var i=new p;i.successCallBack=e,i.failedCallBack=t,i.StartService()},t.Recharge=function(e,t){void 0===e&&(e=function(e){}),void 0===t&&(t=function(e){});var i=new f;i.successCallBack=e,i.failedCallBack=t,i.StartService()},t.AchievementInfo=function(e,t,i){void 0===t&&(t=function(e){}),void 0===i&&(i=function(e){});var n=new y(e);n.successCallBack=t,n.failedCallBack=i,n.StartService()},t.PartInRward=function(e,t,i){void 0===t&&(t=function(e){}),void 0===i&&(i=function(e){});var n=new M(e);n.successCallBack=t,n.failedCallBack=i,n.StartService()},t}();e.WebService=t,__reflect(t.prototype,"Model.WebService",["Model.IWebService"]);var i=function(t){function i(i){return t.call(this,String(e.WebServiceBase.SelectedLoginAddress+"user/login/"),i)||this}return __extends(i,t),i}(e.WebServiceNonResponseBase);e.UserLogin=i,__reflect(i.prototype,"Model.UserLogin");var n=function(t){function i(){return t.call(this,String(e.WebServiceBase.SelectedServerAddress+"update/dynamicData/"),{})||this}return __extends(i,t),i}(e.WebServiceResponseBase);e.UpdateDyData=n,__reflect(n.prototype,"Model.UpdateDyData");var o=function(t){function i(){return t.call(this,String(e.WebServiceBase.SelectedServerAddress+"update/staticData/"),{})||this}return __extends(i,t),i}(e.WebServiceResponseBase);e.UpdateStData=o,__reflect(o.prototype,"Model.UpdateStData");var r=function(t){function i(i){return t.call(this,String(e.WebServiceBase.SelectedServerAddress+"commit/data/"),i)||this}return __extends(i,t),i}(e.WebServiceNonResponseBase);e.CommitData=r,__reflect(r.prototype,"Model.CommitData");var a=function(t){function i(i){return t.call(this,String(e.WebServiceBase.SelectedServerAddress+"shop/buy/"),i)||this}return __extends(i,t),i}(e.WebServiceNonResponseBase);e.CommitShop=a,__reflect(a.prototype,"Model.CommitShop");var l=function(t){function i(i){var n=this,o=new e.HashMap;return o.Set("skillId",i),n=t.call(this,String(e.WebServiceBase.SelectedServerAddress+"skill/releaseSkill/"),o,e.WebServiceType.Post,!0)||this}return __extends(i,t),i}(e.WebServiceNonResponseBase);e.ReleaseSkillCD=l,__reflect(l.prototype,"Model.ReleaseSkillCD");var s=function(t){function i(i){var n=this,o=new e.HashMap;return o.Set("skillId",i),n=t.call(this,String(e.WebServiceBase.SelectedServerAddress+"skill/cleanSkillCD/"),o)||this}return __extends(i,t),i}(e.WebServiceNonResponseBase);e.CleanSkillCD=s,__reflect(s.prototype,"Model.CleanSkillCD");var c=function(t){function i(){return t.call(this,String(e.WebServiceBase.SelectedServerAddress+"dailyRecharge/data/"),{})||this}return __extends(i,t),i}(e.WebServiceResponseBase);e.UpdateDailyRecharge=c,__reflect(c.prototype,"Model.UpdateDailyRecharge");var d=function(t){function i(i){var n=this,o=new e.HashMap;return o.Set("dailyRechargeId",i),n=t.call(this,String(e.WebServiceBase.SelectedServerAddress+"dailyRecharge/get/"),o)||this}return __extends(i,t),i}(e.WebServiceNonResponseBase);e.GetDailyRecharge=d,__reflect(d.prototype,"Model.GetDailyRecharge");var u=function(t){function i(){return t.call(this,String(e.WebServiceBase.SelectedServerAddress)+"cumulativeRecharge/data/",{})||this}return __extends(i,t),i}(e.WebServiceResponseBase);e.UpdateCumulativeRecharge=u,__reflect(u.prototype,"Model.UpdateCumulativeRecharge");var h=function(t){function i(i){var n=this,o=new e.HashMap;return o.Set("cumulativeId",i),n=t.call(this,String(e.WebServiceBase.SelectedServerAddress+"cumulativeRecharge/get/"),o)||this}return __extends(i,t),i}(e.WebServiceNonResponseBase);e.GetCumulativeRecharge=h,__reflect(h.prototype,"Model.GetCumulativeRecharge");var p=function(t){function i(){return t.call(this,String(e.WebServiceBase.SelectedServerAddress)+"ranking/Data/",{})||this}return __extends(i,t),i}(e.WebServiceResponseBase);e.RankingData=p,__reflect(p.prototype,"Model.RankingData");var f=function(t){function i(){return t.call(this,String(e.WebServiceBase.SelectedServerAddress+"recharge/recharge/"),{})||this}return __extends(i,t),i}(e.WebServiceResponseBase);e.Recharge=f,__reflect(f.prototype,"Model.Recharge");var y=function(t){function i(i){var n=this,o=new e.HashMap;return o.Set("achievementModel",i),n=t.call(this,String(e.WebServiceBase.SelectedServerAddress+"achievement/get/"),o)||this}return __extends(i,t),i}(e.WebServiceNonResponseBase);e.AchievementInfo=y,__reflect(y.prototype,"Model.AchievementInfo");var M=function(t){function i(i){var n=this,o=new e.HashMap;return o.Set("id",i),n=t.call(this,String(e.WebServiceBase.SelectedServerAddress+"Code/reward"),o)||this}return __extends(i,t),i}(e.WebServiceResponseBase);e.PartInRward=M,__reflect(M.prototype,"Model.PartInRward")}(Model||(Model={}));var Model;!function(e){var t=function(){function t(e){this.st=e}return Object.defineProperty(t.prototype,"AddHp",{set:function(t){this.hp+=t,e.WebServiceBase.isDebug&&console.log("cai_haotian: this.hp += _value  "+this.hp),this.hp<0&&(this.hp=0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"GetHpMax",{get:function(){return e.MainLocalService.toUnitConversion(this.hpMax)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Type",{get:function(){return e.DailyChallengeType[this.st.rewardType]},enumerable:!0,configurable:!0}),t}();e.ChallengeData=t,__reflect(t.prototype,"Model.ChallengeData")}(Model||(Model={}));var LoadingUI=function(e){function t(){var t=e.call(this)||this;return t.createView(),t}return __extends(t,e),t.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},t.prototype.setProgress=function(e,t){this.textField.text=""},t}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var Model;!function(e){var t=function(){function t(t,i,n,o){void 0===n&&(n=!0),void 0===o&&(o=e.WebServiceType.Post),this.type=e.WebServiceType.Post,e.WebServiceBase.isDebug&&console.log("zhujun: baseURL "+t),this.type=o,this.isJson=n,this.baseURL=t,this.paramList=i}return Object.defineProperty(t.prototype,"Type",{get:function(){return this.type==e.WebServiceType.Post?egret.HttpMethod.POST:egret.HttpMethod.GET},enumerable:!0,configurable:!0}),t}();e.WebServiceValue=t,__reflect(t.prototype,"Model.WebServiceValue",["Model.IWebServiceValue"])}(Model||(Model={}));var Model;!function(e){var t;!function(e){e[e.SKILL_EFFECT_CLICK_MULTIPLE=0]="SKILL_EFFECT_CLICK_MULTIPLE",e[e.SKILL_EFFECT_SHADOW_ATTACK=1]="SKILL_EFFECT_SHADOW_ATTACK",e[e.SKILL_EFFECT_CRIT_PROBABILITY=2]="SKILL_EFFECT_CRIT_PROBABILITY",e[e.SKILL_EFFECTL_FRIEND_ACCELERATE=3]="SKILL_EFFECTL_FRIEND_ACCELERATE",e[e.SKILL_EFFECT_CLICK_INCREASE=4]="SKILL_EFFECT_CLICK_INCREASE",e[e.SKILL_EFFECT_CLICK_COIN=5]="SKILL_EFFECT_CLICK_COIN"}(t=e.PlayerSkillType||(e.PlayerSkillType={}));var i;!function(e){e[e.FRIEND_TYPE_FRIEND=0]="FRIEND_TYPE_FRIEND",e[e.FRIEND_TYPE_SKILL=1]="FRIEND_TYPE_SKILL"}(i=e.FriendType||(e.FriendType={}));var n;!function(e){e[e.MONEY_TYPE_COIN=0]="MONEY_TYPE_COIN",e[e.MONEY_TYPE_YB=1]="MONEY_TYPE_YB",e[e.MONEY_TYPE_JEWEL=2]="MONEY_TYPE_JEWEL"}(n=e.MoneyType||(e.MoneyType={}));var o;!function(e){e[e.FRIEND_SKILL_TYPE_SLEF=0]="FRIEND_SKILL_TYPE_SLEF",e[e.FRIEND_SKILL_TYPE_ALL=1]="FRIEND_SKILL_TYPE_ALL",e[e.FRIEND_SKILL_TYPE_CRIT=2]="FRIEND_SKILL_TYPE_CRIT",e[e.FRIEND_SKILL_TYPE_CRIT_PROBABILITY=3]="FRIEND_SKILL_TYPE_CRIT_PROBABILITY",e[e.FRIEND_SKILL_TYPE_CLICK=4]="FRIEND_SKILL_TYPE_CLICK",e[e.FRIEND_SKILL_TYPE_COIN=5]="FRIEND_SKILL_TYPE_COIN",e[e.FRIEND_SKILL_TYPE_BOX_COIN=6]="FRIEND_SKILL_TYPE_BOX_COIN",e[e.FRIEND_SKILL_TYPE_BOSS=7]="FRIEND_SKILL_TYPE_BOSS"}(o=e.SkillFloorType||(e.SkillFloorType={}));var r;!function(e){e[e.WEAPON_TYPE_ADD_COMMON=0]="WEAPON_TYPE_ADD_COMMON",e[e.WEAPON_TYPE_CUT_ENEMY_COUNT=1]="WEAPON_TYPE_CUT_ENEMY_COUNT",e[e.WEAPON_TYPE_ADD_OFFLINE_COIN=2]="WEAPON_TYPE_ADD_OFFLINE_COIN",e[e.WEAPON_TYPE_CUT_SKILL_SEAL_TIME=3]="WEAPON_TYPE_CUT_SKILL_SEAL_TIME",e[e.WEAPON_TYPE_CUT_ID1_SKILL_CD=4]="WEAPON_TYPE_CUT_ID1_SKILL_CD",e[e.WEAPON_TYPE_ADD_COIN=5]="WEAPON_TYPE_ADD_COIN",e[e.WEAPON_TYPE_CUT_BOSS_HP=6]="WEAPON_TYPE_CUT_BOSS_HP",e[e.WEAPON_TYPE_ADD_ID3_SKILL_TIME=7]="WEAPON_TYPE_ADD_ID3_SKILL_TIME",e[e.WEAPON_TYPE_ADD_CRIT_DAMAGE=8]="WEAPON_TYPE_ADD_CRIT_DAMAGE",e[e.WEAPON_TYPE_ADD_ID1_SKILL_DAMAGE=9]="WEAPON_TYPE_ADD_ID1_SKILL_DAMAGE",e[e.WEAPON_TYPE_ADD_ID2_SKILL_TIME=10]="WEAPON_TYPE_ADD_ID2_SKILL_TIME",e[e.WEAPON_TYPE_CUT_ID4_SKILL_CD=11]="WEAPON_TYPE_CUT_ID4_SKILL_CD",e[e.WEAPON_TYPE_CUT_ID3_SKILL_CD=12]="WEAPON_TYPE_CUT_ID3_SKILL_CD",e[e.WEAPON_TYPE_ADD_ALL_SKILL_DAMAGE=13]="WEAPON_TYPE_ADD_ALL_SKILL_DAMAGE",e[e.WEAPON_TYPE_ADD_ID5_SKILL_TIME=14]="WEAPON_TYPE_ADD_ID5_SKILL_TIME",e[e.WEAPON_TYPE_ADD_BOX_COIN=15]="WEAPON_TYPE_ADD_BOX_COIN",e[e.WEAPON_TYPE_ADD_CLICK_DAMAGE=16]="WEAPON_TYPE_ADD_CLICK_DAMAGE",e[e.WEAPON_TYPE_ADD_CRIT_CHANCE=17]="WEAPON_TYPE_ADD_CRIT_CHANCE",e[e.WEAPON_TYPE_CUT_ID2_SKILL_CD=18]="WEAPON_TYPE_CUT_ID2_SKILL_CD",e[e.WEAPON_TYPE_CUT_SKILL_USELESS_CHANCE=19]="WEAPON_TYPE_CUT_SKILL_USELESS_CHANCE",e[e.WEAPON_TYPE_CUT_UPLEVEL_MONEY=20]="WEAPON_TYPE_CUT_UPLEVEL_MONEY",e[e.WEAPON_TYPE_ADD_CHEST_CHANCE=21]="WEAPON_TYPE_ADD_CHEST_CHANCE",e[e.WEAPON_TYPE_CUT_ID5_SKILL_CD=22]="WEAPON_TYPE_CUT_ID5_SKILL_CD",e[e.WEAPON_TYPE_CUT_ID6_SKILL_CD=23]="WEAPON_TYPE_CUT_ID6_SKILL_CD",e[e.WEAPON_TYPE_ADD_ID4_SKILL_TIME=24]="WEAPON_TYPE_ADD_ID4_SKILL_TIME",e[e.WEAPON_TYPE_ADD_BOSS_TIME=25]="WEAPON_TYPE_ADD_BOSS_TIME",e[e.WEAPON_TYPE_ADD_BOSS_COIN=26]="WEAPON_TYPE_ADD_BOSS_COIN",e[e.WEAPON_TYPE_ADD_MUCH_COIN_CHANCE=27]="WEAPON_TYPE_ADD_MUCH_COIN_CHANCE"
}(r=e.MagicWeaponEffectType||(e.MagicWeaponEffectType={}));var a;!function(e){e[e.CLAN_TYPE_ALL=0]="CLAN_TYPE_ALL",e[e.CLAN_TYPE_CLICK=1]="CLAN_TYPE_CLICK",e[e.CLAN_TYPE_CRIT=2]="CLAN_TYPE_CRIT",e[e.CLAN_TYPE_CUT_SKILL_CD=3]="CLAN_TYPE_CUT_SKILL_CD"}(a=e.FamliyType||(e.FamliyType={}));var l;!function(e){e[e.ACHIEVEMENT_TYPE_KILL_ENEMY=0]="ACHIEVEMENT_TYPE_KILL_ENEMY",e[e.ACHIEVEMENT_TYPE_GET_COIN=1]="ACHIEVEMENT_TYPE_GET_COIN",e[e.ACHIEVEMENT_TYPE_ARRIVE_SCENE=2]="ACHIEVEMENT_TYPE_ARRIVE_SCENE",e[e.ACHIEVEMENT_TYPE_GET_JEWEL=3]="ACHIEVEMENT_TYPE_GET_JEWEL",e[e.ACHIEVEMENT_TYPE_GET_MAGIC_WEAPON=4]="ACHIEVEMENT_TYPE_GET_MAGIC_WEAPON",e[e.ACHIEVEMENT_TYPE_FRIEND_DAMAGE=5]="ACHIEVEMENT_TYPE_FRIEND_DAMAGE",e[e.ACHIEVEMENT_TYPE_GET_FRIEND=6]="ACHIEVEMENT_TYPE_GET_FRIEND",e[e.ACHIEVEMENT_TYPE_GET_GIFT=7]="ACHIEVEMENT_TYPE_GET_GIFT",e[e.ACHIEVEMENT_TYPE_GET_BOX=8]="ACHIEVEMENT_TYPE_GET_BOX",e[e.ACHIEVEMENT_TYPE_KILL_BOSS=9]="ACHIEVEMENT_TYPE_KILL_BOSS",e[e.ACHIEVEMENT_TYPE_USE_SKILL1=10]="ACHIEVEMENT_TYPE_USE_SKILL1",e[e.ACHIEVEMENT_TYPE_USE_SKILL2=11]="ACHIEVEMENT_TYPE_USE_SKILL2",e[e.ACHIEVEMENT_TYPE_USE_SKILL3=12]="ACHIEVEMENT_TYPE_USE_SKILL3",e[e.ACHIEVEMENT_TYPE_USE_SKILL4=13]="ACHIEVEMENT_TYPE_USE_SKILL4",e[e.ACHIEVEMENT_TYPE_USE_SKILL5=14]="ACHIEVEMENT_TYPE_USE_SKILL5",e[e.ACHIEVEMENT_TYPE_USE_SKILL6=15]="ACHIEVEMENT_TYPE_USE_SKILL6"}(l=e.AchievementType||(e.AchievementType={}));var s;!function(e){e[e.MONSTER_TYPE_PERSON=0]="MONSTER_TYPE_PERSON",e[e.MONSTER_TYPE_BOX=1]="MONSTER_TYPE_BOX",e[e.MONSTER_TYPE_BOSS=2]="MONSTER_TYPE_BOSS"}(s=e.MonsterType||(e.MonsterType={}));var c;!function(e){e[e.SHOP_TYPE_COIN=0]="SHOP_TYPE_COIN",e[e.SHOP_TYPE_SKILL=1]="SHOP_TYPE_SKILL",e[e.SHOP_TYPE_YB=2]="SHOP_TYPE_YB"}(c=e.ShopType||(e.ShopType={}));var d;!function(e){e[e.MONEY_TYPE_YB=0]="MONEY_TYPE_YB",e[e.MONEY_TYPE_JEWEL=1]="MONEY_TYPE_JEWEL",e[e.REWARD_TYPE_USE_SKILL_DSTQ=2]="REWARD_TYPE_USE_SKILL_DSTQ",e[e.REWARD_TYPE_CUT_BAGDROP_TIME=3]="REWARD_TYPE_CUT_BAGDROP_TIME"}(d=e.RewardType||(e.RewardType={}));var u;!function(e){e[e.MONEY_TYPE_YB=0]="MONEY_TYPE_YB",e[e.MONEY_TYPE_JEWEL=1]="MONEY_TYPE_JEWEL",e[e.REWARD_TYPE_CUT_BAGDROP_TIME=2]="REWARD_TYPE_CUT_BAGDROP_TIME",e[e.REWARD_TYPE_USE_SKILL_DSTQ=3]="REWARD_TYPE_USE_SKILL_DSTQ"}(u=e.DailyChallengeType||(e.DailyChallengeType={}));var h=function(){function e(){}return e}();h.is9G=!1,h.isTraditional=!1,h.isWebService=!1,h.webServiceHeader="H008",h.appVer="v1.0.0",h.appName="云中歌点击版",h.accountM=new e.AccountModel,h.dataDyModel=new e.DataDyModel,h.dataStModel=new e.DataStModel,e.WebValue=h,__reflect(h.prototype,"Model.WebValue")}(Model||(Model={}));var Model;!function(e){var t=function(){function e(e,t,i,n,o,r,a,l){void 0===r&&(r=640),void 0===a&&(a=360),void 0===l&&(l=null),this.onCallBack=null,this.onCallBack=l,this.createArmature(t,i,n,o),this.armature.getDisplay().x=r,this.armature.getDisplay().y=a,dragonBones.WorldClock.clock.add(this.armature),e.addChild(this.armature.getDisplay())}return e.prototype.changeArmature=function(e,t,i,n,o,r,a){void 0===o&&(o=640),void 0===r&&(r=360),void 0===a&&(a=null),this.onCallBack=a,this.createArmature(e,t,i,n),this.armature.getDisplay().x=o,this.armature.getDisplay().y=r},e.prototype.createArmature=function(e,t,i,n){var o=new dragonBones.EgretFactory;o=new dragonBones.EgretFactory;var r=RES.getRes(e),a=RES.getRes(t),l=RES.getRes(i);o.addDragonBonesData(dragonBones.DataParser.parseDragonBonesData(r)),o.addTextureAtlas(new dragonBones.EgretTextureAtlas(l,a)),this.armature=o.buildArmature(n),this.armature.addEventListener(dragonBones.FrameEvent.ANIMATION_FRAME_EVENT,this.onAnimationEvent,this),this.armature.addEventListener(dragonBones.AnimationEvent.COMPLETE,this.onAnimationEvent,this),this.armature.addEventListener(dragonBones.AnimationEvent.LOOP_COMPLETE,this.onAnimationEvent,this)},e.prototype.onAnimationEvent=function(e){switch(e.type){case dragonBones.AnimationEvent.START:break;case dragonBones.AnimationEvent.LOOP_COMPLETE:break;case dragonBones.AnimationEvent.COMPLETE:this.onCallBack&&this.onCallBack();break;case dragonBones.FrameEvent.ANIMATION_FRAME_EVENT:}},e.prototype.play=function(e,t,i){void 0===t&&(t=0),void 0===i&&(i=null),this.onCallBack=i,this.armature.animation.gotoAndPlay(e,-1,-1,t)},e}();e.DragonBones=t,__reflect(t.prototype,"Model.DragonBones")}(Model||(Model={}));var Model;!function(e){var t=function(){function e(){}return e.prototype.Set=function(e,t){this[e]=t},e.prototype.Get=function(e){return this[e]},e.prototype.Contains=function(e){return null==this.Get(e)?!1:!0},e.prototype.Remove=function(e){delete this[e]},e.prototype.Clear=function(){},e}();e.HashMap=t,__reflect(t.prototype,"Model.HashMap")}(Model||(Model={}));var Model;!function(e){var t=function(){function e(){}return e.lerp=function(e,t,i){return i=0>i?0:i,i=i>1?1:i,e+(t-e)*i},e.clamp=function(e,t,i){return t>e?t:e>i?i:e},e.random=function(e,t,i){void 0===i&&(i=!0);var n=Math.random()*(t-e)+e;return i?Math.floor(n):n},e}();e.Mathf=t,__reflect(t.prototype,"Model.Mathf")}(Model||(Model={}));var Model;!function(e){var t=function(){function e(){this.hexcase=0,this.b64pad=""}return e.prototype.hex_md5=function(e){return this.rstr2hex(this.rstr_md5(this.str2rstr_utf8(e)))},e.prototype.b64_md5=function(e){return this.rstr2b64(this.rstr_md5(this.str2rstr_utf8(e)))},e.prototype.any_md5=function(e,t){return this.rstr2any(this.rstr_md5(this.str2rstr_utf8(e)),t)},e.prototype.hex_hmac_md5=function(e,t){return this.rstr2hex(this.rstr_hmac_md5(this.str2rstr_utf8(e),this.str2rstr_utf8(t)))},e.prototype.b64_hmac_md5=function(e,t){return this.rstr2b64(this.rstr_hmac_md5(this.str2rstr_utf8(e),this.str2rstr_utf8(t)))},e.prototype.any_hmac_md5=function(e,t,i){return this.rstr2any(this.rstr_hmac_md5(this.str2rstr_utf8(e),this.str2rstr_utf8(t)),i)},e.prototype.md5_vm_test=function(){return"900150983cd24fb0d6963f7d28e17f72"==this.hex_md5("abc").toLowerCase()},e.prototype.rstr_md5=function(e){return this.binl2rstr(this.binl_md5(this.rstr2binl(e),8*e.length))},e.prototype.rstr_hmac_md5=function(e,t){var i=this.rstr2binl(e);i.length>16&&(i=this.binl_md5(i,8*e.length));for(var n=Array(16),o=Array(16),r=0;16>r;r++)n[r]=909522486^i[r],o[r]=1549556828^i[r];var a=this.binl_md5(n.concat(this.rstr2binl(t)),512+8*t.length);return this.binl2rstr(this.binl_md5(o.concat(a),640))},e.prototype.rstr2hex=function(e){try{this.hexcase}catch(t){this.hexcase=0}for(var i,n=this.hexcase?"0123456789ABCDEF":"0123456789abcdef",o="",r=0;r<e.length;r++)i=e.charCodeAt(r),o+=n.charAt(i>>>4&15)+n.charAt(15&i);return o},e.prototype.rstr2b64=function(e){try{this.b64pad}catch(t){this.b64pad=""}for(var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n="",o=e.length,r=0;o>r;r+=3)for(var a=e.charCodeAt(r)<<16|(o>r+1?e.charCodeAt(r+1)<<8:0)|(o>r+2?e.charCodeAt(r+2):0),l=0;4>l;l++)n+=8*r+6*l>8*e.length?this.b64pad:i.charAt(a>>>6*(3-l)&63);return n},e.prototype.rstr2any=function(e,t){var i,n,o,r,a,l=t.length,s=Array(Math.ceil(e.length/2));for(i=0;i<s.length;i++)s[i]=e.charCodeAt(2*i)<<8|e.charCodeAt(2*i+1);var c=Math.ceil(8*e.length/(Math.log(t.length)/Math.log(2))),d=Array(c);for(n=0;c>n;n++){for(a=Array(),r=0,i=0;i<s.length;i++)r=(r<<16)+s[i],o=Math.floor(r/l),r-=o*l,(a.length>0||o>0)&&(a[a.length]=o);d[n]=r,s=a}var u="";for(i=d.length-1;i>=0;i--)u+=t.charAt(d[i]);return u},e.prototype.str2rstr_utf8=function(e){for(var t,i,n="",o=-1;++o<e.length;)t=e.charCodeAt(o),i=o+1<e.length?e.charCodeAt(o+1):0,t>=55296&&56319>=t&&i>=56320&&57343>=i&&(t=65536+((1023&t)<<10)+(1023&i),o++),127>=t?n+=String.fromCharCode(t):2047>=t?n+=String.fromCharCode(192|t>>>6&31,128|63&t):65535>=t?n+=String.fromCharCode(224|t>>>12&15,128|t>>>6&63,128|63&t):2097151>=t&&(n+=String.fromCharCode(240|t>>>18&7,128|t>>>12&63,128|t>>>6&63,128|63&t));return n},e.prototype.str2rstr_utf16le=function(e){for(var t="",i=0;i<e.length;i++)t+=String.fromCharCode(255&e.charCodeAt(i),e.charCodeAt(i)>>>8&255);return t},e.prototype.str2rstr_utf16be=function(e){for(var t="",i=0;i<e.length;i++)t+=String.fromCharCode(e.charCodeAt(i)>>>8&255,255&e.charCodeAt(i));return t},e.prototype.rstr2binl=function(e){for(var t=Array(e.length>>2),i=0;i<t.length;i++)t[i]=0;for(var i=0;i<8*e.length;i+=8)t[i>>5]|=(255&e.charCodeAt(i/8))<<i%32;return t},e.prototype.binl2rstr=function(e){for(var t="",i=0;i<32*e.length;i+=8)t+=String.fromCharCode(e[i>>5]>>>i%32&255);return t},e.prototype.binl_md5=function(e,t){e[t>>5]|=128<<t%32,e[(t+64>>>9<<4)+14]=t;for(var i=1732584193,n=-271733879,o=-1732584194,r=271733878,a=0;a<e.length;a+=16){var l=i,s=n,c=o,d=r;i=this.md5_ff(i,n,o,r,e[a+0],7,-680876936),r=this.md5_ff(r,i,n,o,e[a+1],12,-389564586),o=this.md5_ff(o,r,i,n,e[a+2],17,606105819),n=this.md5_ff(n,o,r,i,e[a+3],22,-1044525330),i=this.md5_ff(i,n,o,r,e[a+4],7,-176418897),r=this.md5_ff(r,i,n,o,e[a+5],12,1200080426),o=this.md5_ff(o,r,i,n,e[a+6],17,-1473231341),n=this.md5_ff(n,o,r,i,e[a+7],22,-45705983),i=this.md5_ff(i,n,o,r,e[a+8],7,1770035416),r=this.md5_ff(r,i,n,o,e[a+9],12,-1958414417),o=this.md5_ff(o,r,i,n,e[a+10],17,-42063),n=this.md5_ff(n,o,r,i,e[a+11],22,-1990404162),i=this.md5_ff(i,n,o,r,e[a+12],7,1804603682),r=this.md5_ff(r,i,n,o,e[a+13],12,-40341101),o=this.md5_ff(o,r,i,n,e[a+14],17,-1502002290),n=this.md5_ff(n,o,r,i,e[a+15],22,1236535329),i=this.md5_gg(i,n,o,r,e[a+1],5,-165796510),r=this.md5_gg(r,i,n,o,e[a+6],9,-1069501632),o=this.md5_gg(o,r,i,n,e[a+11],14,643717713),n=this.md5_gg(n,o,r,i,e[a+0],20,-373897302),i=this.md5_gg(i,n,o,r,e[a+5],5,-701558691),r=this.md5_gg(r,i,n,o,e[a+10],9,38016083),o=this.md5_gg(o,r,i,n,e[a+15],14,-660478335),n=this.md5_gg(n,o,r,i,e[a+4],20,-405537848),i=this.md5_gg(i,n,o,r,e[a+9],5,568446438),r=this.md5_gg(r,i,n,o,e[a+14],9,-1019803690),o=this.md5_gg(o,r,i,n,e[a+3],14,-187363961),n=this.md5_gg(n,o,r,i,e[a+8],20,1163531501),i=this.md5_gg(i,n,o,r,e[a+13],5,-1444681467),r=this.md5_gg(r,i,n,o,e[a+2],9,-51403784),o=this.md5_gg(o,r,i,n,e[a+7],14,1735328473),n=this.md5_gg(n,o,r,i,e[a+12],20,-1926607734),i=this.md5_hh(i,n,o,r,e[a+5],4,-378558),r=this.md5_hh(r,i,n,o,e[a+8],11,-2022574463),o=this.md5_hh(o,r,i,n,e[a+11],16,1839030562),n=this.md5_hh(n,o,r,i,e[a+14],23,-35309556),i=this.md5_hh(i,n,o,r,e[a+1],4,-1530992060),r=this.md5_hh(r,i,n,o,e[a+4],11,1272893353),o=this.md5_hh(o,r,i,n,e[a+7],16,-155497632),n=this.md5_hh(n,o,r,i,e[a+10],23,-1094730640),i=this.md5_hh(i,n,o,r,e[a+13],4,681279174),r=this.md5_hh(r,i,n,o,e[a+0],11,-358537222),o=this.md5_hh(o,r,i,n,e[a+3],16,-722521979),n=this.md5_hh(n,o,r,i,e[a+6],23,76029189),i=this.md5_hh(i,n,o,r,e[a+9],4,-640364487),r=this.md5_hh(r,i,n,o,e[a+12],11,-421815835),o=this.md5_hh(o,r,i,n,e[a+15],16,530742520),n=this.md5_hh(n,o,r,i,e[a+2],23,-995338651),i=this.md5_ii(i,n,o,r,e[a+0],6,-198630844),r=this.md5_ii(r,i,n,o,e[a+7],10,1126891415),o=this.md5_ii(o,r,i,n,e[a+14],15,-1416354905),n=this.md5_ii(n,o,r,i,e[a+5],21,-57434055),i=this.md5_ii(i,n,o,r,e[a+12],6,1700485571),r=this.md5_ii(r,i,n,o,e[a+3],10,-1894986606),o=this.md5_ii(o,r,i,n,e[a+10],15,-1051523),n=this.md5_ii(n,o,r,i,e[a+1],21,-2054922799),i=this.md5_ii(i,n,o,r,e[a+8],6,1873313359),r=this.md5_ii(r,i,n,o,e[a+15],10,-30611744),o=this.md5_ii(o,r,i,n,e[a+6],15,-1560198380),n=this.md5_ii(n,o,r,i,e[a+13],21,1309151649),i=this.md5_ii(i,n,o,r,e[a+4],6,-145523070),r=this.md5_ii(r,i,n,o,e[a+11],10,-1120210379),o=this.md5_ii(o,r,i,n,e[a+2],15,718787259),n=this.md5_ii(n,o,r,i,e[a+9],21,-343485551),i=this.safe_add(i,l),n=this.safe_add(n,s),o=this.safe_add(o,c),r=this.safe_add(r,d)}return[i,n,o,r]},e.prototype.md5_cmn=function(e,t,i,n,o,r){return this.safe_add(this.bit_rol(this.safe_add(this.safe_add(t,e),this.safe_add(n,r)),o),i)},e.prototype.md5_ff=function(e,t,i,n,o,r,a){return this.md5_cmn(t&i|~t&n,e,t,o,r,a)},e.prototype.md5_gg=function(e,t,i,n,o,r,a){return this.md5_cmn(t&n|i&~n,e,t,o,r,a)},e.prototype.md5_hh=function(e,t,i,n,o,r,a){return this.md5_cmn(t^i^n,e,t,o,r,a)},e.prototype.md5_ii=function(e,t,i,n,o,r,a){return this.md5_cmn(i^(t|~n),e,t,o,r,a)},e.prototype.safe_add=function(e,t){var i=(65535&e)+(65535&t),n=(e>>16)+(t>>16)+(i>>16);return n<<16|65535&i},e.prototype.bit_rol=function(e,t){return e<<t|e>>>32-t},e}();e.MD5=t,__reflect(t.prototype,"Model.MD5")}(Model||(Model={}));var Model;!function(e){var t=function(){function e(e,t,i){this.i=0,this.image=e,this.rate=i,this.list=t}return e.prototype.play=function(e){var t=this;egret.setTimeout(function(){t.image.source=t.list[t.i],t.i++,t.i<t.list.length?t.play(e):(t.image.source=null,null!=e&&e())},this,1e3/this.rate)},e}();e.MovieClip=t,__reflect(t.prototype,"Model.MovieClip")}(Model||(Model={}));var Model;!function(e){var t=function(){function e(e,t,i,n){this.uiGroup=e,this.texture=t,this.config=i,this.onCallBack=n}return e.prototype.setParticlesPos=function(e,t){var i=RES.getRes(this.texture),n=RES.getRes(this.config);return this.system=new particle.GravityParticleSystem(i,n),this.uiGroup.addChild(this.system),this.system.x=e,this.system.y=t,this.system.start(),this.system},e}();e.Particles=t,__reflect(t.prototype,"Model.Particles")}(Model||(Model={}));var Model;!function(e){var t=function(){function e(){this.mapPoss=[new egret.Point(0,3),new egret.Point(3,2),new egret.Point(-3,-2)],this.spritePoss=[new egret.Point(5,0),new egret.Point(-5,0),new egret.Point(5,0)],this.shockLength=0,this.shockCount=0,this.rx=0,this.ry=0,this.type=0,this.repeatCount=0,this.isRunning=!1}return e.prototype.destroy=function(){this.stop(),this.target=null},e.prototype.shock=function(e,t,i){this.setTarget(e),this.setType(i),this.start(t)},e.prototype.start=function(e){void 0===e&&(e=5),this.isRunning&&this.stop(),this.repeatCount=e,this.shockCount=0,this.target&&(this.isRunning=!0,this.rx=this.target.x,this.ry=this.target.y,egret.Ticker.getInstance().register(this.onShockEnter,this))},e.prototype.stop=function(){this.isRunning=!1,this.target&&(this.target.x=this.rx,this.target.y=this.ry,egret.Ticker.getInstance().unregister(this.onShockEnter,this))},e.prototype.setTarget=function(e){this.target=e},e.prototype.setType=function(t){void 0===t&&(t=0),this.type=t,this.type==e.MAP?(this.shockPoss=this.mapPoss.concat(),this.shockLength=this.shockPoss.length):this.type==e.SPRITE&&(this.shockPoss=this.spritePoss.concat(),this.shockLength=this.shockPoss.length)},e.prototype.onShockEnter=function(e){var t=this.shockLength*this.repeatCount;if(this.shockCount>=t)return void this.stop();var i=this.shockCount%this.shockLength,n=this.shockPoss[i];this.target&&(this.target.x=this.rx+n.x,this.target.y=this.ry+n.y),this.shockCount++},e}();t.MAP=0,t.SPRITE=1,e.ShockTools=t,__reflect(t.prototype,"Model.ShockTools")}(Model||(Model={}));var Model;!function(e){var t=function(){function e(e,t,i,n,o){this.version="1.2",this.msecPerSecond=1e3,this.msecPerMinute=6e4,this.msecPerHour=36e5,this.msecPerDay=864e5,this.msecs=0,this.isTimeSpan=!0,this.isNumeric(o)&&(this.msecs+=o*this.msecPerDay),this.isNumeric(n)&&(this.msecs+=n*this.msecPerHour),this.isNumeric(i)&&(this.msecs+=i*this.msecPerMinute),this.isNumeric(t)&&(this.msecs+=t*this.msecPerSecond),this.isNumeric(e)&&(this.msecs+=e)}return e.prototype.isNumeric=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},e.prototype.addMilliseconds=function(e){this.isNumeric(e)&&(this.msecs+=e)},e.prototype.addSeconds=function(e){this.isNumeric(e)&&(this.msecs+=e*this.msecPerSecond)},e.prototype.addMinutes=function(e){this.isNumeric(e)&&(this.msecs+=e*this.msecPerMinute)},e.prototype.addHours=function(e){this.isNumeric(e)&&(this.msecs+=e*this.msecPerHour)},e.prototype.addDays=function(e){this.isNumeric(e)&&(this.msecs+=e*this.msecPerDay)},e.prototype.subtractMilliseconds=function(e){this.isNumeric(e)&&(this.msecs-=e)},e.prototype.subtractSeconds=function(e){this.isNumeric(e)&&(this.msecs-=e*this.msecPerSecond)},e.prototype.subtractMinutes=function(e){this.isNumeric(e)&&(this.msecs-=e*this.msecPerMinute)},e.prototype.subtractHours=function(e){this.isNumeric(e)&&(this.msecs-=e*this.msecPerDay)},e.prototype.subtractDays=function(e){this.isNumeric(e)&&(this.msecs-=e*this.msecPerDay)},e.prototype.add=function(e){e.isTimeSpan&&(this.msecs+=e.totalMilliseconds())},e.prototype.subtract=function(e){e.isTimeSpan&&(this.msecs+=e.totalMilliseconds())},e.prototype.equals=function(e){e.isTimeSpan&&this.msecs===e.totalMilliseconds()},e.prototype.totalMilliseconds=function(e){var t=this.msecs;return e===!0&&(t=Math.floor(t)),t},e.prototype.totalSeconds=function(e){var t=this.msecs/this.msecPerSecond;return e===!0&&(t=Math.floor(t)),t},e.prototype.totalMinutes=function(e){var t=this.msecs/this.msecPerMinute;return e===!0&&(t=Math.floor(t)),t},e.prototype.totalHours=function(e){var t=this.msecs/this.msecPerHour;return e===!0&&(t=Math.floor(t)),t},e.prototype.totalDays=function(e){var t=this.msecs/this.msecPerDay;return e===!0&&(t=Math.floor(t)),t},e.prototype.milliseconds=function(){return this.msecs%1e3},e.prototype.seconds=function(){return Math.floor(this.msecs/this.msecPerSecond)%60},e.prototype.minutes=function(){return Math.floor(this.msecs/this.msecPerMinute)%60},e.prototype.hours=function(){return Math.floor(this.msecs/this.msecPerHour)%24},e.prototype.days=function(){return Math.floor(this.msecs/this.msecPerDay)},e.prototype.toString=function(){var e=String("0"+this.hours()).slice(-2),t=String("0"+this.minutes()).slice(-2),i=String("0"+this.seconds()).slice(-2);return String(e+":"+t+":"+i)},e.prototype.getVersion=function(){return this.version},e.FromSeconds=function(t){return new e(0,t,0,0,0)},e.FromMinutes=function(t){return new e(0,0,t,0,0)},e.FromHours=function(t){return new e(0,0,0,t,0)},e.FromDays=function(t){return new e(0,0,0,0,t)},e.FromDates=function(t,i,n){var o=i.valueOf()-t.valueOf();return n===!0&&(o=Math.abs(o)),new e(o,0,0,0,0)},e}();e.TimeSpan=t,__reflect(t.prototype,"Model.TimeSpan")}(Model||(Model={}));var Model;!function(e){var t=function(){function t(){}return t.guid=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},t.padLeft=function(e,t,i){for(;e.length<i;)e=t+e;return e},t.GetQueryString=function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),i=window.location.search.substr(1).match(t);return null!=i?decodeURI(i[2]):null},t.getURLParam=function(e){var t="",i=!1,n=(document.location.href,document.location.search),o=new RegExp("\\?","g");if(n=String("?"+n.substring(1,n.length).replace(o,"&")),0==n.indexOf("?")&&n.indexOf("=")>1)for(var r=n.substring(1,n.length).split("&"),a=0;a<r.length&&!i;)r[a].indexOf("=")>0&&r[a].split("=")[0].toLowerCase()==e.toLowerCase()&&(t=r[a].split("=")[1],i=!0),a++;return t},t.createHash=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];for(var n=new e.HashMap,o=0;o<t.length;o+=2)n.Set(t[o],t[o+1]);return n},t.repeatedExecute=function(e,t){for(var i=0;t>i;i++)e()},t}();e.Tools=t,__reflect(t.prototype,"Model.Tools")}(Model||(Model={}));var Model;!function(e){var t=function(){function t(e,t,i,n,o){this.sAnimTime=800,this.mPointTime=200,this.goldWaitTime=1500,this.bezierP1Y=300,this.obj=e,this.uiGroup=t,this.sPos=i,this.ePos=n,this.finalPos=o,this.uiGroup.addChild(this.obj)}return t.prototype.GoldProductionAnim=function(t){var i=this,n=new e.Vector2;n.y=e.Mathf.random(this.sPos.y-300,this.sPos.y);var o=egret.Tween.get(this.obj);o.to({x:this.ePos.x},this.sAnimTime,egret.Ease.circOut).call(function(){t(i)});var r=egret.Tween.get(this.obj);r.to({y:n.y},this.mPointTime).to({y:this.ePos.y},this.sAnimTime-this.mPointTime,egret.Ease.bounceOut)},t.prototype.GoldRecycleAnim=function(e){var t=this;this.onCallBack=e,egret.Tween.get(this).to({factor:1},this.sAnimTime,egret.Ease.sineIn).call(function(){e(t),t.uiGroup.removeChild(t.obj)})},Object.defineProperty(t.prototype,"factor",{get:function(){return 0},set:function(e){this.obj.x=(1-e)*(1-e)*this.ePos.x+2*e*(1-e)*this.bezierP1X+e*e*this.finalPos.x,this.obj.y=(1-e)*(1-e)*this.ePos.y+2*e*(1-e)*this.bezierP1Y+e*e*this.finalPos.y},enumerable:!0,configurable:!0}),t}();e.TweenCustom=t,__reflect(t.prototype,"Model.TweenCustom")}(Model||(Model={}));var Model;!function(e){var t=function(){function e(e,t){this.x=e,this.y=t}return e}();e.Vector2=t,__reflect(t.prototype,"Model.Vector2")}(Model||(Model={}));var Model;!function(e){var t=function(){function t(e,t){this.st=e,this.dy=t}return Object.defineProperty(t.prototype,"Type",{get:function(){return e.FamliyType[this.st.clanType]},enumerable:!0,configurable:!0}),t}();e.ClanData=t,__reflect(t.prototype,"Model.ClanData")}(Model||(Model={}));var Model;!function(e){var t=function(){function t(){}return t.assignmentPlay68Model=function(){var i=["openid","pf","ts"];i.sort();var n=new e.HashMap;n.Set(i[0],e.Tools.getURLParam(i[0])),n.Set(i[1],e.Tools.getURLParam(i[1])),n.Set(i[2],e.Tools.getURLParam(i[2])),n.Set("sign",e.Tools.getURLParam("sign")),e.Play68Value.p68Model=n;var o=new e.MD5,r=o.hex_md5(String(n.Get(i[0])+n.Get(i[1])+n.Get(i[2])+t.play68key));return e.WebValue.accountM.id=e.Play68Value.p68Model.openid,e.WebValue.accountM.thirdAccountId=e.Play68Value.p68Model.openid,e.WebValue.accountM.platform=e.Play68Value.p68Model.pf,e.WebValue.accountM.time=e.Play68Value.p68Model.ts,e.WebValue.accountM.sign=e.Play68Value.p68Model.sign,e.Play68Value.p68Model.sign!=r?void alert("当前平台不合法，请勿充值!"):void 0},t}();t.play68Url="http://www.play68.com/",t.play68key="b92ababa363be1e416db0ace8f16fe33",e.Play68Service=t,__reflect(t.prototype,"Model.Play68Service")}(Model||(Model={}));var Model;!function(e){var t=function(){function e(){}return e}();t.p68Model=new e.Play68Model,t.p68UserInfo=new e.P68UserInfo,e.Play68Value=t,__reflect(t.prototype,"Model.Play68Value")}(Model||(Model={}));var Model;!function(e){var t=function(){function t(){}return t.initSDK=function(t){"3"==e.Tools.getURLParam("channel")?(e.Play68Service.assignmentPlay68Model(),t()):alert("当前平台非法,请勿充值!")},t.initPay=function(t,i,n,o){"3"==e.Tools.getURLParam("channel")?payItem(t,i,n,1):alert("当前平台非法,请勿充值!")},t}();e.SDKService=t,__reflect(t.prototype,"Model.SDKService")}(Model||(Model={}));var ThemeAdapter=function(){function e(){}return e.prototype.getTheme=function(e,t,i,n){function o(e){t.call(n,e)}function r(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),i.call(n))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),RES.getResByUrl(e,o,this,RES.ResourceItem.TYPE_TEXT)},e}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var ViewModel;!function(e){var t=function(e){function t(t,i){var n=e.call(this)||this;return n.skinName=View.AchievementItem,n.onCallBack=i,n.uiLayer=t,n.uiLayer.addChild(n),n}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this)},t.prototype.setItemInfo=function(e){switch(this.aData=e,this.icon.source=e.st.pic,this.itemName.text=e.st.name,e.dy.stage){case 6:case 5:this.fifthStar.source="icon_star";case 4:this.fourthStar.source="icon_star";case 3:this.thirdStar.source="icon_star";case 2:this.secondStar.source="icon_star";case 1:this.firstStar.source="icon_star";case 0:break;default:alert("成就状态出错！！！c1")}switch(e.matchStage){case 0:case 1:this.description.text=e.st.description.replace("{}",Model.MainLocalService.toUnitConversion(e.firstValue)+""),this.completionState.text=Model.MainLocalService.toUnitConversion(Math.round(e.dy.count))+"/"+Model.MainLocalService.toUnitConversion(e.firstValue),this.setBtnState(e,e.getState);break;case 2:this.description.text=e.st.description.replace("{}",Model.MainLocalService.toUnitConversion(e.secondValue)+""),this.completionState.text=Model.MainLocalService.toUnitConversion(Math.round(e.dy.count))+"/"+Model.MainLocalService.toUnitConversion(e.secondValue),this.setBtnState(e,e.getState);break;case 3:this.description.text=e.st.description.replace("{}",Model.MainLocalService.toUnitConversion(e.thirdValue)+""),this.completionState.text=Model.MainLocalService.toUnitConversion(Math.round(e.dy.count))+"/"+Model.MainLocalService.toUnitConversion(e.thirdValue),this.setBtnState(e,e.getState);break;case 4:this.description.text=e.st.description.replace("{}",Model.MainLocalService.toUnitConversion(e.fourthValue)+""),this.completionState.text=Model.MainLocalService.toUnitConversion(Math.round(e.dy.count))+"/"+Model.MainLocalService.toUnitConversion(e.fourthValue),this.setBtnState(e,e.getState);break;case 5:this.description.text=e.st.description.replace("{}",Model.MainLocalService.toUnitConversion(e.fifthValue)+""),this.completionState.text=Model.MainLocalService.toUnitConversion(Math.round(e.dy.count))+"/"+Model.MainLocalService.toUnitConversion(e.fifthValue),this.setBtnState(e,e.getState);break;case 6:this.description.text=e.st.description.replace("{}",Model.MainLocalService.toUnitConversion(e.fifthValue)+""),this.completionState.text=Model.MainLocalService.toUnitConversion(Math.round(e.dy.count))+"/"+Model.MainLocalService.toUnitConversion(e.fifthValue),this.rewardBtn.visible=!1,this.finish.visible=!0;break;default:alert("成就状态出错！！！c2")}this.rewardBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.btnCallBack,this)},t.prototype.setBtnState=function(e,t){e.RewardType==Model.RewardType.MONEY_TYPE_YB?this.rewardBtn.setAchievementYBBtn(e.RewardCount,t):e.RewardType==Model.RewardType.MONEY_TYPE_JEWEL?this.rewardBtn.setAchievementJWBtn(e.RewardCount,t):alert("cht 奖励类型出错！！！1")},t.prototype.btnCallBack=function(){this.onCallBack&&this.onCallBack(this.aData)},t}(eui.Component);e.AchievementItemVM=t,__reflect(t.prototype,"ViewModel.AchievementItemVM")}(ViewModel||(ViewModel={}));var ViewModel;!function(e){var t=function(t){function i(e,i){var n=t.call(this)||this;return n.achievementItem=[],n.skinName=View.AchievementView,n.uiLayer=e,n.onCallBack=i,n.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){n.uiLayer.removeChild(n)},n),n.uiLayer.addChild(n),n}return __extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.setAchievementList(),this.setYbCount()},i.prototype.setYbCount=function(){this.earnMoney.text=Model.PlayerLocalService.PlayerData.dy.treasure+""},i.prototype.setAchievementList=function(){var t=this;Model.AchievementLocalService.setAchievementList();var i=Model.AchievementLocalService.AchievementList;if(Model.WebServiceBase.isDebug,0==this.listGroup.numChildren)for(var n=0,o=i;n<o.length;n++){var r=o[n],a=new e.AchievementItemVM(this.listGroup,function(e){e.dy.stage=e.matchStage,e.dy.isComplete=!0,Model.WebServiceBase.isDebug&&console.log("cai_haotian dataInfo "+JSON.stringify(e.dy)),Model.WebService.AchievementInfo(e.dy,function(){Model.WebServiceBase.isDebug&&console.log("cai_haotian AchievementInfo success!!!!!!!"),e.RewardType==Model.RewardType.MONEY_TYPE_YB?t.treasureAnimel(e.RewardCount):e.RewardType==Model.RewardType.MONEY_TYPE_JEWEL?(Model.PlayerLocalService.PlayerData.AddJewel=e.RewardCount,Model.WebService.commitData(Model.WebValue.dataDyModel,function(){Model.WebServiceBase.isDebug&&console.log("cai_haotian: commitAuto success ! "+JSON.stringify(Model.WebValue.dataDyModel))},function(){Model.WebValue.isTraditional?alert("數據提交失敗請聯繫管理員！！！！"):alert("数据提交失败请联系管理员！！！！")})):alert("cht 奖励类型出错！！！"),t.setAchievementList()},function(){Model.WebValue.isTraditional?alert("獲取成就信息失敗！！請聯繫管理員！"):alert("获取成就信息失败！！请联系管理员！"),Model.WebServiceBase.isDebug&&console.log("cai_haotian AchievementInfo failed!!!!!!!")})});a.setItemInfo(r),this.achievementItem.push(a)}else for(var l=0;l<i.length;l++)this.achievementItem[l].setItemInfo(i[l])},i.prototype.treasureAnimel=function(e){for(var t=this,i=0;e>i;i++){var n=new eui.Image;n.source="icon_yuanbao_png",n.scaleX=.5,n.scaleY=.5,n.x=458,n.y=100;var o=458,r=o+Model.Mathf.random(-100,100),a=new Model.Vector2(300,300),l=new Model.Vector2(o+18,Model.Mathf.random(130,140)),s=new Model.Vector2(452,91),c=new Model.TweenCustom(n,this.window,a,l,s);c.sAnimTime=Model.Mathf.random(1e3,1200),c.bezierP1Y=180,c.bezierP1X=r;var d=function(e){Model.PlayerLocalService.PlayerData.dy.treasure+=1,t.setYbCount()};c.GoldRecycleAnim(d)}egret.setTimeout(function(){Model.WebService.commitData(Model.WebValue.dataDyModel,function(){Model.WebServiceBase.isDebug&&console.log("cai_haotian: commitAuto success ! "+JSON.stringify(Model.WebValue.dataDyModel))},function(){Model.WebValue.isTraditional?alert("數據提交失敗請聯繫管理員！！！！"):alert("数据提交失败请联系管理员！！！！")})},this,1300)},i}(eui.Component);e.AchievementVM=t,__reflect(t.prototype,"ViewModel.AchievementVM")}(ViewModel||(ViewModel={}));var ViewModel;!function(e){var t=function(e){function t(t,i){var n=e.call(this)||this;return n.skinName=View.AnnouncementMsg,n.uiLayer=t,n.uiLayer.addChild(n),n.onCallBack=i,n}return __extends(t,e),t.prototype.createChildren=function(){var t=this;e.prototype.createChildren.call(this),this.setInfo(),this.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.uiLayer.removeChild(t)},this)},t.prototype.setInfo=function(){},t}(eui.Component);e.AnnouncementMsgVM=t,__reflect(t.prototype,"ViewModel.AnnouncementMsgVM")}(ViewModel||(ViewModel={}));var ViewModel;!function(e){var t=function(e){function t(t,i){var n=e.call(this)||this;return n.skinName=View.BtnActiveSkillView,n.onCallBack=i,n.setSkinPart("skillIconSource",n.skillIconSource),n}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},t.prototype.initSkill=function(e){this.skillData=e,Model.PlayerLocalService.PlayerData.dy.level>=e.st.openLevel?e.dy&&0==e.dy.cdTime&&e.dy.level>=1?(this.currentState="enabled",this.touchEnabled=!0):"disabled"!=this.currentState&&"during"!=this.currentState&&e.dy&&0!=e.dy.cdTime&&this.initSkillCD(e):(this.currentState="locked",this.touchEnabled=!1),this.skillIcon.source=e.st.icon,this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.usingSkill,this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){Model.AudioService.Shared().PlaySound("YX-001_mp3")},this)},t.prototype.initSkillCD=function(e){var t=this;this.counterCD.text=Model.PlayerSkillLocalService.timeDes(e.dy.cdTime),e.dy&&e.dy.cdTime>0&&(this.currentState="disabled",this.cd=egret.setInterval(function(){t.counterCD.text=Model.PlayerSkillLocalService.timeDes(--e.dy.cdTime),0==e.dy.cdTime&&(t.currentState="enabled",egret.clearInterval(t.cd))},this,1e3))},t.prototype.usingSkill=function(){this.onCallBack&&this.onCallBack(this.skillData,this)},t}(eui.Button);e.BtnActiveSkillVM=t,__reflect(t.prototype,"ViewModel.BtnActiveSkillVM")}(ViewModel||(ViewModel={}));var ViewModel;!function(e){var t=function(e){function t(t){var i=e.call(this)||this;return i.btnWordSource="",i.btnWordSourceDown="",i.skinName=View.BtnBottomItem,i.onCallBack=t,i.setSkinPart("btnWordSource",i.btnWordSource),i.setSkinPart("btnWordSourceDown",i.btnWordSourceDown),i}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this)},t.prototype.childrenCreated=function(){var t=this;e.prototype.childrenCreated.call(this),this.btnWordImage.source=this.btnWordSource,this.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){Model.AudioService.Shared().PlaySound("YX-002_mp3"),"down"==t.currentState?t.btnWordImage.source=t.btnWordSourceDown:t.btnWordImage.source=t.btnWordSource},this)},t.prototype.getCurrentState=function(){return"down"==e.prototype.getCurrentState.call(this)?this.btnWordImage.source=this.btnWordSourceDown:this.btnWordImage.source=this.btnWordSource,e.prototype.getCurrentState.call(this)},t}(eui.Button);e.BtnBottomItemVM=t,__reflect(t.prototype,"ViewModel.BtnBottomItemVM")}(ViewModel||(ViewModel={}));var ViewModel;!function(e){var t=function(e){function t(t){var i=e.call(this)||this;return i.skinName=View.BtnBottomView,i.onCallBack=t,i}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},t}(eui.Component);e.BtnBottomVM=t,__reflect(t.prototype,"ViewModel.BtnBottomVM")}(ViewModel||(ViewModel={}));var ViewModel;!function(e){var t=function(e){function t(){var t=e.call(this)||this;
return t.detailTextIn="",t.skinName=View.BtnMagicWeaponDetailItem,t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.detailText.text=this.detailTextIn},t}(eui.Button);e.BtnMagicWeaponDetailVM=t,__reflect(t.prototype,"ViewModel.BtnMagicWeaponDetailVM")}(ViewModel||(ViewModel={}));var ViewModel;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.skinName=View.BtnMusicView,t.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){"up"===t.currentState?t.currentState="down":t.currentState="up"},t),t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this)},t}(eui.Button);e.BtnMusicVM=t,__reflect(t.prototype,"ViewModel.BtnMusicVM")}(ViewModel||(ViewModel={}));var ViewModel;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.btnTextIn="",t.skinName=View.BtnRechargeView,t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.btnText.text=this.btnTextIn},t}(eui.Button);e.BtnRechargeVM=t,__reflect(t.prototype,"ViewModel.BtnRechargeVM")}(ViewModel||(ViewModel={}));var ViewModel;!function(e){var t=function(e){function t(t,i){var n=e.call(this)||this;return n.uiLayer=t,n.onCallBack=i,n.skinName=View.BtnRunItem,n}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this)},t}(eui.ToggleButton);e.BtnRunItemVM=t,__reflect(t.prototype,"ViewModel.BtnRunItemVM")}(ViewModel||(ViewModel={}));var ViewModel;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.skinName=View.BtnShareItem,t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){Model.AudioService.Shared().PlaySound("YX-002_mp3")},this)},t.prototype.setCostIcon=function(e,t,i){this.costIcon.source=e,this.costIcon.width=t,this.costIcon.height=i},t.prototype.downAuto=function(){switch(this.currentState){case"upBlue":this.currentState="downBlue";break;case"up":this.currentState="down"}},t.prototype.setPUpgrade=function(e,t,i){void 0===i&&(i=!1),this.costNum.text=e,this.setCostIcon("icon_yinbi_png",20,20),Model.WebValue.isTraditional?(this.valueLabel.text=String("+"+t+"點擊傷害"),this.valueDesLabel.text="升級"):(this.valueLabel.text=String("+"+t+"点击伤害"),this.valueDesLabel.text="升级"),i?(this.touchEnabled=!0,this.currentState="up"):(this.touchEnabled=!1,this.currentState="disabled"),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.downAuto,this)},t.prototype.setPSLock=function(e,t){this.costNum.text=e,this.setCostIcon("icon_yinbi_png",20,20),Model.WebValue.isTraditional?this.description.text=String("達到"+t+"級時解鎖"):this.description.text=String("达到"+t+"级时解锁"),this.valueDesLabel.text="",this.valueLabel.text="",this.touchEnabled=!1,this.currentState="disabled"},t.prototype.setPSUnlock=function(e,t,i){this.costNum.text=e,this.setCostIcon("icon_yinbi_png",20,20),this.description.text="",Model.WebValue.isTraditional?this.valueDesLabel.text="升級":this.valueDesLabel.text="升级",this.valueLabel.text=String("+"+t),i?(this.touchEnabled=!0,this.currentState="up"):(this.touchEnabled=!1,this.currentState="disabled"),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.downAuto,this)},t.prototype.setFUpgrade=function(e,t,i,n){this.costNum.text=e,this.setCostIcon("icon_yinbi_png",20,20),n?(this.valueLabel.text=n,Model.WebValue.isTraditional?this.valueDesLabel.text="解鎖技能":this.valueDesLabel.text="解锁技能",i?(this.touchEnabled=!0,this.currentState="upBlue"):(this.touchEnabled=!1,this.currentState="disabled")):(Model.WebValue.isTraditional?(this.valueLabel.text=String("+"+t+"秒傷"),this.valueDesLabel.text="升級"):(this.valueLabel.text=String("+"+t+"秒伤"),this.valueDesLabel.text="升级"),i?(this.touchEnabled=!0,this.currentState="up"):(this.touchEnabled=!1,this.currentState="disabled")),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.downAuto,this)},t.prototype.setFLock=function(e,t,i,n){this.costNum.text=t,Model.WebValue.isTraditional?(this.valueLabel.text=String("+"+i+"秒傷"),this.valueDesLabel.text="招募"):(this.valueLabel.text=String("+"+i+"秒伤"),this.valueDesLabel.text="招募"),n?(this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.downAuto,this),this.touchEnabled=!0,this.currentState="up",e==Model.MoneyType.MONEY_TYPE_YB?this.setCostIcon("icon_yuanbao_png",20,15):this.setCostIcon("icon_yinbi_png",20,20)):(this.touchEnabled=!1,this.currentState="disabled",e==Model.MoneyType.MONEY_TYPE_YB?this.setCostIcon("icon_yuanbao_png",20,15):this.setCostIcon("icon_yinbi_png",20,20))},t.prototype.setMWBuy=function(e,t){void 0===t&&(t=!1),this.costIcon.source="icon_lingshi",this.costNum.text=e.toString(),Model.WebValue.isTraditional?this.description.text="購買神器":this.description.text="购买神器",t?(this.touchEnabled=!1,this.currentState="disabled"):(this.touchEnabled=!0,this.currentState="up"),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.downAuto,this)},t.prototype.setMWUnlock=function(e,t){void 0===t&&(t=!1),this.costNum.text=Model.MainLocalService.toUnitConversion(e),this.setCostIcon("icon_lingshi",18,18),Model.WebValue.isTraditional?this.description.text="升級":this.description.text="升级",this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.downAuto,this),t?(this.touchEnabled=!1,this.currentState="disabled"):(this.touchEnabled=!0,this.currentState="up")},t.prototype.setMWLock=function(e){this.costNum.text="",this.costIcon.source="",this.costIcon.width=20,this.costIcon.height=20,Model.WebValue.isTraditional?this.description.text="未獲得":this.description.text="未获得",this.touchEnabled=!1,this.currentState="disabled"},t.prototype.setYBBtn=function(){this.costNum.text="",this.costIcon.source="",Model.WebValue.isTraditional?this.description.text="購買元寶":this.description.text="购买元宝",this.touchEnabled=!0,this.currentState="up",this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.downAuto,this)},t.prototype.setSBuy=function(e,t){void 0===t&&(t=!1),this.costNum.text=Model.MainLocalService.toUnitConversion(e),this.setCostIcon("icon_yuanbao_png",20,15),Model.WebValue.isTraditional?this.description.text="購買道具":this.description.text="购买道具",this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.downAuto,this),t?(this.touchEnabled=!0,this.currentState="up"):(this.touchEnabled=!1,this.currentState="disabled")},t.prototype.setYBBuy=function(e,t){void 0===t&&(t=!1),this.costIcon.visible=!1,this.costNum.visible=!1,Model.WebValue.isTraditional?this.description.text="購買道具":this.description.text="购买道具",this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.downAuto,this),t?(this.touchEnabled=!0,this.currentState="up"):(this.touchEnabled=!1,this.currentState="disabled")},t.prototype.skillUsing=function(){this.touchEnabled=!1,this.currentState="disabled",Model.WebValue.isTraditional?this.description.text="技能持續中...":this.description.text="技能持续中..."},t.prototype.setReduceCD=function(e){void 0===e&&(e=!1),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.downAuto,this),e?(this.touchEnabled=!0,this.currentState="up"):(this.touchEnabled=!1,this.currentState="disabled")},t.prototype.setCumulativeBtn=function(e,t){void 0===t&&(t=!1),this.costNum.text=Model.MainLocalService.toUnitConversion(e),this.setCostIcon("icon_lingshi",18,18),Model.WebValue.isTraditional?this.description.text="獎 勵":this.description.text="奖 励",this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.downAuto,this),t?(this.touchEnabled=!0,this.currentState="up"):(this.touchEnabled=!1,this.currentState="disabled")},t.prototype.setDailyRecharge=function(e){this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.downAuto,this),e?(this.touchEnabled=!0,this.currentState="up",Model.WebValue.isTraditional?this.description.text="可領取":this.description.text="可领取"):(this.touchEnabled=!1,this.currentState="disabled",Model.WebValue.isTraditional?this.description.text="未達成":this.description.text="未达成")},t.prototype.setAchievementYBBtn=function(e,t){this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.downAuto,this),this.costNum.text=Model.MainLocalService.toUnitConversion(e),this.setCostIcon("icon_yuanbao_png",20,15),Model.WebValue.isTraditional?this.description.text="獎  勵":this.description.text="奖  励",t?(this.touchEnabled=!0,this.currentState="up"):(this.touchEnabled=!1,this.currentState="disabled")},t.prototype.setAchievementJWBtn=function(e,t){this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.downAuto,this),this.costNum.text=Model.MainLocalService.toUnitConversion(e),this.setCostIcon("icon_lingshi",18,18),Model.WebValue.isTraditional?this.description.text="獎  勵":this.description.text="奖  励",t?(this.touchEnabled=!0,this.currentState="up"):(this.touchEnabled=!1,this.currentState="disabled")},t.prototype.setClanBtn=function(e){this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.downAuto,this),this.costNum.text=Model.MainLocalService.toUnitConversion(e),this.setCostIcon("icon_yuanbao_png",20,15),this.touchEnabled=!0,this.currentState="up",Model.WebValue.isTraditional?this.description.text="立即激活":this.description.text="立即激活"},t.prototype.setOffLineBtn=function(){this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.downAuto,this),this.touchEnabled=!0,this.costIcon.visible=!1,this.costNum.visible=!1,this.currentState="up",Model.WebValue.isTraditional?this.description.text="我知道了":this.description.text="我知道了"},t.prototype.setChallengBtn=function(e){this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.downAuto,this),Model.WebValue.isTraditional?this.description.text="開始挑戰":this.description.text="开始挑战",this.costIcon.visible=!1,this.costNum.visible=!1,e?(this.touchEnabled=!0,this.currentState="up"):(this.touchEnabled=!1,this.currentState="disabled")},t.prototype.setFreeSkill=function(){this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.downAuto,this),Model.WebValue.isTraditional?this.description.text="免費釋放技能":this.description.text="免费释放技能",this.costIcon.visible=!1,this.costNum.visible=!1,this.touchEnabled=!0,this.currentState="up"},t}(eui.Button);e.BtnShareVM=t,__reflect(t.prototype,"ViewModel.BtnShareVM")}(ViewModel||(ViewModel={}));var ViewModel;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.skinName=View.BtnSmallShareItem,t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){Model.AudioService.Shared().PlaySound("YX-002_mp3")},this)},t.prototype.setFriendIcon=function(e,t){this.friend.visible=!0,this.describe.text="+"+e,this.costNum.text=t},t.prototype.setCharIcon=function(e,t){this.zhujue.visible=!0,this.describe.text="+"+e,this.costNum.text=t},t}(eui.Button);e.BtnSmallShareVM=t,__reflect(t.prototype,"ViewModel.BtnSmallShareVM")}(ViewModel||(ViewModel={}));var ViewModel;!function(e){var t=function(e){function t(t){var i=e.call(this)||this;return i.btnIconSource="",i.skinName=View.BtnTopItem,i.onCallBack=t,i}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.btnIcon.source=this.btnIconSource,this.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){Model.AudioService.Shared().PlaySound("YX-001_mp3")},this)},t}(eui.Button);e.BtnTopItemVM=t,__reflect(t.prototype,"ViewModel.BtnTopItemVM")}(ViewModel||(ViewModel={}));var ViewModel;!function(e){var t=function(e){function t(t){var i=e.call(this)||this;return i.skinName=View.BtnTopView,i.onCallBack=t,i}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this)},t}(eui.Component);e.BtnTopVM=t,__reflect(t.prototype,"ViewModel.BtnTopVM")}(ViewModel||(ViewModel={}));var ViewModel;!function(e){var t=function(e){function t(t,i){var n=e.call(this)||this;return n.skinName=View.CharDetailMsg,n.uiLayer=t,n.onCallBack=i,n.uiLayer.addChild(n),n}return __extends(t,e),t.prototype.createChildren=function(){var t=this;e.prototype.createChildren.call(this),this.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.uiLayer.removeChild(t)},this)},t.prototype.initPData=function(){void 0===Model.PlayerLocalService.PlayerData.dy.nickName?(Model.WebValue.isTraditional?this.skillId.text="新用戶"+Model.Mathf.random(1,9999):this.skillId.text="新用户"+Model.Mathf.random(1,9999),Model.PlayerLocalService.PlayerData.dy.nickName=this.skillId.text):this.skillId.text=Model.PlayerLocalService.PlayerData.dy.nickName;var e=Model.PlayerSkillLocalService.PlayerSkillList;Model.WebValue.isTraditional?this.skillDetail.text="Lv."+Model.WebValue.dataDyModel.playerModel.level+"           秒傷:"+Model.PlayerLocalService.PlayerData.ClickDamageAndUnit:this.skillDetail.text="Lv."+Model.WebValue.dataDyModel.playerModel.level+"           秒伤:"+Model.PlayerLocalService.PlayerData.ClickDamageAndUnit,this.skillDes.text="    "+Model.PlayerLocalService.PlayerData.st.playerDescription,this.skillIcon.source=Model.WebValue.dataStModel.sysConfigModel.leadHead,this.playerSkillList.visible=!0;for(var t,i=0;i<this.playerSkillList.numElements;i++){if(t=this.playerSkillList.getChildAt(i),t.zhujueDetail.visible=!0,t.skillIcon.source=e[i].st.icon,t.skillName.text=e[i].st.name,e[i].dy){e[i].effect}else{e[i].effect;t.Mask.visible=!0,t.MaskWord.text="Lv:"+e[i].st.openLevel}t.skillResult.text=e[i].Description,Model.WebValue.isTraditional?0==i?t.skillDetail.text="持續時間："+e[i].continueTime+"s   冷卻時間："+e[i].cdTime+"s":t.skillDetail.text="持續時間："+e[i].continueTime+"s   冷卻時間："+e[i].cdTime+"s":0==i?t.skillDetail.text="持续时间："+e[i].continueTime+"s   冷却时间："+e[i].cdTime+"s":t.skillDetail.text="持续时间："+e[i].continueTime+"s   冷却时间："+e[i].cdTime+"s"}},t.prototype.initFData=function(e){this.skillId.text=e.st.name,Model.WebValue.isTraditional?e.dy?this.skillDetail.text="Lv."+e.dy.level+"           秒傷:"+e.DpsAndUnit:this.skillDetail.text="Lv.0           秒傷:0":e.dy?this.skillDetail.text="Lv."+e.dy.level+"           秒伤:"+e.DpsAndUnit:this.skillDetail.text="Lv.0           秒伤:0",this.skillDes.text=e.st.description,this.skillIcon.source=e.st.icon,this.friendSkillList.visible=!0;var t,i=["一","二","三","四","五","六","七"],n=new Array;n.FRIEND_SKILL_TYPE_SLEF=Model.WebValue.isTraditional?"提升{}本技能傷害":"提升{}本技能伤害",n.FRIEND_SKILL_TYPE_ALL=Model.WebValue.isTraditional?"提升{}所有傷害":"提升{}所有伤害",n.FRIEND_SKILL_TYPE_CRIT=Model.WebValue.isTraditional?"提升{}暴擊傷害":"提升{}暴击伤害",n.FRIEND_SKILL_TYPE_CRIT_PROBABILITY=Model.WebValue.isTraditional?"提升{}暴擊率":"提升{}暴击率",n.FRIEND_SKILL_TYPE_CLICK=Model.WebValue.isTraditional?"提升{}點擊傷害":"提升{}点击伤害",n.FRIEND_SKILL_TYPE_COIN=Model.WebValue.isTraditional?"提升{}銅幣掉落數量":"提升{}铜币掉落数量",n.FRIEND_SKILL_TYPE_BOX_COIN=Model.WebValue.isTraditional?"提升{}寶箱銅幣掉落數量":"提升{}宝箱铜币掉落数量",n.FRIEND_SKILL_TYPE_BOSS=Model.WebValue.isTraditional?"提升{}對BOSS的傷害":"提升{}对BOSS的伤害";for(var o=[Model.WebValue.dataStModel.sysConfigModel.openFriendSkillLevelFirst,Model.WebValue.dataStModel.sysConfigModel.openFriendSkillLevelSecond,Model.WebValue.dataStModel.sysConfigModel.openFriendSkillLevelThird,Model.WebValue.dataStModel.sysConfigModel.openFriendSkillLevelFourth,Model.WebValue.dataStModel.sysConfigModel.openFriendSkillLevelFifth,Model.WebValue.dataStModel.sysConfigModel.openFriendSkillLevelSixth,Model.WebValue.dataStModel.sysConfigModel.openFriendSkillLevelSeventh],r=0;r<this.friendSkillList.numElements;r++){t=this.friendSkillList.getChildAt(r),t.friendDetail.visible=!0;var a=r+1;switch(t.skillIcon.source="layer_0"+a+"_l",Model.WebValue.isTraditional?t.skillLevel.text="第"+i[r]+"重":t.skillLevel.text="第"+i[r]+"重",(!e.dy||e.dy.layerId<r+1)&&(t.Mask.visible=!0,t.MaskWord.text="Lv:"+o[r]),r){case 0:t.skillEffect.text=n[e.st.firstLayerType].replace("{}",e.st.firstLayerValue+"%");break;case 1:t.skillEffect.text=n[e.st.secondLayerType].replace("{}",e.st.secondLayerValue+"%");break;case 2:t.skillEffect.text=n[e.st.thirdLayerType].replace("{}",e.st.thirdLayerValue+"%");break;case 3:t.skillEffect.text=n[e.st.fourthLayerType].replace("{}",e.st.fourthLayerValue+"%");break;case 4:t.skillEffect.text=n[e.st.fifthLayerType].replace("{}",e.st.fifthLayerValue+"%");break;case 5:t.skillEffect.text=n[e.st.sixthLayerType].replace("{}",e.st.sixthLayerValue+"%");break;case 6:t.skillEffect.text=n[e.st.seventhLayerType].replace("{}",e.st.seventhLayerValue+"%");break;default:alert("数据出错！请联系管理员！")}}},t}(eui.Component);e.CharDetailMsgVM=t,__reflect(t.prototype,"ViewModel.CharDetailMsgVM")}(ViewModel||(ViewModel={}));var ViewModel;!function(e){var t=function(t){function i(e,i){var n=t.call(this)||this;return n.flag=1,n.tenBtn=null,n.hundredBtn=null,n.skinName=View.CharItem,n.uiGroup=e,n.onCallback=i,n.uiGroup.addChild(n),n}return __extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.levelUpAnimel()},i.prototype.setPData=function(e){if(!e||!e.st)return void alert("主角数据错误，请重新加载 ! ");if(this.pData=e,this.friendGroup.visible=!1,this.bgImage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.createCharPop,this),this.levelBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPlayerEvent,this),this.levelBtn0.addEventListener(egret.TouchEvent.TOUCH_TAP,this.playerBtnTenUp,this),this.levelBtn1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.playerBtnHundredUp,this),e.dy){Model.WebValue.isTraditional?(this.skillName.text=e.dy.nickName?e.dy.nickName:"新用戶",this.skillDes.text=String("點擊傷害： "+e.ClickDamageAndUnit)):(this.skillName.text=e.dy.nickName?e.dy.nickName:"新用户",this.skillDes.text=String("点击伤害： "+e.ClickDamageAndUnit)),this.skillLevel.text=e.dy.level.toString(),this.skillIcon.source=e.st.leadHead;var t=Model.PlayerLocalService.PlayerData.dy.gold>e.upgradeCost;this.levelBtn.setPUpgrade(e.UpgradeCostAndUnit,e.ClickDamageDeltaUnit,t),this.levelBtn0.setCharIcon(10,this.pData.TenUpgradeCostAndUnit),this.levelBtn1.setCharIcon(100,this.pData.HundredUpgradeCostAndUnit)}else alert("主角动态数据错误，请重新加载 ! ")},i.prototype.setPSData=function(e){if(!e||!e.st)return void alert("主角技能数据错误，请重新加载 ! ");if(this.pSData=e,this.friendGroup.visible=!1,this.bgImage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.createCharPop,this),this.levelBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPlayerSkillEvent,this),this.levelBtn0.addEventListener(egret.TouchEvent.TOUCH_TAP,this.playerSkillBtnTenUp,this),this.levelBtn1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.playerSkillBtnHundredUp,this),this.skillName.text=e.st.name,e.dy){this.skillLevel.text=e.dy.level.toString(),this.skillDes.text=e.Description,this.skillIcon.source=e.st.icon;var t=Model.PlayerLocalService.PlayerData.dy.gold>e.cost;this.levelBtn.setPSUnlock(e.CostAndUnit,e.effectDelta.toString(),t),e.dy.level>0&&this.levelBtn0.setCharIcon(10,e.TenUpgradeCostAndUnit)}else this.skillLevel.text="0",this.skillDes.text=e.Description,this.skillIcon.source=e.st.icon,this.levelBtn.setPSLock(e.CostAndUnit,e.st.openLevel)},i.prototype.setBFData=function(e){if(!e||!e.st)return void alert("数据错误，请重新加载 ! ");if(this.newSkill.visible=!1,this.fData=e,this.skillName.text=e.st.name,this.friendDps.visible=!0,this.skillIcon.source=e.Icon,this.levelBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBuyFEvent,this),this.levelBtn0.addEventListener(egret.TouchEvent.TOUCH_TAP,this.friendBtnTenUp,this),this.levelBtn1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.friendBtnHundredUp,this),this.bgImage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.createFriendPop,this),this.layerBgImage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.createFriendPop,this),this.dead.addEventListener(egret.TouchEvent.TOUCH_TAP,this.friendDead,this),e&&e.st&&e.dy){0!=e.dy.sealCD?this.dead.visible=!0:this.dead.visible=!1;for(var t=0;t<e.dy.layerId;t++)this.layerGroup.getChildAt(t).visible=!0;this.levelBtn0.setFriendIcon(10,this.fData.TenUpgradeCostAndUnit),this.levelBtn1.setFriendIcon(100,this.fData.hundredUpgradeCostAndUnit),this.skillLevel.text=e.dy.level.toString(),Model.WebValue.isTraditional?this.friendDps.text=String("秒傷:"+e.DpsAndUnit):this.friendDps.text=String("秒伤:"+e.DpsAndUnit),e.dy.layerId<e.layerMatchLevel?(this.layerBgImage.visible=!0,this.levelBtn.setFUpgrade(e.LayerCostAndUnit,e.DpsDeltaUnit,Model.PlayerLocalService.PlayerData.dy.gold>e.layerCost,e.LayerStr)):(this.layerBgImage.visible=!1,this.levelBtn.setFUpgrade(e.UpgradeCostAndUnit,e.DpsDeltaUnit,Model.PlayerLocalService.PlayerData.dy.gold>e.upgradeCost))}else e.reachRecruit?(this.recruitGroup.visible=!1,this.visible=!0,this.includeInLayout=!0,this.skillLevel.text="0",Model.WebValue.isTraditional?this.friendDps.text="未解鎖":this.friendDps.text="未解锁",this.levelBtn.visible=!0,this.newSkill.visible=!0,e.RecruitMoneyType==Model.MoneyType.MONEY_TYPE_YB?this.levelBtn.setFLock(e.RecruitMoneyType,e.RecruitCostAndUnit,e.DpsAndUnit,!0):this.levelBtn.setFLock(e.RecruitMoneyType,e.RecruitCostAndUnit,e.DpsAndUnit,e.IsEnoughRecruit)):(this.visible=e.isShow,this.includeInLayout=e.isShow,e.isShow&&(this.recruitGroup.visible=!0,Model.WebValue.isTraditional?this.recruitDemand.text="招募條件：  "+e.RecruitDemand:this.recruitDemand.text="招募条件：  "+e.RecruitDemand,this.levelBtn.visible=!1))},i.prototype.createFriendPop=function(){if(this.onCallback){var t=new e.CharDetailMsgVM(Main.singleton,function(){});t.initFData(this.fData)}},i.prototype.createCharPop=function(){if(this.onCallback){var t=new e.CharDetailMsgVM(Main.singleton,function(){});t.initPData()}},i.prototype.onPlayerEvent=function(){this.onCallback&&(this.onCallback(this.pData,1),this.playerShowBtn())},i.prototype.playerBtnTenUp=function(){this.onCallback&&(this.onCallback(this.pData,10),this.playerShowBtn(!0))},i.prototype.playerBtnHundredUp=function(){this.onCallback&&(this.onCallback(this.pData,100),this.playerShowBtn(!0))},i.prototype.playerShowBtn=function(e){if(void 0===e&&(e=!1),isFinite(this.pData.tenUpgradeCost)&&isFinite(this.pData.hundredUpgradeCost))if(e){null!=this.tenBtn&&(egret.clearTimeout(this.tenBtn),this.tenBtn=null),null!=this.hundredBtn&&(egret.clearTimeout(this.hundredBtn),this.hundredBtn=null);var t=Model.PlayerLocalService.PlayerData.dy.gold<=this.pData.tenUpgradeCost,i=Model.PlayerLocalService.PlayerData.dy.gold<=this.pData.hundredUpgradeCost;this.setBtnClose(t,i)}else if(this.flag++,5==this.flag){var n=Model.PlayerLocalService.PlayerData.dy.gold>this.pData.tenUpgradeCost,o=Model.PlayerLocalService.PlayerData.dy.gold>this.pData.hundredUpgradeCost;this.setBtnShow(n,o),this.flag=0}else{var t=Model.PlayerLocalService.PlayerData.dy.gold<=this.pData.tenUpgradeCost,i=Model.PlayerLocalService.PlayerData.dy.gold<=this.pData.hundredUpgradeCost;this.setBtnClose(t,i)}else this.levelBtn0.visible=!1,this.levelBtn1.visible=!1;this.levelUpCharAnimel()},i.prototype.onPlayerSkillEvent=function(){this.onCallback&&this.onCallback(this.pSData,1)},i.prototype.playerSkillBtnTenUp=function(){this.onCallback&&this.onCallback(this.pSData,10)},i.prototype.playerSkillBtnHundredUp=function(){this.onCallback&&this.onCallback(this.pSData,100)},i.prototype.onBuyFEvent=function(){this.onCallback&&(this.onCallback(this.fData,1),this.fData.dy&&this.friendShowBtn())},i.prototype.friendBtnTenUp=function(){this.onCallback&&(this.onCallback(this.fData,10),this.fData.dy&&this.friendShowBtn(!0))},i.prototype.friendBtnHundredUp=function(){this.onCallback(this.fData,100),this.fData.dy&&this.friendShowBtn(!0)},i.prototype.friendDead=function(){this.onCallback(this.fData,1)},i.prototype.friendShowBtn=function(e){if(void 0===e&&(e=!1),this.playlevelUpAnieml(),isFinite(this.fData.tenUpgradeCost)&&isFinite(this.fData.hundredUpgradeCost))if(e){null!=this.tenBtn&&(egret.clearTimeout(this.tenBtn),this.tenBtn=null),null!=this.hundredBtn&&(egret.clearTimeout(this.hundredBtn),this.hundredBtn=null);var t=Model.PlayerLocalService.PlayerData.dy.gold<=this.fData.tenUpgradeCost,i=Model.PlayerLocalService.PlayerData.dy.gold<=this.fData.hundredUpgradeCost;this.setBtnClose(t,i)}else if(this.flag++,5==this.flag){var n=Model.PlayerLocalService.PlayerData.dy.gold>this.fData.tenUpgradeCost,o=Model.PlayerLocalService.PlayerData.dy.gold>this.fData.hundredUpgradeCost;this.setBtnShow(n,o),this.flag=0}else{var t=Model.PlayerLocalService.PlayerData.dy.gold<=this.fData.tenUpgradeCost,i=Model.PlayerLocalService.PlayerData.dy.gold<=this.fData.hundredUpgradeCost;this.setBtnClose(t,i)}else this.levelBtn0.visible=!1,this.levelBtn1.visible=!1},i.prototype.setBtnShow=function(e,t){var i=this;this.levelBtn0.visible=e,this.levelBtn1.visible=t,this.tenBtn=egret.setTimeout(function(){i.levelBtn0.visible=!1},this,3e3),this.hundredBtn=egret.setTimeout(function(){i.levelBtn1.visible=!1},this,3e3)},i.prototype.setBtnClose=function(e,t){var i=this;e?this.levelBtn0.visible=!1:this.tenBtn=egret.setTimeout(function(){i.levelBtn0.visible=!1},this,3e3),t?this.levelBtn1.visible=!1:this.hundredBtn=egret.setTimeout(function(){i.levelBtn1.visible=!1},this,3e3)},i.prototype.levelUpAnimel=function(){},i.prototype.playlevelUpAnieml=function(){var e=this;this.armature.display.visible=!0,this.armature.animation.gotoAndPlay("Tx_shengji_02",-1,-1,1),this.armature.addEventListener(dragonBones.AnimationEvent.COMPLETE,function(){e.armature.display.visible=!1},this),this.fData.Type==Model.FriendType.FRIEND_TYPE_FRIEND&&this.levelUpCharAnimel(this.fData.st.id)},i.prototype.levelUpCharAnimel=function(t){void 0===t&&(t=0);var i=new e.HeroItemVM(Main.singleton.mainGameVM.levelUpLight),n=i.initMovieClip("levelUpLight_12_json","levelUpLight_12_png","guangxian",1,function(){Main.singleton.mainGameVM.levelUpLight.removeChild(n)});switch(t){case 0:var o=new e.HeroItemVM(Main.singleton.mainGameVM.yungeLevelUp),r=o.initMovieClip("levelUp_12_json","levelUp_12_png","dipan",1,function(){Main.singleton.mainGameVM.yungeLevelUp.removeChild(r)});r.x=268,r.y=415,n.x=269,n.y=413.45;break;case 1:var o=new e.HeroItemVM(Main.singleton.mainGameVM.baiheLevelUp),r=o.initMovieClip("levelUp_12_json","levelUp_12_png","dipan",1,function(){Main.singleton.mainGameVM.baiheLevelUp.removeChild(r)});r.x=190,r.y=465,n.x=191,n.y=463.45;break;case 7:var o=new e.HeroItemVM(Main.singleton.mainGameVM.bingyiLevelUp),r=o.initMovieClip("levelUp_12_json","levelUp_12_png","dipan",1,function(){Main.singleton.mainGameVM.bingyiLevelUp.removeChild(r)});r.x=91,r.y=503,n.x=92,n.y=501.45;break;case 13:var o=new e.HeroItemVM(Main.singleton.mainGameVM.xupingjunLevelUp),r=o.initMovieClip("levelUp_12_json","levelUp_12_png","dipan",1,function(){Main.singleton.mainGameVM.xupingjunLevelUp.removeChild(r)});r.x=201,r.y=352,n.x=202,n.y=350.45;break;case 19:var o=new e.HeroItemVM(Main.singleton.mainGameVM.mengjueLevelUp),r=o.initMovieClip("levelUp_12_json","levelUp_12_png","dipan",1,function(){Main.singleton.mainGameVM.mengjueLevelUp.removeChild(r)});r.x=96,r.y=310,n.x=97,n.y=308.45;break;case 25:var o=new e.HeroItemVM(Main.singleton.mainGameVM.liufulingLevelUp),r=o.initMovieClip("levelUp_12_json","levelUp_12_png","dipan",1,function(){Main.singleton.mainGameVM.liufulingLevelUp.removeChild(r)});r.x=78,r.y=397,n.x=79,n.y=395.45;break;default:alert("升级特效出错！请联系管理员！")}},i}(eui.Component);e.CharItemVM=t,__reflect(t.prototype,"ViewModel.CharItemVM")}(ViewModel||(ViewModel={}));var ViewModel;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.skinName=View.CharMsgItem,t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this)},t}(eui.Component);e.CharMsgItemVM=t,__reflect(t.prototype,"ViewModel.CharMsgItemVM")}(ViewModel||(ViewModel={}));var ViewModel;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.btnImgSource="icon_guanbi",t.skinName=View.CloseBtn,t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.btnImg.source=this.btnImgSource},t.prototype.setEffect=function(){},t}(eui.Button);e.CloseBtnVM=t,__reflect(t.prototype,"ViewModel.CloseBtnVM")}(ViewModel||(ViewModel={}));var ViewModel;!function(e){var t=function(e){function t(t){var i=e.call(this)||this;return i.enabled=!1,i.group=t,i.skinName=View.CutHpItem,i.group.addChild(i),i}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this)},t.prototype.setNoramlAttack=function(e,t){this.data=e,this.damage=t,this.normalAttack.font=RES.getRes("normal-font_fnt"),this.normalAttack.smoothing=!0,this.normalAttack.text=e,this.TweenAnimate(100)},t.prototype.setCriticalAttack=function(e,t){var i=this;this.data=e,this.damage=t,this.criticalAttack.font=RES.getRes("critical-font_fnt"),this.criticalAttack.smoothing=!0,this.criticalAttack.text=e,this.criticalAttack.y=10,egret.setTimeout(function(){i.TweenAnimate(50)},this,200)},t.prototype.TweenAnimate=function(e){var t=this,i=egret.Tween.get(this);i.to({alpha:0,y:this.y-e},1e3).call(function(){Model.PlayerLocalService.setPerSecondTapDamage(-t.damage),t.group.removeChild(t)})},t}(eui.Component);e.CutHpItemVM=t,__reflect(t.prototype,"ViewModel.CutHpItemVM")}(ViewModel||(ViewModel={}));var ViewModel;!function(e){var t=function(e){function t(t,i){var n=e.call(this)||this;return n.uiGroup=t,n.onCallBack=i,n}return __extends(t,e),t.prototype.initParticle=function(e,t){var i=this,n=RES.getRes(t),o=RES.getRes(e);this.system=new particle.GravityParticleSystem(n,o),this.system.start(),this.system.addEventListener(egret.Event.LOOP_COMPLETE,function(){i.uiGroup.removeChild(i.system)},this),this.uiGroup.addChild(this.system)},t}(eui.Component);e.EffectParticleVM=t,__reflect(t.prototype,"ViewModel.EffectParticleVM")}(ViewModel||(ViewModel={}));var ViewModel;!function(e){var t=function(e){function t(t,i){var n=e.call(this)||this;return n.skinName=View.GiftPacksView,n.uiLayer=t,n.onCallBack=i,n.buyBtn.description.text="￥ 9",n.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){n.uiLayer.removeChild(n)},n),n.uiLayer.addChild(n),n}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){Model.AudioService.Shared().PlaySound("YX-001_mp3")},this)},t}(eui.Component);e.GiftPacksVM=t,__reflect(t.prototype,"ViewModel.GiftPacksVM")}(ViewModel||(ViewModel={}));var ViewModel;!function(e){var t=function(e){function t(t){var i=e.call(this)||this;return i.onCallBack=null,i.movieClip=null,i.uiGroup=t,i}return __extends(t,e),t.prototype.initMovieClip=function(e,t,i,n,o,r){void 0===n&&(n=-1),void 0===r&&(r=!0),this.onCallBack=o;var a=new egret.MovieClipDataFactory(RES.getRes(e),RES.getRes(t));return this.movieClip=new egret.MovieClip(a.generateMovieClipData(i)),r?this.movieClip.addEventListener(egret.Event.COMPLETE,this.onEvent,this):this.movieClip.addEventListener(egret.MovieClipEvent.FRAME_LABEL,this.onEvent,this),this.uiGroup.addChild(this.movieClip),this.movieClip.play(n),this.movieClip},t.prototype.onEvent=function(e){this.onCallBack&&this.onCallBack()},t.prototype.changeMovieClip=function(e,t,i,n,o){if(void 0===n&&(n=-1),this.onCallBack=o,this.movieClip){this.movieClip.stop();var r=new egret.MovieClipDataFactory(RES.getRes(e),RES.getRes(t));return this.movieClip.movieClipData=r.generateMovieClipData(i),this.movieClip.play(n),this.movieClip}return this.movieClip},t}(eui.Component);e.HeroItemVM=t,__reflect(t.prototype,"ViewModel.HeroItemVM")}(ViewModel||(ViewModel={}));var ViewModel;!function(e){var t=function(e){function t(t,i){var n=e.call(this)||this;return n.skinName=View.KilledView,n.uiLayer=t,n.onCallBack=i,n.uiLayer.addChild(n),n}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.initVM()},t.prototype.initVM=function(){var e=this;this.commit.costIcon.visible=!1,this.commit.costNum.visible=!1,Model.WebValue.isTraditional?this.commit.description.text="現在復活！":this.commit.description.text="现在复活！",this.CloseBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.uiLayer.removeChild(e),e.countTime&&egret.clearInterval(e.countTime)},this)},t.prototype.setFDataInfo=function(e){var t=this;this.fData=e,this.skillIcon.source=e.Icon,Model.WebValue.isTraditional?this.skillName.textFlow=[{text:e.st.name,style:{textColor:16711680}},{text:"被首領殺掉了！"}]:this.skillName.textFlow=[{text:e.st.name,style:{textColor:16711680}},{text:"被首领杀掉了！"}];
var i=new Date,n=i.getTime()/1e3;this.leftDps.text="-"+e.DpsAndUnit;var o=e.dy.sealCD-n,r=Model.TimeSpan.FromSeconds(o);this.leftTime.text=r.toString(),this.countTime=egret.setInterval(function(){var e=Model.TimeSpan.FromSeconds(o);t.leftTime.text=e.toString(),o--},this,1e3),Model.FriendLocalService.setResurgenceMoney(e,o),this.needMoney.text=e.sealCDMoney+"",this.commit.addEventListener(egret.TouchEvent.TOUCH_TAP,this.callBackFunc,this)},t.prototype.callBackFunc=function(){this.onCallBack&&(this.onCallBack(this.fData),0==this.fData.dy.sealCD&&(this.uiLayer.removeChild(this),this.countTime&&egret.clearInterval(this.countTime)))},t}(eui.Component);e.KilledViewVM=t,__reflect(t.prototype,"ViewModel.KilledViewVM")}(ViewModel||(ViewModel={}));var ViewModel;!function(e){var t=function(e){function t(t,i){var n=e.call(this)||this;return n.skinName=View.LackGoldView,n.uiLayer=t,n.onCallBack=i,n.uiLayer.addChild(n),n}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.initVM()},t.prototype.initVM=function(){var e=this;Model.WebValue.isTraditional?this.cancelBtn.description.text="取消":this.cancelBtn.description.text="取消",this.cancelBtn.description.size=22,this.cancelBtn.costIcon.visible=!1,this.cancelBtn.costNum.visible=!1,Model.WebValue.isTraditional?this.rechargeBtn.description.text="儲值":this.rechargeBtn.description.text="充值",this.rechargeBtn.description.size=22,this.rechargeBtn.costIcon.visible=!1,this.rechargeBtn.costNum.visible=!1,egret.Tween.get(this.mask_black).to({alpha:.7},700,egret.Ease.circIn),egret.Tween.get(this.window).to({y:0},700,egret.Ease.backOut),this.cancelBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){egret.Tween.get(e.mask_black).to({alpha:0},700,egret.Ease.circIn),egret.Tween.get(e.window).to({y:-550},700,egret.Ease.backIn),egret.setTimeout(function(){e.uiLayer.removeChild(e)},e,700)},this),this.rechargeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.onCallBack(),egret.Tween.get(e.mask_black).to({alpha:0},700,egret.Ease.circIn),egret.Tween.get(e.window).to({y:-550},700,egret.Ease.backIn),egret.setTimeout(function(){e.uiLayer.removeChild(e);for(var t=0;t<Main.singleton.mainMenuVM.btnBottomGroup.length;t++)Main.singleton.mainMenuVM.btnBottom.btnMall==Main.singleton.mainMenuVM.btnBottomGroup[t]?(Main.singleton.mainMenuVM.btnBottomGroup[t].currentState="down",Main.singleton.mainMenuVM.btnBottomGroup[t].enabled=!1,Main.singleton.mainMenuVM.btnBottomGroup[t].btnWordImage.source=Main.singleton.mainMenuVM.btnBottomGroup[t].btnWordSourceDown):(Main.singleton.mainMenuVM.btnBottomGroup[t].currentState="up",Main.singleton.mainMenuVM.btnBottomGroup[t].enabled=!0,Main.singleton.mainMenuVM.btnBottomGroup[t].btnWordImage.source=Main.singleton.mainMenuVM.btnBottomGroup[t].btnWordSource);Main.singleton.mainMenuVM.menuPopupGroup.visible=!0,Main.singleton.mainMenuVM.menuPopup.setMData(!0)},e,700)},this)},t}(eui.Component);e.LackGoldVM=t,__reflect(t.prototype,"ViewModel.LackGoldVM")}(ViewModel||(ViewModel={}));var ViewModel;!function(e){var t=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.skinName="View.LoadingBarItem",this.thumb=this.loadingBar,this.labelDisplay=this.loadingLabel,this.minimum=0,this.value=0,this.maximum=100},t.prototype.setProgress=function(e,t){this.value=Math.floor(e/t*100)},t}(eui.ProgressBar);e.LoadingBarItemVM=t,__reflect(t.prototype,"ViewModel.LoadingBarItemVM")}(ViewModel||(ViewModel={}));var ViewModel;!function(e){var t=function(e){function t(t,i){var n=e.call(this)||this;return n.skinName=View.LogoView,n.onCallBack=i,n.uiLayer=t,n.uiLayer.addChild(n),n}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),null!=this.onCallBack&&this.onCallBack()},t}(eui.Component);e.LogoVM=t,__reflect(t.prototype,"ViewModel.LogoVM")}(ViewModel||(ViewModel={}));var ViewModel;!function(e){var t=function(e){function t(t,i){var n=e.call(this)||this;return n.skinName=View.MagicWeaponBuyDetail,n.uiLayer=t,n.onCallBack=i,n.uiLayer.addChild(n),n}return __extends(t,e),t.prototype.createChildren=function(){var t=this;e.prototype.createChildren.call(this),this.magicCloseBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.uiLayer.removeChild(t)},this)},t}(eui.Component);e.MagicWeaponBuyDetailVM=t,__reflect(t.prototype,"ViewModel.MagicWeaponBuyDetailVM")}(ViewModel||(ViewModel={}));var ViewModel;!function(e){var t=function(e){function t(t,i){var n=e.call(this)||this;return n.skinName=View.MagicWeaponDetailView,n.uiLayer=t,n.onCallBack=i,n.uiLayer.addChild(n),n}return __extends(t,e),t.prototype.createChildren=function(){var t=this;e.prototype.createChildren.call(this),this.magicCloseBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.uiLayer.removeChild(t)},this)},t.prototype.setMWData=function(e){this.mWData=e,this.magicWeapon.source=this.mWData.Icon,this.weaponName.text=this.mWData.st.name,this.mWData.dy?this.weaponLevel.text="Lv."+this.mWData.dy.level:this.weaponLevel.text="Lv.0",this.weaponAddNow.text=this.mWData.st.descriptionFirst.replace("{}",this.mWData.effectFirst+""),this.weaponRemoveNow.text=this.mWData.st.descriptionSecond.replace("{}",this.mWData.effectSecond+""),this.weaponAddNext.text=this.mWData.st.descriptionFirst.replace("{}",this.mWData.effectFirstNext+""),this.weaponRemoveNext.text=this.mWData.st.descriptionSecond.replace("{}",this.mWData.effectSecondNext+"")},t}(eui.Component);e.MagicWeaponDetailVM=t,__reflect(t.prototype,"ViewModel.MagicWeaponDetailVM")}(ViewModel||(ViewModel={}));var ViewModel;!function(e){var t=function(t){function i(e,i){var n=t.call(this)||this;return n.skinName=View.MagicWeaponItem,n.uiGroup=e,n.onCallback=i,n.uiGroup.addChild(n),n}return __extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this)},i.prototype.setMWBuyData=function(){if(Model.WebValue.isTraditional?this.goodsName.text="神器":this.goodsName.text="神器",this.goodsName.top=15,Model.MagicWeaponService.isFull())this.goodsBtn.visible=!1,this.finishImage.visible=!0;else{this.goodsIcon.source=Model.WebValue.dataStModel.sysConfigModel.magicWeaponIcon,this.goodsDesOne.top=40,Model.WebValue.isTraditional?this.goodsDesOne.text="隨機激活一把新神兵":this.goodsDesOne.text="随机激活一把新神兵";var e=Model.PlayerLocalService.PlayerData.dy.jewel<Model.MagicWeaponService.BuyCost;this.goodsBtn.setMWBuy(Model.MagicWeaponService.BuyCost,e),this.goodsBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBuyMWEvent,this),this.bg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.createBuyPop,this)}},i.prototype.createBuyPop=function(){this.onCallback&&new e.MagicWeaponBuyDetailVM(Main.singleton,function(){})},i.prototype.onBuyMWEvent=function(){this.onCallback&&this.onCallback()},i.prototype.setMWData=function(e){if(!e||!e.st)return void alert("数据错误，请重新加载 ! ");if(this.mWData=e,this.goodsName.text=e.st.name,this.goodsIcon.source=e.Icon,this.goodsDesOne.text=e.st.descriptionFirst.replace("{}",e.effectFirst.toString()),this.goodsDesTwo.text=e.st.descriptionSecond.replace("{}",e.effectSecond.toString()),e.dy){var t=Model.PlayerLocalService.PlayerData.dy.jewel<e.upgradeCost;this.goodsBtn.setMWUnlock(e.upgradeCost,t),this.goodsBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onUpgradeMWEvent,this),this.goodsLevel.visible=!0,this.goodsLevel.text="Lv."+e.dy.level,this.bg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.createPop,this)}else this.goodsBtn.setMWLock(e.upgradeCost)},i.prototype.createPop=function(){if(this.onCallback){var t=new e.MagicWeaponDetailVM(Main.singleton,function(){});t.setMWData(this.mWData)}},i.prototype.onUpgradeMWEvent=function(){this.onCallback&&this.onCallback(this.mWData)},i}(eui.Component);e.MagicWeaponItemVM=t,__reflect(t.prototype,"ViewModel.MagicWeaponItemVM")}(ViewModel||(ViewModel={}));var ViewModel;!function(e){var t=function(e){function t(t,i,n){var o=e.call(this)||this;return o.skinName=View.MagicWeaponView,o.uiLayer=t,o.onCallBack=n,o.magicWeapon.source="magic_weapon_"+i,o.uiLayer.addChild(o),egret.Tween.get(o.mask_black).to({alpha:.7},700,egret.Ease.circIn),egret.Tween.get(o.window).to({y:0},700,egret.Ease.backOut),Model.WebServiceBase.isDebug&&console.log("fangchao: add magic weapon vm to ui layer !　"),o.magicCloseBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){egret.Tween.get(o.mask_black).to({alpha:0},700,egret.Ease.circIn),egret.Tween.get(o.window).to({y:-550},700,egret.Ease.backIn),setTimeout(function(){o.uiLayer.removeChild(o)},700)},o),o}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this)},t}(eui.Component);e.MagicWeaponVM=t,__reflect(t.prototype,"ViewModel.MagicWeaponVM")}(ViewModel||(ViewModel={}));var ViewModel;!function(e){var t;!function(e){e[e.Player=0]="Player",e[e.Opponent=1]="Opponent"}(t=e.Camp||(e.Camp={}));var i=function(t){function i(e,i){var n=t.call(this)||this;return n.cutFlag=!0,n.cheatFlag=!0,n.clickFrequence=0,n.friendFrameRate=0,n.commitFlag=0,n.skinName=View.MainGameView,n.uiLayer=e,n.onCallBack=i,n.uiLayer.addChildAt(n,0),n}return __extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this),Model.AudioService.Shared().PlayBGM("bgm-003_mp3"),this.initDragonBones(),this.initSceneInfo(),this.initPlayer(),this.initFriend(),this.initEnemy(),this.initCheatingDetection(),this.shockTool=new Model.ShockTools,this.clickBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickBtn,this)},i.prototype.initDragonBones=function(){egret.startTick(this.onTicker,this)},i.prototype.onTicker=function(e){this._time||(this._time=e);var t=e,i=t-this._time;return this._time=t,dragonBones.WorldClock.clock.advanceTime(i/1e3),!1},i.prototype.initCheatingDetection=function(){var e=this,t=egret.setInterval(function(){Model.MainLocalService.cheatingDetection(e.clickFrequence)&&(e.cheatFlag=!1,egret.clearInterval(t)),e.clickFrequence=0},this,1e3)},i.prototype.initSceneInfo=function(){this.changeScene()},i.prototype.initPlayer=function(){this.initPlayerIdle()},i.prototype.initFriend=function(){var e=this,t=Model.FriendLocalService.FriendList;Enumerable.From(t).Select(function(t){return null!=t.dy?(e.switchFriend(t),t):void 0}).ToArray();this.onDpsEvent()},i.prototype.initEnemy=function(){this.enemyDB=new Model.DragonBones(this.enemyGroup,Model.MonsterLocalService.MonsterList[Model.SceneLocalService.SceneData.currentMonster].DBJson,Model.MonsterLocalService.MonsterList[Model.SceneLocalService.SceneData.currentMonster].DBPngJson,Model.MonsterLocalService.MonsterList[Model.SceneLocalService.SceneData.currentMonster].DBPng,Model.MonsterLocalService.MonsterList[Model.SceneLocalService.SceneData.currentMonster].st.dragonBones,640,360),this.enemyDB.play(Model.MonsterLocalService.MonsterList[Model.SceneLocalService.SceneData.currentMonster].Idle,0)},i.prototype.onClickBtn=function(e){this.clickFrequence++,this.clickEffect(e),this.guanyuGroup.numChildren>1&&this.guanyuGroup.removeChildAt(1),this.initPlayerAttack(),Model.AudioService.Shared().PlaySound(Model.PlayerLocalService.PlayerData.st.playerAttackAudio),this.cutHp(!0)},i.prototype.cutHp=function(e){var t=this;void 0===e&&(e=!1),this.cutFlag&&this.cheatFlag&&this.cutHpAnim(e,function(e){Model.PlayerLocalService.PlayerData.isChallenge?(Model.ChallengeLoaclService.challengeBossData.AddHp=-e,t.sceneInfo.setChallengeBoss(),Model.ChallengeLoaclService.challengeBossData.hp<=0&&t.enemyKilled(function(){Model.ChallengeLoaclService.successBack(Model.ChallengeLoaclService.challengeBossData)})):(Model.MonsterLocalService.MonsterList[Model.SceneLocalService.SceneData.currentMonster].AddHp=-e,t.sceneInfo.setMonsterHp(),Model.MonsterLocalService.MonsterList[Model.SceneLocalService.SceneData.currentMonster].hp<=0?t.enemyKilled(function(){Model.MonsterLocalService.MonsterList[Model.SceneLocalService.SceneData.currentMonster].MonsterType==Model.MonsterType.MONSTER_TYPE_BOSS?(t.sceneInfo.bossDeathEvent(),Model.SceneLocalService.setNextSceneData(),t.sceneInfo.setSceneIndex(),t.changeScene(),Model.MonsterLocalService.setMonsterData(),Model.PlayerLocalService.PlayerData.protectFriend||Model.FriendLocalService.sealFriendAndSkills()):Model.SceneLocalService.SceneData.currentMonster++}):Model.WebServiceBase.isDebug&&console.log("zhujun: monster have been alive ! "))})},i.prototype.changeScene=function(){if(Model.SceneLocalService.SceneData.st.sceneName)var t=new e.ScrollMsgVM(this.uiLayer,function(e){e.removeChild(t)},Model.SceneLocalService.SceneData.st.sceneName);if(Model.SceneLocalService.SceneData.st.scenePic)this.bg.source=Model.SceneLocalService.SceneData.st.scenePic;else{var i=Math.ceil(Model.SceneLocalService.SceneData.st.id/5);this.bg.source="scene_pic_"+i}},i.prototype.cutHpAnim=function(t,i){var n=new e.CutHpItemVM(this),o=Model.Mathf.random(0,100),r=0;if(t){if(o<=Model.PlayerLocalService.PlayerData.CritRate){n.y=230,r=Model.PlayerLocalService.PlayerData.CritDamage;var a=Model.MainLocalService.toUnitConversion(Number(r));Model.PlayerLocalService.setPerSecondTapDamage(Number(r)),n.setCriticalAttack(a,r),this.shockTool.shock(this,3)}else{n.y=300,r=Model.PlayerLocalService.PlayerData.dy.clickDamage;var a=Model.MainLocalService.toUnitConversion(Number(r));Model.PlayerLocalService.setPerSecondTapDamage(Number(r)),n.setNoramlAttack(a,r)}n.x=480-n.width/2}else n.y=300,r=Model.PlayerLocalService.PlayerData.dy.friendDamage;i(r)},i.prototype.clickEffect=function(e){var t=this;this.tapEffect.x=e.stageX-this.tapEffect.width/2,this.tapEffect.y=e.stageY-this.tapEffect.height/2,this.tapEffect.visible=!0,egret.setTimeout(function(){t.tapEffect.visible=!1},this,80)},i.prototype.onDpsEvent=function(){var e=this;this.cutHp(!1),egret.setTimeout(function(){e.onDpsEvent()},this,1e3-Model.PlayerLocalService.PlayerData.friendFrameRate)},i.prototype.initPlayerIdle=function(){this.playerDB=new Model.DragonBones(this.guanyuGroup,Model.PlayerLocalService.PlayerData.DBJson,Model.PlayerLocalService.PlayerData.DBPngJson,Model.PlayerLocalService.PlayerData.DBPng,Model.PlayerLocalService.PlayerData.st.playerDragonBones,640,360),this.playerDB.play(Model.PlayerLocalService.PlayerData.PlayerIdle,0)},i.prototype.initPlayerAttack=function(){var e=this;this.onAttackAnim(this.playerDB,Model.PlayerLocalService.PlayerData.PlayerAttack,function(){e.playerDB.play(Model.PlayerLocalService.PlayerData.PlayerIdle,0)})},i.prototype.switchFriend=function(t){switch(t.dy.friendId){case 1:var i=new e.HeroItemVM(this.baiheGroup);this.friendAnimal(i,this.baiheGroup,t);break;case 7:var n=new e.HeroItemVM(this.bingyiGroup);this.friendAnimal(n,this.bingyiGroup,t);break;case 13:var o=new e.HeroItemVM(this.xupingjunGroup);this.friendAnimal(o,this.xupingjunGroup,t);break;case 19:var r=new e.HeroItemVM(this.mengjueGroup);this.friendAnimal(r,this.mengjueGroup,t);break;case 25:var a=new e.HeroItemVM(this.liufulingGroup);this.friendAnimal(a,this.liufulingGroup,t)}},i.prototype.friendAnimal=function(e,t,i){return i.dy.sealCD>0?t.visible=!1:t.visible=!0,t.numChildren>0?void(Model.WebServiceBase.isDebug&&console.log("zhujun: 大于0则是更新挚友，挚友挚友更新的时候才存在现实隐藏 ! ")):(e.initMovieClip(i.IdleJson,i.IdlePng,i.st.idle),void egret.setInterval(function(){Model.AudioService.Shared().PlaySound(i.st.attackAudio)},this,Model.Mathf.random(1e3*Model.PlayerLocalService.PlayerData.st.effectTimeMin,1e3*Model.PlayerLocalService.PlayerData.st.effectTimeMax)))},i.prototype.onAttackAnim=function(e,t,i){void 0===i&&(i=null),e.play(t,1,i)},i.prototype.onAttackEffect=function(e,t,i){Model.WebServiceBase.isDebug&&console.log("zhujun: on attack effect start !  "+JSON.stringify(t))},i.prototype.changeEnemy=function(e){Model.WebServiceBase.isDebug&&console.log("zhujun: change Enemy "+e),this.enemyDB.changeArmature(Model.MonsterLocalService.MonsterList[e].DBJson,Model.MonsterLocalService.MonsterList[e].DBPngJson,Model.MonsterLocalService.MonsterList[e].DBPng,Model.MonsterLocalService.MonsterList[e].st.dragonBones),this.enemyDB.play(Model.MonsterLocalService.MonsterList[e].Idle)},i.prototype.goldDrop=function(){var e=Model.MonsterLocalService.MonsterList[Model.SceneLocalService.SceneData.currentMonster].dropMoney,t=Model.MonsterLocalService.MonsterList[Model.SceneLocalService.SceneData.currentMonster].DropMoneyAndUnit;this.goldAnimel(e,t)},i.prototype.jewelDrop=function(){if(Model.MonsterLocalService.MonsterList[Model.SceneLocalService.SceneData.currentMonster].MonsterType==Model.MonsterType.MONSTER_TYPE_BOSS){var e=Model.Mathf.random(0,1e4);e<Model.PlayerLocalService.PlayerData.st.bossDropJewelProbability&&this.jewelAnimel(Model.PlayerLocalService.PlayerData.st.bossDropJewelCount,Model.PlayerLocalService.PlayerData.st.bossDropJewelCount+"")}},i.prototype.enemyKilled=function(e){var t=this;this.achievement(),Model.WebServiceBase.isDebug&&console.log("zhujun: enemy killed ! "),this.cutFlag=!1,this.goldDrop(),this.jewelDrop(),e(),Model.MonsterLocalService.MonsterList[Model.SceneLocalService.SceneData.currentMonster].MonsterType==Model.MonsterType.MONSTER_TYPE_BOSS?(this.sceneInfo.swardIcon.visible=!1,this.sceneInfo.bossInfoGroup.visible=!0,this.sceneInfo.countTimeImage.visible=!0,this.sceneInfo.countTimeLabel.visible=!0,this.sceneInfo.bossBtn.currentState="down",this.sceneInfo.setCountDown(function(){Model.WebServiceBase.isDebug&&console.log("zhujun: boss倒计时结束,进入刷怪模式 ! "),Model.MonsterLocalService.setFarmMonsterData(),Model.SceneLocalService.SceneData.currentMonster=0,t.changeEnemy(Model.SceneLocalService.SceneData.currentMonster),t.sceneInfo.setMonsterHp(),Model.WebService.commitData(Model.WebValue.dataDyModel,function(){Model.WebServiceBase.isDebug&&console.log("cai_haotian: commitAuto success ! "+JSON.stringify(Model.WebValue.dataDyModel))},function(){Model.WebValue.isTraditional?alert("數據提交失敗請聯繫管理員！！！！"):alert("数据提交失败请联系管理员！！！！")})})):Model.SceneLocalService.SceneData.currentMonster==Model.SceneLocalService.SceneData.monsterCount-1?(Model.MonsterLocalService.setFarmMonsterData(),Model.SceneLocalService.SceneData.currentMonster=0):Model.WebServiceBase.isDebug&&console.log("zhujun: 这边进入了循环战斗,UI应该不变,等点击按钮时,修改数据,切换回挑战boss ! "),this.sceneInfo.setMonsterHp(),this.changeEnemy(Model.SceneLocalService.SceneData.currentMonster),this.sceneInfo.setMonsterIndex(),this.cutFlag=!0,this.commitAuto()},i.prototype.enemyHit=function(){var t=this;console.log("zhujun： enemy Hit "+Model.SceneLocalService.SceneData.currentMonster),this.enemyDB.play(Model.MonsterLocalService.MonsterList[Model.SceneLocalService.SceneData.currentMonster].Hit,1,function(){t.changeEnemy(Model.SceneLocalService.SceneData.currentMonster)});var i=new e.HeroItemVM(this.levelUpLight),n=i.initMovieClip("Tx_shouji_json","Tx_shouji_png","Tx_shouji",1,function(){t.levelUpLight.removeChild(n)})},i.prototype.goldAnimel=function(e,t){for(var i=this,n=Model.Mathf.random(1,5),o=0;n>o;o++){var r=new eui.Image;r.source="icon_yinbi_png",r.x=500,r.y=300;var a=Model.Mathf.random(0,600),l=a+Model.Mathf.random(-100,100),s=new Model.Vector2(300,300),c=new Model.Vector2(a,Model.Mathf.random(530,550)),d=new Model.Vector2(225,155),u=new Model.TweenCustom(r,this.goldAndTextGroup,s,c,d);u.sAnimTime=Model.Mathf.random(1200,1400),u.bezierP1X=l;var h=function(n){n.obj.touchEnabled=!1,i.addHpText(n,t),n.GoldRecycleAnim(function(){i.sceneInfo.goldAnimelStart(),Model.PlayerLocalService.PlayerData.AddGold=e,Model.AchievementLocalService.setCurrentGet(Model.AchievementType.ACHIEVEMENT_TYPE_GET_COIN,e)})};u.GoldProductionAnim(function(e){var t=egret.setTimeout(function(){h(e),egret.clearTimeout(t)},i,e.goldWaitTime);e.obj.once(egret.TouchEvent.TOUCH_TAP,function(){h(e),egret.clearTimeout(t)},i)})}},i.prototype.addHpText=function(e,t){var i=new eui.BitmapLabel;i.font=RES.getRes("gold-font_fnt"),i.text=t,i.x=e.ePos.x-i.textWidth/2,i.y=e.ePos.y-e.obj.height,Main.singleton.mainMenuVM.addChild(i),egret.Tween.get(i).to({y:350,alpha:0},1200).call(function(){Main.singleton.mainMenuVM.removeChild(i)})},i.prototype.jewelAnimel=function(e,t){var i=this,n=new eui.Image;n.source="icon_lingshi",n.width=23,n.height=23,n.x=500,n.y=300,Main.singleton.mainMenuVM.addChild(n);var o=Model.Mathf.random(0,600),r=o+Model.Mathf.random(-100,100),a=new Model.Vector2(300,300),l=new Model.Vector2(o,Model.Mathf.random(530,550)),s=new Model.Vector2(266,387),c=new Model.TweenCustom(n,this.goldAndTextGroup,a,l,s);c.sAnimTime=Model.Mathf.random(1200,1400),c.bezierP1X=r;var d=function(n){n.obj.touchEnabled=!1,i.addJewelText(n,t),n.GoldRecycleAnim(function(){Model.PlayerLocalService.PlayerData.AddJewel=Number(e),Model.AchievementLocalService.setCurrentGet(Model.AchievementType.ACHIEVEMENT_TYPE_GET_JEWEL,Number(e))})};c.GoldProductionAnim(function(e){var t=egret.setTimeout(function(){d(e),egret.clearTimeout(t)},i,e.goldWaitTime);e.obj.once(egret.TouchEvent.TOUCH_TAP,function(){d(e),egret.clearTimeout(t)},i)})},i.prototype.addJewelText=function(e,t){var i=new eui.BitmapLabel;i.font=RES.getRes("gold-font_fnt"),i.text=t,i.x=e.ePos.x-i.textWidth/2,i.y=e.ePos.y-e.obj.height,Main.singleton.mainMenuVM.addChild(i),egret.Tween.get(i).to({y:350,alpha:0},1200).call(function(){Main.singleton.mainMenuVM.removeChild(i)})},i.prototype.commitAuto=function(){this.commitFlag++,10==this.commitFlag&&(this.commitFlag=0,Model.WebService.commitData(Model.WebValue.dataDyModel,function(){Model.WebServiceBase.isDebug&&console.log("cai_haotian: commitAuto success ! "+JSON.stringify(Model.WebValue.dataDyModel))},function(){Model.WebValue.isTraditional?alert("數據提交失敗請聯繫管理員！！！！"):alert("数据提交失败请联系管理员！！！！")}))},i.prototype.achievement=function(){switch(Model.AchievementLocalService.setCurrentGet(Model.AchievementType.ACHIEVEMENT_TYPE_KILL_ENEMY,1),Model.MonsterLocalService.MonsterList[Model.SceneLocalService.SceneData.currentMonster].MonsterType){case Model.MonsterType.MONSTER_TYPE_BOSS:Model.AchievementLocalService.setCurrentGet(Model.AchievementType.ACHIEVEMENT_TYPE_KILL_BOSS,1);break;case Model.MonsterType.MONSTER_TYPE_BOX:Model.AchievementLocalService.setCurrentGet(Model.AchievementType.ACHIEVEMENT_TYPE_GET_BOX,1);break;case Model.MonsterType.MONSTER_TYPE_PERSON:break;default:alert("怪物类型出错！请联系管理员！c")}},i}(eui.Component);e.MainGameVM=i,__reflect(i.prototype,"ViewModel.MainGameVM")}(ViewModel||(ViewModel={}));var ViewModel;!function(e){var t=function(t){function i(e,i){var n=t.call(this)||this;return n.mData=null,n.skinName=View.MainInfoView,n.uiLayer=e,n.onCallBack=i,n}return __extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.initMainInfo()},i.prototype.initMainInfo=function(){this.tapDps.text=Model.PlayerLocalService.PlayerData.ClickDamageAndUnit,this.friendDps.text=Model.PlayerLocalService.PlayerData.FriendDamageAndUnit,this.currentDps.text=Model.PlayerLocalService.PlayerData.CurrentDpsAndUnit;var e=Model.PlayerSkillLocalService.PlayerSkillList;this.setSkillItem(e)},i.prototype.setCurrentDps=function(e){this.currentDps.text=e},i.prototype.setTapDamage=function(e){this.tapDps.text=e},i.prototype.setFriendDps=function(e){this.friendDps.text=e},i.prototype.setSkillItem=function(e){for(var t,i=this,n=0;n<e.length;n++)t=this.skillGroup.getChildAt(n),"during"!=t.currentState&&"disabled"!=t.currentState&&(t.onCallBack=function(e,t){Model.WebService.ReleaseSkillCD(e.st.id,function(){Model.WebServiceBase.isDebug&&console.log("cai_haotian releaseSkill Success!!!!!"),"disabled"==t.currentState&&0!=e.dy.cdTime?i.resetCD(e,t):"enabled"==t.currentState&&i.skillAnimel(e,t)},function(){Model.WebValue.isTraditional?alert("釋放技能失敗！請聯繫管理員"):alert("释放技能失败！请联系管理员！"),Model.WebServiceBase.isDebug&&console.log("cai_haotian releaseSkill failed!!!!!!")})}),t.initSkill(e[n])},i.prototype.skillAnimel=function(t,i,n,o){var r=this;void 0===n&&(n=!0);var a,l,s,c=n?t.continueTime:15,d=function(){Main.singleton.mainGameVM.enemyHit()};switch(n?(i.touchEnabled=!1,i.currentState="during",i.counterCD.text=Model.PlayerSkillLocalService.timeDes(c)):(i.touchEnabled=!1,"enabled"==i.currentState&&(i.currentState="disabled",egret.setTimeout(function(){i.currentState="enabled"},this,c)),o&&o(t,c)),t.st.id){case 1:egret.setTimeout(function(){l=new e.HeroItemVM(Main.singleton.mainGameVM.yungeFrontSkill),a=l.initMovieClip("Tx_zhujue_0"+t.st.id+"_json","Tx_zhujue_0"+t.st.id+"_png","Tx_zhujue_0"+t.st.id,1,function(){Main.singleton.mainGameVM.yungeFrontSkill.removeChild(l.movieClip)}),c=0,Model.AudioService.Shared().PlaySound("YX-007_mp3"),Model.PlayerSkillLocalService.PlayerSkillEffect(t,function(){Main.singleton.mainGameVM.cutHp(!0)},n)},this,1e3*c),n&&Model.AchievementLocalService.setCurrentGet(Model.AchievementType.ACHIEVEMENT_TYPE_USE_SKILL1,1);break;case 2:l=new e.HeroItemVM(Main.singleton.mainGameVM.yungeFrontSkill),a=l.initMovieClip("Tx_zhujue_0"+t.st.id+"_json","Tx_zhujue_0"+t.st.id+"_png","Tx_zhujue_0"+t.st.id,-1,function(){}),a.addEventListener(egret.Event.LOOP_COMPLETE,d,this),n&&Model.AchievementLocalService.setCurrentGet(Model.AchievementType.ACHIEVEMENT_TYPE_USE_SKILL2,1),Model.PlayerSkillLocalService.PlayerSkillEffect(t,function(){Main.singleton.mainGameVM.cutHp(!0)},n);break;case 3:var u=new Model.Particles(Main.singleton.mainGameVM.yungeFrontSkill,"Tx_zhujue_03_particle_png","Tx_zhujue_03_particle_json"),h=u.setParticlesPos(272,280);h.start(),n&&Model.AchievementLocalService.setCurrentGet(Model.AchievementType.ACHIEVEMENT_TYPE_USE_SKILL3,1),Model.PlayerSkillLocalService.PlayerSkillEffect(t,function(){},n);break;case 4:l=new e.HeroItemVM(Main.singleton.mainGameVM.yungeSkill0),a=l.initMovieClip("Tx_zhujue_04_json","Tx_zhujue_04_png","Tx_zhujue_04",-1,function(){}),n&&Model.AchievementLocalService.setCurrentGet(Model.AchievementType.ACHIEVEMENT_TYPE_USE_SKILL4,1),Model.PlayerSkillLocalService.PlayerSkillEffect(t,function(){},n);break;case 5:this.bufferAnimel(Main.singleton.mainGameVM.yungeFrontSkill,function(){}),n&&Model.AchievementLocalService.setCurrentGet(Model.AchievementType.ACHIEVEMENT_TYPE_USE_SKILL5,1),Model.PlayerSkillLocalService.PlayerSkillEffect(t,function(){},n);break;case 6:var u=new Model.Particles(Main.singleton.mainGameVM.yungeFrontSkill,"Tx_zhujue_06_2_png","Tx_zhujue_06_2_json"),h=u.setParticlesPos(272,142);n&&Model.AchievementLocalService.setCurrentGet(Model.AchievementType.ACHIEVEMENT_TYPE_USE_SKILL6,1),Model.PlayerSkillLocalService.PlayerSkillEffect(t,function(e,t){Main.singleton.mainGameVM.goldAnimel(e,t)},n);break;default:alert("主角技能使用出错！请联系管理员！！")}var p=egret.setInterval(function(){if(c--,n&&(i.counterCD.text=Model.PlayerSkillLocalService.timeDes(c)),o&&o(t,c),0>=c){switch(egret.clearInterval(p),i.touchEnabled=!0,t.st.id){case 1:break;case 2:Main.singleton.mainGameVM.yungeFrontSkill.removeChild(a),a.removeEventListener(egret.Event.LOOP_COMPLETE,d,r);break;case 3:Main.singleton.mainGameVM.yungeFrontSkill.removeChild(s.display),Main.singleton.mainGameVM.yungeFrontSkill.removeChild(h);break;case 4:Main.singleton.mainGameVM.yungeSkill0.removeChild(a);break;case 5:Main.singleton.mainGameVM.yungeSkill0.removeChild(s.display);break;case 6:Main.singleton.mainGameVM.yungeFrontSkill.removeChild(h);break;default:alert("主角技能使用出错！请联系管理员！！")}n&&(i.currentState="disabled",i.initSkillCD(t))}},this,1e3)},i.prototype.bufferAnimel=function(e,t){},i.prototype.resetCD=function(t,i){var n=this;new e.ResetSkillVM(Main.singleton,t,function(e){Model.PlayerSkillLocalService.reduceCD(e,function(){n.initMainInfo(),egret.clearInterval(i.cd)})})},i}(eui.Component);e.MainInfoVM=t,__reflect(t.prototype,"ViewModel.MainInfoVM")}(ViewModel||(ViewModel={}));var ViewModel;!function(e){var t=function(t){function i(e,i,n){var o=t.call(this)||this;return o.skinName=View.MainMenuView,o.uiLayer=e,o.onCallBack=i,o.addEventListener(eui.UIEvent.COMPLETE,o.onComplete,o),o.uiLayer.addChildAt(o,1),Model.WebServiceBase.isDebug&&console.log("zhujun: add main menu vm to ui layer !　"),o}return __extends(i,t),i.prototype.onComplete=function(){Model.WebServiceBase.isDebug&&console.log("onComplete")},i.prototype.createChildren=function(){t.prototype.createChildren.call(this)},i.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.initMenuPopup(),this.initBtnTop(),this.initBtnBottomEvent(),this.initBtnBottomGroupUI()},i.prototype.initBtnTop=function(){this.btnTop.btnSetting.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){new e.SettingsVM(Main.singleton,function(){})},this),this.btnTop.btnAchievement.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){new e.AchievementVM(Main.singleton,function(){})},this)},i.prototype.initMenuPopup=function(){this.menuPopupGroup.visible=!1},i.prototype.initBtnBottomEvent=function(){var e=this;this.btnBottom.btnSkill.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){Model.WebService.commitData(Model.WebValue.dataDyModel,function(){Model.WebServiceBase.isDebug&&console.log("cai_haotian: commitAuto success ! "+JSON.stringify(Model.WebValue.dataDyModel))},function(){Model.WebValue.isTraditional?alert("數據提交失敗請聯繫管理員！！！！"):alert("数据提交失败请联系管理员！！！！")}),e.menuPopupGroup.visible=!1,e.currentPage=PageName.MainInfo},this),this.btnBottom.btnProtagonist.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.menuPopupGroup.visible=!0,e.menuPopup.setPData(),e.currentPage=PageName.Player},this),this.btnBottom.btnBosomFriend.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.menuPopupGroup.visible=!0,e.menuPopup.setBFData(),e.currentPage=PageName.Friend},this),this.btnBottom.btnArtifact.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.menuPopupGroup.visible=!0,e.menuPopup.setAData(),e.currentPage=PageName.MagicWeapon},this),this.btnBottom.btnMall.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.menuPopupGroup.visible=!0,e.menuPopup.setMData(),e.currentPage=PageName.Mall},this)},i.prototype.initBtnBottomGroupUI=function(){this.btnBottomGroup=[this.btnBottom.btnProtagonist,this.btnBottom.btnBosomFriend,this.btnBottom.btnArtifact,this.btnBottom.btnMall],this.btnBottom.btnSkill.addEventListener(egret.TouchEvent.TOUCH_TAP,this.btnBottomChange,this),this.btnBottom.btnProtagonist.addEventListener(egret.TouchEvent.TOUCH_TAP,this.btnBottomChange,this),this.btnBottom.btnBosomFriend.addEventListener(egret.TouchEvent.TOUCH_TAP,this.btnBottomChange,this),this.btnBottom.btnArtifact.addEventListener(egret.TouchEvent.TOUCH_TAP,this.btnBottomChange,this),this.btnBottom.btnMall.addEventListener(egret.TouchEvent.TOUCH_TAP,this.btnBottomChange,this),this.btnBottom.btnSkill.currentState="down",this.btnBottom.btnProtagonist.btnNewMark.visible=!1,this.btnBottom.btnBosomFriend.btnNewMark.visible=!1,this.btnBottom.btnArtifact.btnNewMark.visible=!1,this.btnBottom.btnMall.btnNewMark.visible=!1},i.prototype.btnBottomChange=function(e){e.target==this.btnBottom.btnSkill?(this.btnBottom.btnSkill.currentState="down",this.btnBottom.btnSkill.enabled=!1):(this.btnBottom.btnSkill.currentState="up",this.btnBottom.btnSkill.enabled=!0);for(var t=0;t<this.btnBottomGroup.length;t++)e.target==this.btnBottomGroup[t]?(this.btnBottomGroup[t].currentState="down",this.btnBottomGroup[t].enabled=!1,this.btnBottomGroup[t].btnWordImage.source=this.btnBottomGroup[t].btnWordSourceDown):(this.btnBottomGroup[t].currentState="up",this.btnBottomGroup[t].enabled=!0,this.btnBottomGroup[t].btnWordImage.source=this.btnBottomGroup[t].btnWordSource)},i.prototype.refreshMenu=function(){switch(this.currentPage){case PageName.Player:this.menuPopup.setPData();break;case PageName.Friend:this.menuPopup.setBFData();break;case PageName.MagicWeapon:this.menuPopup.setAData();break;case PageName.Mall:this.menuPopup.setMData()}},i}(eui.Component);e.MainMenuVM=t,__reflect(t.prototype,"ViewModel.MainMenuVM")}(ViewModel||(ViewModel={}));var ViewModel;!function(e){var t=function(t){function i(e,i){var n=t.call(this)||this;return n.pSItems=[],n.fItems=[],n.mWItems=[],n.sItems=[],n.skinName=View.MenuPopup,n.uiLayer=i,n.onCallBack=e,i&&n.uiLayer.addChild(n),Model.WebServiceBase.isDebug&&console.log("zhujun: add main popup vm to ui layer !　"),n}return __extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this)
},i.prototype.setPData=function(){var t=this;Main.singleton.mainMenuVM.mainInfo.initMainInfo(),this.protagonistPopGroup.visible=!0,this.bosomFriendPopGroup.visible=!1,this.artifactPopGroup.visible=!1,this.shopPopGroup.visible=!1;var i=Model.PlayerLocalService.PlayerData,n=Model.PlayerSkillLocalService.PlayerSkillList;if(this.clickDamageLabel.text=i.ClickDamageAndUnit,0==this.protagonistGroup.numChildren){this.pItem=new e.CharItemVM(this.protagonistGroup,function(e,i){Model.AudioService.Shared().PlaySound("YX-004_mp3"),Model.PlayerLocalService.upgradeSuccessedCallBack(e,i),t.setPData(),Model.WebServiceBase.isDebug&&console.log("zhujun: main player create finish ! ")});for(var o=0;o<n.length;o++){var r=new e.CharItemVM(this.protagonistGroup,function(e,i){Model.AudioService.Shared().PlaySound("YX-004_mp3"),Model.PlayerSkillLocalService.upgradeSuccessedCallBack(e,i),t.setPData(),Model.WebServiceBase.isDebug&&console.log("zhujun: main player skill upgrade finish ! ")});r.setPSData(n[o]),this.pSItems.push(r)}}else for(var o=0;o<n.length;o++){var a=Model.PlayerLocalService.PlayerData.dy.level>=n[o].st.openLevel;a&&!n[o].dy&&Model.PlayerSkillLocalService.unlockSuccessedCallBack(n[o]),this.pSItems[o].setPSData(n[o])}this.pItem.setPData(i)},i.prototype.setBFData=function(){var t=this;Main.singleton.mainMenuVM.mainInfo.initMainInfo(),this.protagonistPopGroup.visible=!1,this.bosomFriendPopGroup.visible=!0,this.artifactPopGroup.visible=!1,this.shopPopGroup.visible=!1;var i=Model.FriendLocalService.FriendList;if(this.dpsLabel.text=Model.PlayerLocalService.PlayerData.FriendDamageAndUnit,Model.AchievementLocalService.setCurrentGet(Model.AchievementType.ACHIEVEMENT_TYPE_FRIEND_DAMAGE,Model.PlayerLocalService.PlayerData.dy.friendDamage),0==this.bosomFriendGroup.numChildren)for(var n=0;n<i.length;n++){if(Model.FriendLocalService.isShow(i[n],i),Enumerable.From(i).Where(function(e){return null==e.dy}).Select(function(e){return e.reachRecruit}).FirstOrDefault(null)?Main.singleton.mainMenuVM.btnBottom.btnBosomFriend.btnNewMark.visible=!0:Main.singleton.mainMenuVM.btnBottom.btnBosomFriend.btnNewMark.visible=!1,i[n].dy)if(i[n].dy.layerId<i[n].layerMatchLevel)var o=new e.CharItemVM(this.bosomFriendGroup,function(i){if(0==i.dy.sealCD)Model.FriendLocalService.layerSuccessedCallBack(i),t.setBFData(),Model.WebServiceBase.isDebug&&console.log("zhujun: friend and skill "+i.st.id+" layer successed ! ");else{var n=new e.KilledViewVM(Main.singleton,function(i){Model.PlayerLocalService.isEnoughSycee(i.sealCDMoney)?(Model.FriendLocalService.removeSealCD(i),t.setBFData()):new e.LackGoldVM(Main.singleton,function(){Main.singleton.removeChild(n)})});n.setFDataInfo(i)}});else var o=new e.CharItemVM(this.bosomFriendGroup,function(i,n){if(0==i.dy.sealCD)Model.AudioService.Shared().PlaySound("YX-004_mp3"),Model.FriendLocalService.upgradeSuccessedCallBack(i,n),t.setBFData(),Model.WebServiceBase.isDebug&&console.log("zhujun: friend and skill "+i.st.id+" upgrade successed ! ");else{var o=new e.KilledViewVM(Main.singleton,function(i){Model.PlayerLocalService.isEnoughSycee(i.sealCDMoney)?(Model.FriendLocalService.removeSealCD(i),t.setBFData()):new e.LackGoldVM(Main.singleton,function(){Main.singleton.removeChild(o)})});o.setFDataInfo(i)}});else var o=new e.CharItemVM(this.bosomFriendGroup,function(i){i.RecruitMoneyType==Model.MoneyType.MONEY_TYPE_YB?i.IsEnoughRecruit?(Model.FriendLocalService.buySuccessedCallBack(i),Main.singleton.mainGameVM.switchFriend(i),t.setBFData(),i.Type==Model.FriendType.FRIEND_TYPE_FRIEND&&Model.AchievementLocalService.setCurrentGet(Model.AchievementType.ACHIEVEMENT_TYPE_GET_FRIEND,1),Model.WebServiceBase.isDebug&&console.log("zhujun: friend and skill "+i.st.id+" add finish ! "),Model.WebService.commitData(Model.WebValue.dataDyModel,function(){Model.WebServiceBase.isDebug&&console.log("cai_haotian: commitAuto success ! "+JSON.stringify(Model.WebValue.dataDyModel))},function(){Model.WebValue.isTraditional?alert("數據提交失敗請聯繫管理員！！！！"):alert("数据提交失败请联系管理员！！！！")})):new e.LackGoldVM(Main.singleton,function(){}):(Model.FriendLocalService.buySuccessedCallBack(i),Main.singleton.mainGameVM.switchFriend(i),t.setBFData(),i.Type==Model.FriendType.FRIEND_TYPE_FRIEND&&Model.AchievementLocalService.setCurrentGet(Model.AchievementType.ACHIEVEMENT_TYPE_GET_FRIEND,1),Model.WebServiceBase.isDebug&&console.log("zhujun: friend and skill "+i.st.id+" add finish ! "))});o.setBFData(i[n]),this.fItems.push(o)}else for(var n=0;n<i.length;n++)Model.FriendLocalService.isShow(i[n],i),Enumerable.From(i).Where(function(e){return null==e.dy}).Select(function(e){return e.reachRecruit}).FirstOrDefault(null)?Main.singleton.mainMenuVM.btnBottom.btnBosomFriend.btnNewMark.visible=!0:Main.singleton.mainMenuVM.btnBottom.btnBosomFriend.btnNewMark.visible=!1,i[n].dy?i[n].dy.layerId<i[n].layerMatchLevel?this.fItems[n].onCallback=function(i){if(0==i.dy.sealCD)Model.FriendLocalService.layerSuccessedCallBack(i),t.setBFData(),Model.WebServiceBase.isDebug&&console.log("zhujun: friend and skill "+i.st.id+" layer successed ! ");else{var n=new e.KilledViewVM(Main.singleton,function(i){Model.PlayerLocalService.isEnoughSycee(i.sealCDMoney)?(Model.FriendLocalService.removeSealCD(i),t.setBFData()):new e.LackGoldVM(Main.singleton,function(){Main.singleton.removeChild(n)})});n.setFDataInfo(i)}}:this.fItems[n].onCallback=function(i,n){if(0==i.dy.sealCD)Model.AudioService.Shared().PlaySound("YX-004_mp3"),Model.FriendLocalService.upgradeSuccessedCallBack(i,n),t.setBFData(),Model.WebServiceBase.isDebug&&console.log("zhujun: friend and skill "+i.st.id+" upgrade successed ! ");else{var o=new e.KilledViewVM(Main.singleton,function(i){Model.PlayerLocalService.isEnoughSycee(i.sealCDMoney)?(Model.FriendLocalService.removeSealCD(i),t.setBFData()):new e.LackGoldVM(Main.singleton,function(){Main.singleton.removeChild(o)})});o.setFDataInfo(i)}}:this.fItems[n].onCallback=function(i){i.RecruitMoneyType==Model.MoneyType.MONEY_TYPE_YB?i.IsEnoughRecruit?(Model.FriendLocalService.buySuccessedCallBack(i),Main.singleton.mainGameVM.switchFriend(i),t.setBFData(),Model.WebServiceBase.isDebug&&console.log("zhujun: friend and skill "+i.st.id+" add finish ! "),i.Type==Model.FriendType.FRIEND_TYPE_FRIEND&&Model.AchievementLocalService.setCurrentGet(Model.AchievementType.ACHIEVEMENT_TYPE_GET_FRIEND,1)):new e.LackGoldVM(Main.singleton,function(){}):(Model.FriendLocalService.buySuccessedCallBack(i),Main.singleton.mainGameVM.switchFriend(i),t.setBFData(),Model.WebServiceBase.isDebug&&console.log("zhujun: friend and skill "+i.st.id+" add finish ! "),i.Type==Model.FriendType.FRIEND_TYPE_FRIEND&&Model.AchievementLocalService.setCurrentGet(Model.AchievementType.ACHIEVEMENT_TYPE_GET_FRIEND,1))},this.fItems[n].setBFData(i[n])},i.prototype.setAData=function(){var t=this;Main.singleton.mainMenuVM.mainInfo.initMainInfo(),this.protagonistPopGroup.visible=!1,this.bosomFriendPopGroup.visible=!1,this.artifactPopGroup.visible=!0,this.shopPopGroup.visible=!1;var i=Model.MagicWeaponService.MagicWeaponList;if(this.damageBonusLabel.text="+"+Model.MagicWeaponService.AddCommon.toString()+"%",0==this.artifactGroup.numChildren){this.mWBuyItem=new e.MagicWeaponItemVM(this.artifactGroup,function(){Model.MagicWeaponService.buySuccessedCallBack(),t.setAData(),Model.AchievementLocalService.setCurrentGet(Model.AchievementType.ACHIEVEMENT_TYPE_GET_MAGIC_WEAPON,1)});for(var n=0;n<i.length;n++){var o=new e.MagicWeaponItemVM(this.artifactGroup,function(e){Model.AudioService.Shared().PlaySound("YX-004_mp3"),Model.MagicWeaponService.upgradeSuccessedCallBack(e),t.setAData(),Model.WebServiceBase.isDebug&&console.log("zhujun: magic weapon "+e.dy.magicWeaponId+" add finish ! ")});o.setMWData(i[n]),this.mWItems.push(o)}}else for(var n=0;n<i.length;n++)this.mWItems[n].setMWData(i[n]);this.mWBuyItem.setMWBuyData()},i.prototype.setMData=function(t){var i=this;void 0===t&&(t=!1),this.protagonistPopGroup.visible=!1,this.bosomFriendPopGroup.visible=!1,this.artifactPopGroup.visible=!1,this.shopPopGroup.visible=!0,t&&(this.shopScroller.viewport.scrollV=510),this.treasureLabel.text=Model.PlayerLocalService.PlayerData.dy.treasure+"";var n=Model.ShopLocalService.ShopList;if(0==this.shopGroup.numChildren){this.sBuyItem=new e.ShopItemVM(this.shopGroup,function(){i.shopScroller.viewport.scrollV=474}),this.sBuyItem.setYBItem();for(var o=0;o<n.length;o++){var r=new e.ShopItemVM(this.shopGroup,function(t,n){Model.AudioService.Shared().PlaySound("YX-004_mp3"),t.Type==Model.ShopType.SHOP_TYPE_YB?Model.WebService.Recharge(function(e){Model.WebServiceBase.isDebug&&console.log("cai_haotian recharge success!!!!!");for(var t=0;t<e.shopList.length;t++)Model.PlayerLocalService.PlayerData.dy.treasure+=Number(e.shopList[t].cost),Model.PlayerLocalService.PlayerData.dy.treasure+=Number(e.shopList[t].extraGet);i.setMData(),Main.singleton.mainGameVM.sceneInfo.init()},function(){Model.WebValue.isTraditional?alert("充值失敗！"):alert("充值失败！")}):n?Model.ShopLocalService.commitShop(t,n,function(){i.setMData(),Main.singleton.mainGameVM.sceneInfo.init(),Model.WebService.commitData(Model.WebValue.dataDyModel,function(){Model.WebServiceBase.isDebug&&console.log("cai_haotian: commitAuto success ! "+JSON.stringify(Model.WebValue.dataDyModel))},function(){Model.WebValue.isTraditional?alert("數據提交失敗請聯繫管理員！！！！"):alert("数据提交失败请联系管理员！！！！")}),Model.PlayerLocalService.PlayerData.shopFlag=!0}):Model.PlayerLocalService.isEnoughSycee(t.st.cost,function(){})?Model.PlayerLocalService.PlayerData.shopFlag&&(Model.PlayerLocalService.PlayerData.shopFlag=!1,Model.ShopLocalService.commitShop(t,n,function(){i.setMData(),Main.singleton.mainGameVM.sceneInfo.init(),Model.WebService.commitData(Model.WebValue.dataDyModel,function(){Model.WebServiceBase.isDebug&&console.log("cai_haotian: commitAuto success ! "+JSON.stringify(Model.WebValue.dataDyModel))},function(e){alert(e),Model.WebValue.isTraditional?alert("數據提交失敗請聯繫管理員！！！！"):alert("数据提交失败请联系管理员！！！！")}),Model.PlayerLocalService.PlayerData.shopFlag=!0})):new e.LackGoldVM(Main.singleton,function(){})});r.setSData(n[o]),this.sItems.push(r)}}else for(var o=0;o<this.sItems.length;o++)this.sItems[o].setSData(n[o]);this.sBuyItem.setYBItem()},i}(eui.Component);e.MenuPopupVM=t,__reflect(t.prototype,"ViewModel.MenuPopupVM")}(ViewModel||(ViewModel={}));var ViewModel;!function(e){var t=function(e){function t(t,i){var n=e.call(this)||this;return n.skinName=View.OffLineRewardView,n.uiLayer=t,n.onCallBack=i,n.uiLayer.addChild(n),n}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.init(),this.setCount()},t.prototype.init=function(){var e=this;this.confirmBtn.setOffLineBtn(),this.confirmBtn.once(egret.TouchEvent.TOUCH_TAP,function(){e.uiLayer.removeChild(e)},this)},t.prototype.setCount=function(){this.rewardCount.text=Model.PlayerLocalService.PlayerData.OffLineMoney,Model.PlayerLocalService.PlayerData.AddGold=Model.PlayerLocalService.PlayerData.offLineMoney,Model.AchievementLocalService.setCurrentGet(Model.AchievementType.ACHIEVEMENT_TYPE_GET_COIN,Model.PlayerLocalService.PlayerData.offLineMoney)},t}(eui.Component);e.OffLineRewardVM=t,__reflect(t.prototype,"ViewModel.OffLineRewardVM")}(ViewModel||(ViewModel={}));var ViewModel;!function(e){var t=function(e){function t(t,i){var n=e.call(this)||this;return n.uiLayer=t,n.onCallBack=i,n.skinName=View.PartInRewardView,n.uiLayer.addChild(n),n}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.initWindow(),this.getReward()},t.prototype.initWindow=function(){var e=this;egret.Tween.get(this.mask_black_reward).to({alpha:.7},700,egret.Ease.circIn),egret.Tween.get(this.window).to({y:0},700,egret.Ease.backOut),this.LGCloseBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){egret.Tween.get(e.mask_black_reward).to({alpha:0},700,egret.Ease.circIn),egret.Tween.get(e.window).to({y:-500},700,egret.Ease.backIn),setTimeout(function(){e.uiLayer.removeChild(e)},700)},this),this.btnEarnReward.costIcon.visible=!1,this.btnEarnReward.costNum.visible=!1,Model.WebValue.isTraditional?this.btnEarnReward.description.text="領取獎勵":this.btnEarnReward.description.text="领取奖励",this.btnEarnReward.description.size=24},t.prototype.getReward=function(){var e=this;this.btnEarnReward.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.callBack()},this)},t.prototype.callBack=function(){this.onCallBack&&this.onCallBack(this.cdkey.text)},t}(eui.Component);e.PartInRewardVM=t,__reflect(t.prototype,"ViewModel.PartInRewardVM")}(ViewModel||(ViewModel={}));var ViewModel;!function(e){var t=function(e){function t(t,i){var n=e.call(this)||this;return n.skinName=View.PersnoalMsgView,n.uiLayer=t,n.onCallBack=i,n.uiLayer.addChild(n),n}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.initWindow(),this.initInfo()},t.prototype.initWindow=function(){var e=this;egret.Tween.get(this.maskBlackSettings).to({alpha:.7},700,egret.Ease.circIn),egret.Tween.get(this.window).to({y:0},700,egret.Ease.backOut),this.LGCloseBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){egret.Tween.get(e.maskBlackSettings).to({alpha:0},700,egret.Ease.circIn),egret.Tween.get(e.window).to({y:-550},700,egret.Ease.backIn).call(function(){e.uiLayer.removeChild(e)})},this)},t.prototype.initInfo=function(){this.allWeaponLevel.text=Model.PlayerLocalService.PlayerData.allFriendLevel+"",this.hitRate.text=Model.PlayerLocalService.PlayerData.CritRate+"%",this.secondAddition.text=Model.PlayerLocalService.PlayerData.allDamageAdd+"%",this.hitAddition.text=Model.PlayerLocalService.PlayerData.allCritdDamageAdd+"%",this.goldAddition.text=Model.PlayerLocalService.PlayerData.allGoldAdd+"%"},t}(eui.Component);e.PersonalMsgVM=t,__reflect(t.prototype,"ViewModel.PersonalMsgVM")}(ViewModel||(ViewModel={}));var ViewModel;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.skinName=View.ProgressHp,t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this)},t}(eui.ProgressBar);e.ProgressHp=t,__reflect(t.prototype,"ViewModel.ProgressHp")}(ViewModel||(ViewModel={}));var ViewModel;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.skinName=View.ProgressMineView,t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this)},t}(eui.ProgressBar);e.ProgressMineVM=t,__reflect(t.prototype,"ViewModel.ProgressMineVM")}(ViewModel||(ViewModel={}));var ViewModel;!function(e){var t=function(e){function t(t,i){var n=e.call(this)||this;return n.skinName=View.ReceiveRewardsView,n.uiLayer=t,n.onCallBack=i,n.uiLayer.addChild(n),n}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.initVM()},t.prototype.initVM=function(){var e=this;this.commitBtn.description.text=Model.WebValue.isTraditional?"確 定":"确 定",this.commitBtn.description.size=24,this.commitBtn.costIcon.visible=!1,this.commitBtn.costNum.visible=!1,this.commitBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.uiLayer.removeChild(e)},this),this.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.uiLayer.removeChild(e)},this)},t.prototype.rewardInfo=function(e){this.rewadCount.visible=!0,this.errorInfo.visible=!1;for(var t=0;t<e.modelList.length;t++){var i=this.changeReward(e.modelList[t]);switch(t){case 0:this.goods0.text=i;break;case 1:this.goods1.text=i;break;case 2:this.goods2.text=i;break;case 3:this.goods3.text=i;break;default:alert("奖励类型出错！")}}Model.WebService.commitData(Model.WebValue.dataDyModel,function(){Model.WebServiceBase.isDebug&&console.log("cai_haotian: commitAuto success ! "+JSON.stringify(Model.WebValue.dataDyModel))},function(){Model.WebValue.isTraditional?alert("數據提交失敗請聯繫管理員！！！！"):alert("数据提交失败请联系管理员！！！！")})},t.prototype.wrongInfo=function(e){switch(this.rewadCount.visible=!1,this.errorInfo.visible=!0,e.errorCode){case 610:Model.WebValue.isTraditional?this.errorInfo.text="對不起，該兌換碼不存在！":this.errorInfo.text="对不起，该兑换码不存在！";break;case 611:Model.WebValue.isTraditional?this.errorInfo.text="對不起，該兌換碼已使用過！":this.errorInfo.text="对不起，该兑换码已使用过！";break;case 612:Model.WebValue.isTraditional?this.errorInfo.text="對不起，該禮包不存在！":this.errorInfo.text="对不起，该礼包不存在！";break;case 613:Model.WebValue.isTraditional?this.errorInfo.text="對不起，該禮包為空！":this.errorInfo.text="对不起，该礼包为空！";break;case 614:Model.WebValue.isTraditional?this.errorInfo.text="對不起，您已經使用過了相同的兌換碼！":this.errorInfo.text="对不起，您已经使用过了相同的兑换码！";break;case 615:Model.WebValue.isTraditional?this.errorInfo.text="對不起，同一帳號，同一批次的兌換碼已經使用過了！":this.errorInfo.text="对不起，同一帐号，同一批次的兑换码已经使用过了！";break;case 616:Model.WebValue.isTraditional?this.errorInfo.text="對不起，您已經使用了同一禮包中的兌換碼！":this.errorInfo.text="对不起，您已经使用了同一礼包中的兑换码！";break;case 617:Model.WebValue.isTraditional?this.errorInfo.text="對不起，該兌換碼超過了有效日期！":this.errorInfo.text="对不起，该兑换码超过了有效日期！";break;case 618:Model.WebValue.isTraditional?this.errorInfo.text="對不起，該兌換碼不允許在該區使用！":this.errorInfo.text="对不起，该兑换码不允许在该区使用！";break;default:Model.WebValue.isTraditional?this.errorInfo.text="對不起，錯誤的兌換碼！":this.errorInfo.text="对不起，错误的兑换码！"}},t.prototype.changeReward=function(e){var t="";return"MONEY_TYPE_COIN"==e.type?(Model.PlayerLocalService.PlayerData.dy.gold+=e.count,t=Model.WebValue.isTraditional?"獲得"+e.count+"金幣":"获得"+e.count+"金币"):"MONEY_TYPE_YB"==e.type?(Model.PlayerLocalService.PlayerData.dy.treasure+=e.count,t=Model.WebValue.isTraditional?"獲得"+e.count+"元寶":"获得"+e.count+"元宝"):"MONEY_TYPE_JEWEL"==e.type&&(Model.PlayerLocalService.PlayerData.dy.jewel+=e.count,t=Model.WebValue.isTraditional?"獲得"+e.count+"靈石":"获得"+e.count+"灵石"),t},t}(eui.Component);e.ReceiveRewardsVM=t,__reflect(t.prototype,"ViewModel.ReceiveRewardsVM")}(ViewModel||(ViewModel={}));var ViewModel;!function(e){var t=function(e){function t(t,i,n){var o=e.call(this)||this;return o.skinName="View.ResetSkillView",o.uiGroup=t,o.skillData=i,o.onCallBack=n,o.uiGroup.addChild(o),o}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.initBtn(),this.setResetMoney(),this.confirm.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchEvent,this)},t.prototype.initBtn=function(){var e=this;this.confirm.costIcon.visible=!1,this.closeBtn.costIcon.visible=!1,this.confirm.costNum.visible=!1,this.closeBtn.costNum.visible=!1,this.confirm.description.text="是",this.closeBtn.description.text="否";var t=Model.PlayerLocalService.isEnoughSycee(this.skillData.st.removeCdCost);this.confirm.setReduceCD(t),this.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.uiGroup.removeChild(e)},this)},t.prototype.setResetMoney=function(){Model.WebValue.isTraditional?this.resetCost.text="妳想要花"+this.skillData.st.removeCdCost+"元寶重置此技能冷卻麼？":this.resetCost.text="你想要花"+this.skillData.st.removeCdCost+"元宝重置此技能冷却么？"},t.prototype.touchEvent=function(){this.onCallBack&&(this.onCallBack(this.skillData),this.uiGroup.removeChild(this))},t}(eui.Component);e.ResetSkillVM=t,__reflect(t.prototype,"ViewModel.ResetSkillVM")}(ViewModel||(ViewModel={}));var ViewModel;!function(e){var t=function(e){function t(t,i){var n=e.call(this)||this;return n.onTimeLeft=null,n.currentLeftTime=0,n.skinName=View.SceneInfoView,n.uiLayer=t,n}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.bossHp.labelDisplay.visible=!1,this.bossInfoGroup.visible=!1,this.init()},t.prototype.init=function(){this.setMoney(Model.PlayerLocalService.PlayerData.GoldAndUnit),this.setMonsterIndex(),this.setSceneIndex(),this.setMonsterHp(),this.goldIcon(),this.bossBtn.addEventListener(egret.Event.CHANGE,this.bossBtnEvent,this)},t.prototype.bossBtnEvent=function(){this.bossBtn.selected?this.timeLeftComplete():(Model.MonsterLocalService.setMonsterData(),Model.SceneLocalService.SceneData.currentMonster=Model.MonsterLocalService.MonsterList.length-1,this.bossBtn.currentState="upAndSelected",this.countTimeLabel.visible=!0,this.countTimeImage.visible=!0,this.sceneNumLabel.visible=!1,this.swardIcon.visible=!1,this.setCountDown(this.onTimeLeft),this.bossBtn.removeEventListener(egret.Event.CHANGE,this.bossBtnEvent,this),this.init())},t.prototype.bossDeathEvent=function(){this.bossTimer.removeEventListener(egret.TimerEvent.TIMER,this.timeLeftEvent,this),this.bossTimer.removeEventListener(egret.TimerEvent.TIMER_COMPLETE,this.timeLeftComplete,this),this.bossTimer.stop(),this.swardIcon.visible=!0,this.bossInfoGroup.visible=!1,this.sceneNumLabel.visible=!0},t.prototype.runAwayEvent=function(){this.bossBtn.currentState="downAndSelected",this.countTimeLabel.visible=!1,this.countTimeImage.visible=!1,this.sceneNumLabel.visible=!1,this.swardIcon.visible=!1},t.prototype.setMoney=function(e){Main.singleton.mainMenuVM.refreshMenu()},t.prototype.setMonsterIndex=function(){this.sceneNumLabel.text=String(Model.SceneLocalService.SceneData.currentMonster+1+"/"+Model.SceneLocalService.SceneData.monsterCount)},t.prototype.setSceneIndex=function(){this.preRound.text=String(Model.SceneLocalService.SceneData.sceneId-1),this.currentRound.text=Model.SceneLocalService.SceneData.sceneId+"",this.nextRound.text=String(Model.SceneLocalService.SceneData.sceneId+1),Model.AchievementLocalService.setCurrentGet(Model.AchievementType.ACHIEVEMENT_TYPE_ARRIVE_SCENE,Model.SceneLocalService.SceneData.sceneId)},t.prototype.setMonsterHp=function(){var e=Model.MonsterLocalService.MonsterList[Model.SceneLocalService.SceneData.currentMonster].hp,t=Model.MonsterLocalService.MonsterList[Model.SceneLocalService.SceneData.currentMonster].hpMax;e==t?this.bossHp.slideDuration=0:this.bossHp.slideDuration=500,this.bossHpLabel.text=String(Model.MonsterLocalService.MonsterList[Model.SceneLocalService.SceneData.currentMonster].HpAndUnit+"/"+Model.MonsterLocalService.MonsterList[Model.SceneLocalService.SceneData.currentMonster].HpMaxAndUnit),this.bossHp.maximum=t,this.bossHp.minimum=0,this.bossHp.value=e},t.prototype.setChallengeBoss=function(){var e=Model.ChallengeLoaclService.challengeBossData.hpMax,t=Model.ChallengeLoaclService.challengeBossData.hp;t==e?this.bossHp.slideDuration=0:this.bossHp.slideDuration=500;var i=Model.MainLocalService.toUnitConversion(t),n=Model.ChallengeLoaclService.challengeBossData.GetHpMax;this.bossHpLabel.text=i+"/"+n,this.bossHp.maximum=e,this.bossHp.minimum=0,this.bossHp.value=t},t.prototype.setCountDown=function(e,t){t||(this.onTimeLeft=e),this.currentLeftTime=t?t:Model.MonsterLocalService.MonsterList[Model.SceneLocalService.SceneData.currentMonster].leftTime,this.countTimeImage.width=220,this.countDownTimes=t?1e3*t/100:1e3*Model.MonsterLocalService.MonsterList[Model.SceneLocalService.SceneData.currentMonster].leftTime/100,this.countTimePercent=220/this.countDownTimes,this.bossTimer=new egret.Timer(100,this.countDownTimes),t||(this.bossTimer.addEventListener(egret.TimerEvent.TIMER,this.timeLeftEvent,this),this.bossTimer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.timeLeftComplete,this),this.bossTimer.start())},t.prototype.timeLeftEvent=function(){this.currentLeftTime-=.1,this.countTimeLabel.text=this.currentLeftTime.toFixed(1),this.countTimeImage.width-=this.countTimePercent,console.log("每100毫秒执行一次!")},t.prototype.timeLeftComplete=function(){this.bossTimer.removeEventListener(egret.TimerEvent.TIMER,this.timeLeftEvent,this),this.bossTimer.removeEventListener(egret.TimerEvent.TIMER_COMPLETE,this.timeLeftComplete,this),this.bossTimer.stop(),this.runAwayEvent(),this.onTimeLeft&&this.onTimeLeft()},t.prototype.goldIcon=function(){var e=new egret.MovieClipDataFactory(RES.getRes("jinbi_json"),RES.getRes("jinbi_png"));this.goldAnimel=new egret.MovieClip(e.generateMovieClipData("jinbi")),Main.singleton.mainMenuVM.addChild(this.goldAnimel)},t.prototype.goldAnimelStart=function(){this.goldAnimel.currentFrame==this.goldAnimel.totalFrames?this.goldAnimel.gotoAndPlay(0):this.goldAnimel.play()},t}(eui.Component);e.SceneInfoVM=t,__reflect(t.prototype,"ViewModel.SceneInfoVM")}(ViewModel||(ViewModel={}));var ViewModel;!function(e){var t=function(e){function t(t,i,n){var o=e.call(this)||this;return o.skinName=View.ScrollMsg,o.roundName.text=n,o.uiLayer=t,o.onCallBack=i,o.uiLayer.addChild(o),o}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.initScroll()},t.prototype.initScroll=function(){var e=this;egret.Tween.get(this.scrollBar).to({width:276},500).call(function(){egret.Tween.get(e.roundName).to({alpha:1},100).call(function(){egret.setTimeout(function(){e.onCallBack&&e.onCallBack(e.uiLayer)},e,800)})})},t}(eui.Component);e.ScrollMsgVM=t,__reflect(t.prototype,"ViewModel.ScrollMsgVM")}(ViewModel||(ViewModel={}));var ViewModel;!function(e){var t=function(t){function i(e,i){var n=t.call(this)||this;return Model.WebValue.is9G?n.skinName=View.SettingsView_9G:n.skinName=View.SettingsView,n.uiLayer=e,n.onCallBack=i,n.uiLayer.addChild(n),n}return __extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.initWindow()},i.prototype.initWindow=function(){var e=this;egret.Tween.get(this.maskBlackSettings).to({alpha:.7},700,egret.Ease.circIn),egret.Tween.get(this.window).to({y:0},700,egret.Ease.backOut),this.LGCloseBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){egret.Tween.get(e.maskBlackSettings).to({alpha:0},700,egret.Ease.circIn),egret.Tween.get(e.window).to({y:-550},700,egret.Ease.backIn).call(function(){e.uiLayer.removeChild(e)})},this),this.music.addEventListener(egret.TouchEvent.TOUCH_TAP,this.BGMBtn,this),this.sound.addEventListener(egret.TouchEvent.TOUCH_TAP,this.soundEffectBtn,this),this.personalMsg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.personalInfo,this),this.updateButtonState()},i.prototype.soundEffectBtn=function(){Model.AudioService.Shared().IsSound=!Model.AudioService.Shared().IsSound,this.updateButtonState()},i.prototype.BGMBtn=function(){Model.AudioService.Shared().IsMusic=!Model.AudioService.Shared().IsMusic,this.updateButtonState()},i.prototype.updateButtonState=function(){this.music.currentState=Model.AudioService.Shared().IsMusic?"up":"down",this.sound.currentState=Model.AudioService.Shared().IsSound?"up":"down"},i.prototype.personalInfo=function(){new e.PersonalMsgVM(this.uiLayer,function(){})},i}(eui.Component);e.SettingsVM=t,__reflect(t.prototype,"ViewModel.SettingsVM")}(ViewModel||(ViewModel={}));var ViewModel;!function(e){var t=function(e){function t(t,i){var n=e.call(this)||this;return n.isFree=!1,n.skinName="View.ShopItem",n.uiGroup=t,n.onCallback=i,n.uiGroup.addChild(n),n}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this)},t.prototype.setYBItem=function(){this.goodsIcon.source="Icon_shangcheng_png",this.goodsName.text=Model.WebValue.isTraditional?"海量福利等妳來領！":"海量福利等你来领！",this.goodsDesOne.text=Model.WebValue.isTraditional?"聽說賣完這批元寶就回家種田了！":"听说卖完这批元宝就回家种田了！",this.goodsBtn.y=-7,this.goodsBtn.setYBBtn(),this.goodsBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.setYBBtn,this)},t.prototype.setSData=function(e){this.sData=e,e.st.description.length>=16&&(this.goodsName.y=5),this.goodsName.text=e.st.name,this.goodsIcon.source=e.Icon,e.Type==Model.ShopType.SHOP_TYPE_COIN?this.goodsDesOne.text=e.st.description.replace("{}",e.goldAndUnit):this.goodsDesOne.text=e.st.description;if(e.Type==Model.ShopType.SHOP_TYPE_YB?(this.goodsBtn.y=-7,this.goodsBtn.setYBBuy(e.st.costRmb,!0),this.costRmb.text=e.st.costRmb+"元"):this.goodsBtn.setSBuy(e.st.cost,!0),this.goodsBtn.addEventListener(egret.TouchEvent.TOUCH_END,this.onUpgradeMEvent,this),4==e.st.id){var t=new Date,i=t.getTime()/1e3;if(i-Model.PlayerLocalService.PlayerData.dy.freeSkillTime<=86400?(this.goodsBtn.setFreeSkill(),this.isFree=!0):this.isFree=!1,e.dy){var t=new Date,i=t.getTime()/1e3,n=i-e.dy.lastShopTime<=86400;n&&this.goodsBtn.skillUsing()}}},t.prototype.onUpgradeMEvent=function(){this.onCallback&&this.onCallback(this.sData,this.isFree)},t.prototype.setYBBtn=function(){this.onCallback&&this.onCallback()},t}(eui.Component);e.ShopItemVM=t,__reflect(t.prototype,"ViewModel.ShopItemVM")}(ViewModel||(ViewModel={}));var ViewModel;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.skinName=View.TestView,t}return __extends(t,e),t}(eui.Component);e.TestVM=t,__reflect(t.prototype,"ViewModel.TestVM")}(ViewModel||(ViewModel={}));var ViewModel;!function(e){var t=function(e){function t(t,i){var n=e.call(this)||this;return n.skinName=View.TotalRewardItem,n.uiLayer=t,n.onCallBack=i,n.uiLayer.addChild(n),n}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this)},t.prototype.setInfo=function(e,t){switch(this.data=e,this.currentProgress.slideDuration=0,this.currentProgress.maximum=e.cumulativeRecharge,this.currentProgress.minimum=0,this.currentProgress.value=t>=e.cumulativeRecharge?e.cumulativeRecharge:t,this.finish.visible=!1,Model.WebValue.isTraditional?this.description.text="儲值"+e.cumulativeRecharge+"元寶":this.description.text="充值"+e.cumulativeRecharge+"元宝",this.rewardBtn.once(egret.TouchEvent.TOUCH_TAP,this.getReward,this),e.rewardState){case-1:this.rewardBtn.setCumulativeBtn(e.rewardCount,!0);break;case 0:this.rewardBtn.setCumulativeBtn(e.rewardCount,!1);break;case 1:this.rewardBtn.visible=!1,this.finish.visible=!0;break;default:alert("奖励状态出错！！！！")}},t.prototype.getReward=function(){this.onCallBack&&(this.onCallBack(this.data),this.rewardBtn.visible=!1,this.finish.visible=!0)},t}(eui.Component);e.TotalRewardItemVM=t,__reflect(t.prototype,"ViewModel.TotalRewardItemVM")}(ViewModel||(ViewModel={}));var ViewModel;!function(e){var t=function(t){function i(e,i){var n=t.call(this)||this;return n.skinName=View.TotalRewardView,n.uiLayer=e,n.onCallBack=i,n.uiLayer.addChild(n),n}return __extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.initWindow()},i.prototype.initWindow=function(){var e=this;this.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.uiLayer.removeChild(e)},this),this.magicStone.text=Model.PlayerLocalService.PlayerData.dy.jewel+""},i.prototype.setList=function(t){for(var i=this,n=t.cumulativeRechargeList,o=t.playerRecharge,r=0;r<n.length;r++){var a=new e.TotalRewardItemVM(this.listGroup,function(e){Model.WebService.GetCumulativeRecharge(e.cumulativeId,function(){Model.WebServiceBase.isDebug&&console.log("cai_haotian GetCumulativeRecharge success!!!!!!"),Model.PlayerLocalService.PlayerData.AddJewel=e.rewardCount,Model.AchievementLocalService.setCurrentGet(Model.AchievementType.ACHIEVEMENT_TYPE_GET_JEWEL,e.rewardCount),i.magicStone.text=Model.PlayerLocalService.PlayerData.dy.jewel+""},function(){Model.WebValue.isTraditional?alert("獲取累計充值獎勵失敗！"):alert("获取累计充值奖励失败！"),Model.WebServiceBase.isDebug&&console.log("cai_haotian GetCumulativeRecharge failed!!!!!!!")})});a.setInfo(n[r],o)}},i}(eui.Component);e.TotalRewardVM=t,__reflect(t.prototype,"ViewModel.TotalRewardVM")}(ViewModel||(ViewModel={}));var ViewModel;!function(e){var t=function(e){function t(t){var i=e.call(this)||this;i.role=t;var n=RES.getRes("texture_"+i.role+"_json"),o=RES.getRes("texture_"+i.role+"_texiao"),r=RES.getRes("texture_"+i.role+"_png");i.factory=new dragonBones.EgretFactory,i.factory.addSkeletonData(dragonBones.DataParser.parseDragonBonesData(o)),i.factory.addTextureAtlas(new dragonBones.EgretTextureAtlas(r,n)),i.armatureName=o.armature[0].name,i.armature=i.factory.buildArmature(i.armatureName);var a=i.armature.display;a.x=400,a.y=300,i.addChild(a),i.curAnimationName=i.armature.animation.animationList[0];i.armature.animation.animationList[i.armature.animation.animationList.length-1];return i.animation=i.armature.animation,i.animation.play(),i.armature.addEventListener(dragonBones.AnimationEvent.LOOP_COMPLETE,function(){i.animation.stop(),i.removeChild(a)},i),dragonBones.WorldClock.clock.add(i.armature),egret.Ticker.getInstance().register(function(e){dragonBones.WorldClock.clock.advanceTime(-1)},i),i}return __extends(t,e),t}(eui.Group);e.Tx_skillTemp=t,__reflect(t.prototype,"ViewModel.Tx_skillTemp")
}(ViewModel||(ViewModel={}));